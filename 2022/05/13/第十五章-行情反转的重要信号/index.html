<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2">





















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">
<meta name="keywords" content="期货多空逻辑">
<meta property="og:type" content="article">
<meta property="og:title" content="第十五章-行情反转的重要信号">
<meta property="og:url" content="http://yoursite.com/2022/05/13/第十五章-行情反转的重要信号/index.html">
<meta property="og:site_name" content="车斌的技术博客">
<meta property="og:description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/2022/05/13/第十五章-行情反转的重要信号/1.jpg">
<meta property="og:image" content="http://yoursite.com/2022/05/13/第十五章-行情反转的重要信号/2.jpg">
<meta property="og:image" content="http://yoursite.com/2022/05/13/第十五章-行情反转的重要信号/3.jpg">
<meta property="og:image" content="http://yoursite.com/2022/05/13/第十五章-行情反转的重要信号/4.jpg">
<meta property="og:image" content="http://yoursite.com/2022/05/13/第十五章-行情反转的重要信号/5.jpg">
<meta property="og:image" content="http://yoursite.com/2022/05/13/第十五章-行情反转的重要信号/6.jpg">
<meta property="og:image" content="http://yoursite.com/2022/05/13/第十五章-行情反转的重要信号/7.jpg">
<meta property="og:image" content="http://yoursite.com/2022/05/13/第十五章-行情反转的重要信号/8.jpg">
<meta property="og:updated_time" content="2022-05-13T09:43:52.072Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第十五章-行情反转的重要信号">
<meta name="twitter:description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">
<meta name="twitter:image" content="http://yoursite.com/2022/05/13/第十五章-行情反转的重要信号/1.jpg">






  <link rel="canonical" href="http://yoursite.com/2022/05/13/第十五章-行情反转的重要信号/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>第十五章-行情反转的重要信号 | 车斌的技术博客</title><meta name="robots" content="noindex">
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">车斌的技术博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">放弃会成为一种习惯</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/05/13/第十五章-行情反转的重要信号/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CheBin">
      <meta itemprop="description" content="看书不是为了学习，是为了锻炼意志力">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="车斌的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">第十五章-行情反转的重要信号

              
            
          </h1>
        

        <div class="post-meta">

          

          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2022-05-13 17:04:11 / 修改时间：17:43:52" itemprop="dateCreated datePublished" datetime="2022-05-13T17:04:11+08:00">2022-05-13</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/期货/" itemprop="url" rel="index"><span itemprop="name">期货</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">7.6k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">7 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>思考并回答以下问题：</p>
<ul>
<li>总结一下，这章作者最主要想表达什么观点？</li>
</ul>
<a id="more"></a>
<p>本节我想给大家介绍一下商品期货行情进入大的反转的三个重要标志，需要声明的是，我并不赞成摸顶抄底，因为根据我多年的经验，在市场进入顶部或者底部的时候往往非常折磨人，摸顶抄底必定会让你频繁止损出局，对于绝大多数交易者而言，我更加推荐右侧交易。</p>
<p>此外，我所介绍的市场反转的三个重要标志，一方面是我自身在期货市场中的亲身经历，而且也经过多次验证；另一方面是给期货交易者提供一种平仓离场的警示信号，并不是要你在这个位置摸顶抄底或进行反手操作。</p>
<p>标志一：价格处于高位或低位，基差得以修复后需谨慎。</p>
<p>前面我们介绍了商品期货的两大趋势，库存重建过程中的上涨与去库存过程中的下跌。无论是上涨或者下跌，由于预期的作用，导致了期货与现货上涨或下跌的幅度并不完全相同，所以在上涨或下跌的过程中基差会被拉大。</p>
<p>以库存重建过程中的上涨为例，大趋势是上涨的，无论是期货引领现货上涨，还是现货引领期货上涨，一旦基差被拉大，就会发生次级别的回调，即下跌的行情来进行基差修复，基差修复完成后，会开启新一轮的主趋势的上涨。所以，一个典型的趋势可以分解为两种情况：一种是主趋势库存周期的上涨或下跌，另一种就是次趋势的基差修复行情。</p>
<p>在一轮大趋势的情况下，上面的逻辑得到多次验证。无论是橡胶期货引领现货上涨，还是矿石现货引领期货上涨，莫不如此。可是我在这上面也吃过不少亏。因为，在趋势的初始阶段和延续阶段这样操作并没有什么大的问题，然而在趋势转折阶段却很容易亏钱。</p>
<p>以橡胶为例，在2016年，橡胶明显是期货引领现货上涨，开启了一轮大的上涨趋势，期货涨得比现货快一些，所以在期货上涨的过程中基差被拉大，接着就是期货下跌或者现货上涨来修复基差，基差得到修复之后，再次开启新一轮的上涨。然而，当橡胶指数在2016年末2017年初时达到22355点，现货快速上涨基本上又将基差修复了。</p>
<p>按照正常的逻辑，由于现货上涨来修复基差，这就为期货未来的继续上涨打开了空间，然而现实却是恰恰相反，橡胶开启了行情大反转，从22355点一度跌到了12490点。如图15-1所示。</p>
<blockquote>
<p>图15-1 价格高位，基差修复，行情反转的例子</p>
</blockquote>
<img src="/2022/05/13/第十五章-行情反转的重要信号/1.jpg">
<p>类似的情况我在棉花、矿石上也多次遇到过，后来我总结，工业品的库存周期是商品的一个主趋势，基差修复是一个次趋势，然而，在交易中也要对价格的相对高低保持警惕性，如果在高位或者低位发生了基差的修复，往往是行情的转折，而非行情的延续。</p>
<p>这个经验是我多次验证的来的，其背后的原因更多的是物极必返的道理以及交易者对高价位的恐惧和低价位的贪婪，所以价格处于高位或低位，同时基差得以修复后一定要谨慎，不要盲目继续去追行情，当然更不要盲目去反手。</p>
<p>标志二：价格处于高位或低位，日内频繁实现基差的升贴水转换时需谨慎。</p>
<p>通常情况下，商品在某个特定的大趋势下，一般无法实现基差的升贴水转换，只是基差的拉大与修复，因为商品依然处在某个特定的库存周期当中。然而，如果预期发生了变化，那么通常会出现两种情况，一是基差的升贴水转化，二是市场方向的转变。</p>
<p>例如，黑色系大部分品种都是逆向市场，所谓逆向市场就是远月价格低于近月价格，与此同时，黑色系的品种基本的都是期货贴水，所以每当期货向上修复贴水之后，都会开启新一轮的下跌。</p>
<p>2020年由于疫情的影响，螺纹钢5月合约在历史天量库存下，面临巨大的交割压力，所以多头主力资金纷纷从5月合约撤出。同时，市场预期随着疫情缓解，国家刺激政策出台，10月合约的需求会非常好，螺纹钢会表现出明显的去库现象，多头资金纷纷基于未来的预期，流入10月合约，从而导致过去一直是反向市场结构的螺纹钢，在疫情的影响下，短暂地变成了正向结构。</p>
<p>市场方向的转换大都是由于预期的一致性转变。如果市场方向发生转换之后，且能够长时间保持，说明市场行情发生逆转的可能性比较大。然而，很多交易者可能并不关注市场方向，只是关注自己当前所参与交易的合约，我在最初做期货的时候同样如此。</p>
<p>对于当下你所交易的合约，你需要时刻关注现货价格，你要了解基差的变化。通常情况下，基差都是修复，除非发生了市场预期的一致性转换，否则很难形成基差的升贴水转换，如果是你日频繁实现基差的升贴水转换，通常是行情进入末端，即将反转的时刻。</p>
<p>这一点我在2015年的股指期货上深刻体会，日内频繁的实现基差的升贴水转换，而那时候好多所谓的专家说上证指数要突破6000、8000甚至是10000点，在5000点的时候，股指期货就在日内频繁的出现基差的升贴水转换，我喝杯茶的时间账户的波动就有浮盈几十万变成浮亏几十万，实在拿不住单子了，出来了，结果果然后面就发生了行情的大逆转。</p>
<p>标志三：价格处于高位或低位，持仓量大幅下降需谨慎。</p>
<p>期货交易圈中有一句非常有趣的话：你开仓买入的每一笔单子，都是别人卖给你的，你们两人相视一笑，互道一声：笨蛋！这句话看似很有趣，其实有深刻的道理在里面。期货交易需要有对手盘，如果没有对手盘的话，你的单子便无法成交。读过《期货大作手风云录》的交易者都应该记得里面的一句话：多头不死，空头不止！这句话是很有道理的。</p>
<p>当多空双方对于某个商品方向产生了分歧时，多空都会加仓，此时，该合约的持仓量就会逐渐放大，在多空双方不断较量的过程中，持仓量持续放大。只要这个合约的持仓量没有出现非常明显的减少，你就可以大胆跟随多空获胜的一方进行开仓。</p>
<p>然而，这个品种的持仓量出现了继续下滑，与此同时，期货价格大幅上涨或下跌，那么说多空双方中的一方已经认输离场，导致持仓量大幅减少，与此同时，期货价格向反方向快速变化。我们以多头不死，空头不止这句话为例。</p>
<p>当多空双方发生激烈较量时，合约的持仓量不断加大，空头占主导优势，商品期货的价格重心不断下移，到了比较低的价位，持仓量大幅减少，期货价格进一步快速下跌，这说明多头已经认赔出局，斩仓离场，所以持仓量大幅下降，多头减仓就相当于空头加仓，所以期货价格会继续下跌。由于期货交易需要有对手盘，多头已死，空头获利巨大，需要兑现利润，这个时候就会出现空头平仓离场，此时，持仓量会进一步降低，而商品期货的价格快速上涨，容易出现空杀空的踩踏行情。</p>
<p>在期货市场中这种情况太常见了，举个例子，2016年的期货螺纹钢大战的时候，如果你仔细观察过，永安系列一直是螺纹钢的主力净多头，而期货投资者葛卫东看空螺纹，永安的产业客户做多螺纹的逻辑是供给侧改革的红利，葛卫东看空螺纹的逻辑是产业利润过大，双方都有各自的道理，于是展开了一场激烈的多空大战，螺纹持仓量大幅增加，盘面上多头占主导优势，螺纹期货价格不断上涨，双方加仓不断持续，后来，葛卫东意识到自己犯了错误，逐渐开始减仓离场，螺纹持仓量开始快速下降，而此时螺纹期货的价格也开始跟随下跌，因为多头获利巨大，也在趁机离场。</p>
<p>所以多空都加仓时，商品持仓量巨大，行情并未结束；当多空都减仓时，说明一方已经认输，另一方开始兑现利润，行情基本结束。如果你复盘去观察螺纹期货的历史走势，我相信你一定会发现这个规律的。</p>
<p>最后，需要注意一下基差的骗局，当价格或利润处于历史高位时，期货大幅度贴水，往往是假贴水，因为现货提前见顶；当价格或利润处于历史低位时，期货大幅升水，往往是价升水，因为现货已经提前见底。所以价格历史高位，期货贴水不是真贴水；价格历史低位，期货升水不是真升水。此时不可以再按按照基差的升贴水逻辑去做多或者做空。</p>
<p>大部分交易者在每天期货收盘之后都会去关注一下相关品种的主力持仓情况，三大商品期货交易所在收盘之后都会进行公布，其他的一些资讯网站也会公布，但完全跟着这些主力资金的方向操作，你会发现自己经常慢半拍，被主力资金牵着鼻子走。</p>
<p>所以我个人认为，不能够完全按照主力资金的变化去追，而是要结合实际情况去进行客观地分析，不要把主力资金当做你期货交易的救世主，而是要结合主力资金的变化分析和总结客观的规律，然后按照客观规律去进行交易。</p>
<p>在关注主力合约多空持仓的时候，大多数人一般只看主力合约前20名的持仓结果是净多单还是净空单，从而判断主力的多空观点。一般情况下，对于反向市场的品种，现货市场供应偏紧，期货市场可交割的货物相对少一些，所以套保客户持仓也相对较少，多头基本上占据主动，所以前20名主力持仓一般都是净多单。如图15-2所示。</p>
<blockquote>
<p>图15-2 大商所豆粕2001合约持仓情况</p>
</blockquote>
<img src="/2022/05/13/第十五章-行情反转的重要信号/2.jpg">
<p>对于量化交易者来说，可以构成一个量化因子：净多单率，净多单率=（前20名多头持仓-前20名空头持仓）/前20名多头持仓。可以通过数据分析的方式来监测净多单率与主力合约价格变化之间的关系。</p>
<p>相反，对于正向市场的品种，现货市场供应过剩，期货市场可交割的货物相对多一些，所以套保客户持仓也相对较多，空头基本上占据主动，所以前20名主力持仓一般都是净空单。同样，量化交易者也可以把这个构成一个量化因子，净空单率=（前20名空头持仓-前20名多头持仓）/前20名空头持仓，从而分析净空单率与主力价格变化之间的关系。</p>
<p>此外，我们还经常关注主力合约第一大多头和第一大空头，当然有时候也可以看一下前3或者前5主力持仓情况，但是需要注意的是，无论是分析那个期货公司的持仓，都不能够只看他在这个品种这个合约上的持仓情况，因为这样是只见树木不见森林，我们不仅要看一下它在当前合约的持仓情况，也要看一下它在次主力合约的持仓情况，因为它可能并不是做单边的，而可能是做跨期的，从近月主力合约接货，然后转抛到次主力合约。</p>
<p>此外，不仅要看单品种持仓，也要看产业链上下游品种的持仓，从中观察一下它是做多产业利润还是做空产业利润。最后，还要关注一下板块持仓的情况，如工业品的持仓和农产品的持仓情况，来关注该机构的宏观对冲策略；有色、黑色、能化之间的持仓，来判断其对冲策略。如图15-3所示。</p>
<blockquote>
<p>图15-3 从跨期和产业链角度去分析持仓</p>
</blockquote>
<img src="/2022/05/13/第十五章-行情反转的重要信号/3.jpg">
<p>很多交易者存在这样的误区，当商品处于多头市场的时候，前20名多头持仓比前20名空头持仓大之差越大越好，或者说，上面构造的量化因子净多单率越大越好，在下跌的时候净空单率越大越好。</p>
<p>因为在价格上涨的时候，如果多头持仓远远大于空头持仓，说明多空力量相差悬殊，多头牢牢占据主动；在价格下跌的时候，如果空头持仓远远大于多头持仓，说明空头实力远远大于多头实力，空头牢牢占据主动。然而，我想告诉你的是，事实并非如此！</p>
<p>单从净多单率和净空单率这一个指标是无法判断主力的真实行为，我所说的真实行为并不是过去已经发生的持仓结果，而是未来可能发生的持仓变化。因为当你已经看到的主力持仓在价格中已经反映出来了，意义不大，重要的是如何根据当下主力持仓以及当下的价格情况，来判断主力的未来行为。</p>
<p>多头不死，空头不止，反之亦然。当净多单率或者净空单率过大的时候，就会物极必反。具体而言，当多头主力持仓远超过空头主力持仓，即净多单率过大，说明多头的仓位十分拥挤，看涨的多头几乎全部进来了，场外的多头已经不多了，这意味着多头行情即将结束。</p>
<p>如果说这个时候价格还在高位，那么行情结束的概率非常高，下一步就是多头减仓而发生的多杀多踩踏行情。相反，当空头主力持仓远超过多头主力持仓，即净空单率过大，说明空头的仓位十分拥挤，看空的空头几乎全部进来了，场外的空头已经不多了，这意味着空头行情即将结束，如果此时价格还在低位，那么行情结束的概率非常高，下一步就是空头减仓而发生的空杀空踩踏行情。如图15-4所示。</p>
<blockquote>
<p>图15-4 价格位置高度与持仓差过大可能引起行情反转</p>
</blockquote>
<img src="/2022/05/13/第十五章-行情反转的重要信号/4.jpg">
<p>所以关于判断行情即将转折的方法，我个人的总结是：</p>
<p>净多单率高+价格高位→多头行情即将结束</p>
<p>净空单率高+价格低位→空头行情即将结束</p>
<p>上面介绍了计算净多单率和净空单率的方法，至于这个比率的高低，需要通过历史数据进行分析和观察。同样的道理，价格指标也可以用高低进行定位，以05合约为例，可以通过某个品种05合约的最高价格，05合约的最低价格以及当前价格来计算当前价格所处的历史位置：（当前价格-历史最低价格）/极差，极差=历史最高价格-历史最低价格。</p>
<p>当然，净多单率也可以采取相对比例法来计算净多单率的历史位置。这样的话指标就可以进行量化，通过仓差和价格两个维度判断后续行情可能发生的情况。</p>
<p>根据仓差和价格两个维度判断未来行情的变化之后，我们还需要找到方法去验证我们的判断。其实方法很简单，当多头行情开始结束，由于净多单率比较高，看多的基本上都进来了，看空的基本上都被打爆了，认输出局了，这个时候就会发生多杀多踩踏行情，即多头主动大幅减仓，仓差开始缩小，持仓量开始下降，这个时候我们又引入了第三个的判断指标：持仓量下降。</p>
<p>同样的道理，当空头行情结束时，由于净空单率比较高，看空的基本上都进来了，看多的基本上都被打爆了，认输出局，这个时候就会发生空杀空的踩踏行情，即空头主动大幅减仓，仓差开始缩小，持仓量开始下降。行情的结束充分说明了一个道理：期货交易就是对手盘交易，空头已死，多头方止；多头已死，空头方止！</p>
<p>验证行情已经结束的方法，我个人的总结是：</p>
<p>净多单率下降+价格下跌+持仓量下降→多头行情已经结束</p>
<p>净空单率下降+价格上涨+持仓量下降→空头行情已经结束</p>
<p>另外，期货有限仓制度，随着距离交割日的不断临近，交易所对期货最大持仓的限制不断调整。所以，当前20名主力的多单比空单超出很多的时候，极有可能是多头超仓了，不得不进行减仓，这个时候就容易出现多头主动减仓带来的下跌行情。同理，如果前20名主力的空单比多单超出很多，就容易发生空头超仓引发的空头主动减仓带来的上涨行情。所以，多空仓差并不是越大越好，物极必反。如图15-5所示。</p>
<blockquote>
<p>图15-5 限仓制度对行情带来的影响</p>
</blockquote>
<img src="/2022/05/13/第十五章-行情反转的重要信号/5.jpg">
<p>最后，关于期货交易，不要把时间浪费在和别人之间进行多空争论上，也不要把时间浪费在寻找主力的观点上，而是把时间更多用于规律的观察、分析、总结和验证上，更多地用于自我修为上，因为当你对行情的理解和判断以及资金管理方面问题都不大的时候，最后你会发现交易中最大的敌人就是你自己，在这个时候你在交易中的理念、方法和技巧提高已经意义不大了，但是你个人修为上的提高，会给你的投资水平带来质的飞跃，所以交易者在交易中的自我管理也是非常重要的！</p>
<p>对于现货来说，供求决定价格，当商品供过于求时，价格下跌；当商品供不应求时，价格上涨；这是最简单的供求定律。</p>
<p>对于期货来说也是如此，但需要清楚的是什么是盘面的供给，什么是盘面的需求。期货的交易分为多开、多平、空开、空平，其中多开和空平都是有利于盘面价格上涨，属于盘面的需求方；空开和多平都是有利于盘面价格下跌，属于盘面的供应方。如图15-6所示。</p>
<blockquote>
<p>图15-6 盘面的供应和需求</p>
</blockquote>
<img src="/2022/05/13/第十五章-行情反转的重要信号/6.jpg">
<p>当盘面的供应大于需求时，盘面的价格会呈现下跌趋势；当盘面的需求大于供应时，盘面的价格会呈现上涨趋势；当盘面的供应和需求相当时，盘面往往处于震荡状态。</p>
<p>另外，只从价格是涨还是跌，我们所判断的盘面供应和需求只是历史情况，例如，当前价格是下跌趋势，我们可以判断出过去一段时间，价格的供应大于需求，即空开和多平的量大于多开和空平的量；但是未来行情会如何发展，我们单纯从价格一个指标却很难有所察觉，这个时候我们还需要观察另外一个指标，那就是成交量。</p>
<p>通常情况下，我们判断一个商品当下需求的好坏，主要是看现货市场成交是否放量，如果现货市场成交放量，说明当下的市场价格比较被认可，需求还是不错的；如果当前的价格下市场成交清淡，说明目前的市场价格不被市场认可。所以现货市场的成交量往往是判断供需的一个重要指标。</p>
<p>同样的道理，在期货盘面上我们也可以通过成交量来判断盘面的供需情况。当价格不断上涨时，说明当前盘面需求大于供应，与此同时，我们需要关注的是成交量情况，如果成交量不断放大，说明这个时候卖方的供应也在不断增加，往往价格处于较高位置，同时成交量放大时，说明大量卖方供应出现，例如多平和空开，就容易导致价格在高位反转。</p>
<p>相反，当盘面供应大于需求时，价格往往会一路下跌，当价格跌到某个区间时，成交量开始放大，说明在低价位的情况下，需求被刺激起来了，多开和空平增加，所以随着供应的增加，下面接货的买方越来越多，从而导致价格低位出现较大的成交量，在这种情况下，往往是价格处于低位，即将面临着反转。如图15-7所示。</p>
<blockquote>
<p>图15-7 根据价量关系判断行情的顶部和底部区域</p>
</blockquote>
<img src="/2022/05/13/第十五章-行情反转的重要信号/7.jpg">
<p>此外，除了价格水平的高低和成交量的高低之外，我们还需要关注一个重要的因素就是期货持仓量的高低。一个品种想要发生大的行情，都会伴随着较大的持仓量，在短时间内持仓量大幅增加。所以，大持仓往往容易塑造大行情。</p>
<p>具体来说，价格在历史低位时，持仓量较大往往容易导致行情反转上涨。由于期货的参与者有产业客户和投机客户，产业客户可以参与交割，投机客户持有的都是虚盘，当价格处于历史底部，持仓量创历史新高，这时候低价格使得产业受到损害，供应端主动减产停产，而低价格容易刺激需求，这就导致现货的库存开始慢慢偏紧。当期货持仓的量超过了现货市场中库存的量时，有大量空头无货可交割，不得不平仓离场。</p>
<p>所以价格低位，如果持仓创了历史新高时，往往会出现盘面交割货的量超过了现货市场中实际拥有的量，在这种情况下，多头的信心更足，而空头往往心里没底。因此，容易发生行情反转，从空头行情转变为多头行情。</p>
<p>空头行情反转为多头行情一般分为三个阶段，第一阶段，由于盘面持仓量巨大，超过现货市场库存所有量，空头选择主动减仓，盘面反弹上涨，空头减仓越多，盘面反弹力度越大；第二阶段，盘面的上涨吸引了更多的多头，多头买入热情高涨，推动价格进一步上涨；第三阶段，价格反弹到高位时，空头开始回补，多空双方展开最终较量，一旦多头获胜，将转入长期上涨行情，多空持仓都会减少，持仓量开始下降，价格稳步上涨，多头主导行情。如图15-8所示。</p>
<blockquote>
<p>图15-8 行情空转多的三个阶段</p>
</blockquote>
<img src="/2022/05/13/第十五章-行情反转的重要信号/8.jpg">
<p>当价格处于历史高位时，持仓量较大往往容易导致行情反转下跌。由于价格处于高位时，往往产业利润较高，这会刺激生产商不断加大供应，与此同时，高价格也会抑制需求，从而导致现货市场上的库存不断增加，开始过剩；大量有货无法在现货市场卖出的交易者，选择通过期货市场销售，在价格高位供应压力不断增加，到某一程度，买方的承接力度达到极限，价格开始反转下跌。</p>
<p>多头行情反转为空头行情一般也分为三个阶段，和上面的过程恰好相反，先是多头减仓下跌，然后空头增仓下跌，最后是多空再次激烈博弈，一旦空头获胜，那么多空双方都开始减仓，持仓量下降，空头主导行情。</p>
<p>所以，我们在判断价格是否即将发生反转时，需要将价格水平、持仓量、成交量三个重要指标结合起来判断，其核心就是供需逻辑，只不过把现货市场中的供需逻辑运用到了期货市场盘面价格而已。</p>
<!-- flag of hidden posts -->
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/期货多空逻辑/" rel="tag"># 期货多空逻辑</a>
          
        </div>
      

      
      
      

      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="CheBin">
            
              <p class="site-author-name" itemprop="name">CheBin</p>
              <div class="site-description motion-element" itemprop="description">看书不是为了学习，是为了锻炼意志力</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">940</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">20</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">65</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          

          
          


          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <!-- modify icon to fire by szw -->
                <i class="fa fa-history fa-" aria-hidden="true"></i>
                近期文章
              </div>
              <ul class="links-of-blogroll-list">
                
                
                  <li>
                    <a href="/2023/02/26/13｜JSX：如何利用JSX应对更灵活的开发场景？/" title="13｜JSX：如何利用JSX应对更灵活的开发场景？" target="_blank">13｜JSX：如何利用JSX应对更灵活的开发场景？</a>
                  </li>
                
                  <li>
                    <a href="/2023/02/26/12｜调试：提高开发效率必备的Vue-Devtools/" title="12｜调试：提高开发效率必备的Vue Devtools" target="_blank">12｜调试：提高开发效率必备的Vue Devtools</a>
                  </li>
                
                  <li>
                    <a href="/2023/02/26/11｜路由：新一代vue-router带来什么变化/" title="11｜路由：新一代vue-router带来什么变化" target="_blank">11｜路由：新一代vue-router带来什么变化</a>
                  </li>
                
                  <li>
                    <a href="/2023/02/26/10｜数据流：如何使用Vuex设计你的数据流/" title="10｜数据流：如何使用Vuex设计你的数据流" target="_blank">10｜数据流：如何使用Vuex设计你的数据流</a>
                  </li>
                
                  <li>
                    <a href="/2023/02/26/09｜动画：Vue中如何实现动画效果？/" title="09｜动画：Vue中如何实现动画效果？" target="_blank">09｜动画：Vue中如何实现动画效果？</a>
                  </li>
                
              </ul>
            </div>
        

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2023</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CheBin</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">站点总字数：</span>
    
    <span title="站点总字数">7.8m</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    
    <span title="站点阅读时长">118:45</span>
  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a></div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.1"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.1"></script>



  
  <script src="/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  

  

  


  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  

  
  

  


  

  

  

  

  

  

  

  

  
<script>
  $('.highlight').each(function(i, e) {
    var $wrap = $('<div>').addClass('highlight-wrap');
    $(e).after($wrap);
    $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function(e) {
      var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
        return $(e).text();
      }).toArray().join('\n');
      var ta = document.createElement('textarea');
      var yPosition = window.pageYOffset || document.documentElement.scrollTop;
      ta.style.top = yPosition + 'px'; // Prevent page scroll
      ta.style.position = 'absolute';
      ta.style.opacity = '0';
      ta.readOnly = true;
      ta.value = code;
      document.body.appendChild(ta);
      ta.select();
      ta.setSelectionRange(0, code.length);
      ta.readOnly = false;
      var result = document.execCommand('copy');
      
        if (result) $(this).text('复制成功');
        else $(this).text('复制失败');
      
      ta.blur(); // For iOS
      $(this).blur();
    })).on('mouseleave', function(e) {
      var $b = $(this).find('.copy-btn');
      setTimeout(function() {
        $b.text('复制');
      }, 300);
    }).append(e);
  })
</script>


  

  

</body>
</html>
