<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2">





















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">
<meta name="keywords" content="期货多空逻辑">
<meta property="og:type" content="article">
<meta property="og:title" content="第三章-如何理解商品的周期">
<meta property="og:url" content="http://yoursite.com/2022/05/07/第三章-如何理解商品的周期/index.html">
<meta property="og:site_name" content="车斌的技术博客">
<meta property="og:description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/2022/05/07/第三章-如何理解商品的周期/1.jpg">
<meta property="og:image" content="http://yoursite.com/2022/05/07/第三章-如何理解商品的周期/2.jpg">
<meta property="og:image" content="http://yoursite.com/2022/05/07/第三章-如何理解商品的周期/3.jpg">
<meta property="og:updated_time" content="2022-05-07T02:23:57.002Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第三章-如何理解商品的周期">
<meta name="twitter:description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">
<meta name="twitter:image" content="http://yoursite.com/2022/05/07/第三章-如何理解商品的周期/1.jpg">






  <link rel="canonical" href="http://yoursite.com/2022/05/07/第三章-如何理解商品的周期/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>第三章-如何理解商品的周期 | 车斌的技术博客</title><meta name="robots" content="noindex">
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">车斌的技术博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">放弃会成为一种习惯</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/05/07/第三章-如何理解商品的周期/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CheBin">
      <meta itemprop="description" content="看视频才能学会，看文字学不会的">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="车斌的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">第三章-如何理解商品的周期

              
            
          </h1>
        

        <div class="post-meta">

          

          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2022-05-07 10:09:14 / 修改时间：10:23:57" itemprop="dateCreated datePublished" datetime="2022-05-07T10:09:14+08:00">2022-05-07</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/期货/" itemprop="url" rel="index"><span itemprop="name">期货</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">9.2k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">8 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>思考并回答以下问题：</p>
<ul>
<li>总结一下，这章作者最主要想表达什么观点？</li>
</ul>
<a id="more"></a>
<p>有很多交易者都自诩为趋势交易者，可是每当我问他们什么是趋势时，他们要么张口结舌，要么就是在走势图中画趋势线给我看。可是当我追问他们：趋势已经走出来了，每个人都能够看到，可趋势什么时候开始，是否会继续延续呢？基本上没有人能够回答出来。为什么会这样呢？因为大多数交易者本身对趋势的理解并不深刻。</p>
<p>作为交易者，我们交易的标的是商品期货，而商品本身存在库存周期。这个周期简单来说分为两个阶段：库存重建过程中的价格上涨阶段和去库存过程中的价格下跌阶段。这才是趋势的本质，而K线图中从大周期来看必定是按照这个趋势去发展，体现的是趋势的表象。如图3-1所示。</p>
<blockquote>
<p>图3-1 商品的趋势本质是库存周期</p>
</blockquote>
<img src="/2022/05/07/第三章-如何理解商品的周期/1.jpg">
<p>简单来说，我们通过库存周期来判断趋势，通过K线图来验证趋势。大多数交易者都把过多的精力放在交易图表上，他们所理解的趋势只是趋势的表象，试图通过在K线图中画趋势线的方法来判断趋势的形成与结束，其实他们并没有抓住趋势的本质。</p>
<p>为什么会出现库存重建过程中的上涨与去库存过程中的下跌呢？这是因为，当市场价格开始下跌时，资金是矛盾的主要方面，经销商将商品资源转化为资金，而终端用户则延缓资金采购商品资源的进程，所以库存下降的同时，价格随之快速下跌。</p>
<p>相反，当市场价格上涨时，商品资源是市场的主要矛盾，经销商急于将资金转化为商品资源，而终端用户则将资金用来采购货源，从而形成库存量上升的同时，价格快速上涨。之所以说这才是商品期货趋势的精髓，是因为这种趋势的持续性较长，欺骗性较低，而K线图中所体现的趋势相对较短，波动较大，欺骗性较高，不容易把握。如图3-2所示。</p>
<blockquote>
<p>图3-2 补库周期和去库周期的核心矛盾与价格变化</p>
</blockquote>
<img src="/2022/05/07/第三章-如何理解商品的周期/2.jpg">
<p>实际上完整的库存周期分为四个阶段：被动去库存过程中的价格上涨阶段、主动建库存过程中的价格上涨阶段、被动建库存过程中的价格下跌阶段、主动去库存过程中的价格下跌阶段。其中被动去库阶段和主动建库阶段被称之为补库周期或建库周期，而被动建库和主动去库被称为去库周期。</p>
<p>工业品的库存周期又被称之为基钦周期，这个周期有两大趋势，一是补库上涨趋势和去库下跌趋势，每个趋势又分为两个阶段，补库上涨趋势分为被动去库上涨和主动建库上涨阶段，去库下跌趋势分为被动建库下跌和主动去库下跌阶段。在每个阶段过程中，整个产业链从下游到上游不断传导，库存、利润、产能、开工率不断发生变化，如图3-3所示。</p>
<blockquote>
<p>图3-3 整个库存周期过程中上中下游相关指标的变化</p>
</blockquote>
<img src="/2022/05/07/第三章-如何理解商品的周期/3.jpg">
<p>产业陷入低迷，供需都很薄弱，突然需求开始启动，采购增加，这个时候需求从终端用户需要向零售商、经销商、厂商的传导，存在一定时滞，这个时候需求的增加，带来了现货价格的上涨，而厂商没有扩大生产，经销商也没有主动补库存，这个时候库存是在消耗下降的。所以在被动去库阶段，下游需求增加，中游和上游库存下降，价格开始上涨。</p>
<p>当经销商和厂商发现下游需求起来的时候，会逐渐扩大生产，同时提高产品价格，经销商也会积极建库存，下游需求端预期未来价格会继续上涨，所以会加速采购，需求增加，供需两端发力，价格继续上涨，库存同时累积，这就是库存重建过程中的上涨，此时整个产业链都开始把手中的资金转化为即将升值的库存，因此需求增加，中下游库存开始上涨，价格进一步上涨。</p>
<p>当商品价格过高，市场上库存也很高，需求端由于前期备货充足，开始减少采购，需求下降，价格下跌，而传导时滞的存在，导致厂商还在加大生产，经销商也在备货，这个时候库存还在继续累积，这个阶段下游需求下降，上游供给增加，整个产业链库存都在累积，价格下跌，这是被动建库阶段。</p>
<p>当经销商和厂商发现，下游需求不足时，为了及时将手中的货源转化为资金，避免成为接盘侠，就会降价出售，此时，需求端预期后续价格会继续下降，采购延缓，需要多少采购多少，因为后面再采购成本更低，所以这个时候商品价格不断下降，库存不断下降，就是去库存过程中的下跌。</p>
<p>至此，我们对趋势的理解从K线图中转移到了商品的库存周期当中。K线图中的趋势表象往往会欺骗交易者，而商品的库存周期却无法掩盖商品未来的趋势，只有抓住趋势的精髓才是交易者持仓的勇气所在！</p>
<p>工业品的库存周期是从需求端出发的，工业品主要看需求，供应端可以根据需求端的变化来进行调整；农产品虽然也有库存周期，但是需求端相对稳定，变量较大的主要是供应端，一种作物以年度的产量以及之前年度结余的库存来满足当年的需求，在分析农产品的库存变化时，最常用的就是经济学中的蛛网模型。</p>
<p>蛛网模型的一个基本假设就是，今年的产量取决于前一年的价格，从而得到一个供应曲线，今年的需求量取决于当年的价格，从而得到一个需求曲线。在供给和需求的作用下，得到一个均衡价格，这个价格又会影响到下一年的产量，由于供给曲线和需求曲线的弹性存在差异，从而会出现三种形式的蛛网模型，一种是发散型蛛网、一种是封闭型蛛网、一种是收敛型蛛网。如图3-4所示。</p>
<p>图3-4 三种形式的蛛网模型</p>
<p>当供给曲线的弹性大于需求曲线的弹性时，即供给曲线斜率的绝对值大于需求曲线斜率的绝对值时，在市场受到外力的冲击之后，原有的均衡状态就会被打破，从而使得均衡点发生偏离，实际价格和实际产量的波动幅度会越来越大，从而偏离均衡点越来越远。属于这种类型的农产品，一般遭遇供给冲击之后，价格往往会暴涨，价格上涨的幅度可能远大于产量减少的幅度。如图3-5所示。</p>
<p>图3-5 发散型蛛网模型</p>
<p>当供给曲线的弹性和需求曲线的弹性相等时，即供给曲线斜率的绝对值等于需求曲线斜率的绝对值时，当市场受到外力的冲击之后，原有的均衡状态就会被打破，从而使得均衡点发生偏离，实际价格和实际产量也会发生变化，但与发散型蛛网不同的是，此时实际产量和实际价格适中按照相同幅度围绕着均衡点上下波动，不会不断偏离均衡点，也不会不断靠近均衡点。如图3-6所示。</p>
<p>图3-6 封闭型蛛网模型</p>
<p>当供给曲线的弹性小于需求曲线的弹性时，即供给曲线斜率的绝对值小于需求曲线斜率的绝对值时，在市场受到外力的冲击之后，原有的均衡状态就会被打破，从而使得均衡点发生偏离，实际价格和实际产量的波动幅度会越来越小，从而向均衡点不断靠拢。如图3-7所示。</p>
<p>图3-7 收敛型蛛网模型</p>
<p>当然，也有对蛛网模型有不同意见的，比较著名的是傅海棠老师，从期货交易的角度来讲，他是比较成功的，因为他以较小的资金在期货市场中赚取了几十亿元。因为农民出身，傅海棠老师对农产品有着较为深入的研究。</p>
<p>他认为农民对于农产品是比较有感情的，农产品价格较低的时候，第一年一般亏不到农民这里，而是贸易商发生亏损，农产品连续第二年低价的时候，农民可能会亏钱，但是农民对农作物是有感情的，当年亏钱了并不会导致农民马上改种其他农作物，而很多农民基于对农作物的感情，会选择再种一年看看，说不定来年价格就好了，结果农产品连续第三年价格较低的时候，农民继续亏钱，这次农民可能就亏怕了，开始改种其他的农产品。</p>
<p>所以如果按照蛛网模型，农产品就会每年都有一波行情，要么上涨行情，要么下跌行情，但实际上农产品发生大行情的时候并没有那么频繁，一般是三到四年一波大行情。</p>
<p>商品的周期有的是从人性出发的，通过经济模型得到一个周期的解释，例如工业品的库存周期，农产品的蛛网模型。也有一些周期是从天气变化出发的，通过资金、情绪等层面的投机炒作而得到的一个周期的解释，例如厄尔尼诺和拉尼娜现象对农产品产量的影响。还有一些周期则是基于商品自身生产规律导致的其产量或者供应量的周期性变化。</p>
<p>其中最为典型的就是国内的白糖，国内白糖有两种，一种是以甘蔗为原料制成的甘蔗糖，另一种是以甜菜为原料制成的甜菜糖，其中甘蔗糖占了绝大部分。而国内种植的甘蔗主要以宿根蔗为主，由于纬度和气候的原因，国内宿根蔗的生长周期一般是3年，因为随着宿根蔗年份的增加，其糖分会不断下降，所以一般到了第三年都会砍了重新种植，宿根蔗的3年生长周期，导致了国内白糖产量的3年增产和3年减产周期，价格上也是平均3年牛市和3年熊市。如图3-8所示。</p>
<p>图3-8白糖的6年周期规律</p>
<p>另外，鸡蛋价格也存在类似的周期，其根本原因在于利润驱使下的补栏与蛋鸡生长周期。在蛋鸡养殖利润较差的情况下，就会导致养殖户的养殖积极性下降，补栏开始降低，从而导致蛋鸡的存栏量下降，存栏量的下降导致鸡蛋的供应减少，在供需的作用下，鸡蛋价格开始上涨，从而使得蛋鸡养殖利润开始变好，在养殖利润较好的情况下，养殖户的养殖积极性就比较高，补栏开始增加，从而导致蛋鸡的存栏开始上升，存栏量上升的结果导致鸡蛋的供应增加，在供需的作用下，鸡蛋价格开始下跌，结果利润再次变差。如图3-9所示。</p>
<p>图3-9 蛋鸡养殖周期</p>
<p>鸡蛋价格基本上也是3年左右的一个周期，主要原因在于利润对养殖户补栏行为的影响，养殖户补栏之后，蛋鸡从出壳到产蛋大约120天，产蛋以后大约300天以后产蛋能力就开始下降，蛋鸡的完整的生命周期大约在520天左右，基本上是一年半的时间，一个主动补库周期加上一个主动去库周期大约在3年左右。与蛋价周期类似的还有猪肉价格周期，原理都是一样的。</p>
<p>此外，需要注意的是，这些周期是在市场经济下自然发生的交替性的周期规律，但有时候会因为国家的一些政策原因，导致周期拉长或者缩短，即政策因素可能会改善或者打破周期规律，所以要时刻关注国家对于相关行业领域的政策。</p>
<p>例如，白糖我们采取的配额和关税保护措施，使得国内白糖价格高于国际原糖，国内糖价定价权主要在于广西，一旦我国关税保护措施开始放松，那么国内白糖的价格就容易和国际接轨，而不一定继续遵循宿根蔗的3年生长周期规律。</p>
<p>有些农产品的周期是由于天气导致的，天气的周期性变化与地球的转动速度变化有关，因此，每当这类机会出现时，我们需要去把握。下面以豆粕为例，来简单介绍一下天气因素导致的行情周期，同时简单介绍一下这种周期产生的原因（见图3-10）。</p>
<p>豆粕的4年周期宿命</p>
<p>图3-10 豆粕的4年周期行情</p>
<p>关键词：4年周期、认识周期、分析周期、应用周期。</p>
<p>霍华德.马克思在《周期》中提到周期的三大规律：第一规律：不走直线必走曲线；第二规律：不会相同只会相似；第三规律：少走中间多走极端。他认为，周期毫无疑问是投资中最重要的事情，所以投资者需要学会认识周期、分析周期和应用周期。</p>
<p>大多数交易者都知道糖价周期、猪肉价周期、蛋价周期，但是还有一些可能被我们所忽视的其他周期，例如豆粕的4年周期。从豆粕指数来看，从豆粕2000年上市以来，每个4年就会出现一个价格高点，2004年-2008年-2012年-2016年都一直遵循着这个周期，这是我们对豆粕4年周期最粗浅的认识。</p>
<p>接下来，我们需要去分析一下豆粕的4年周期，当然，我们可能很难把过去的每一年都进行复盘，从中找到周期的规律，所以这里只是简单的对价格高点发生的那一年的行情进行一个简单的回顾，让我们一起看一下，当年都发上了什么事情，从而导致价格的暴涨暴跌。</p>
<p>当然，正如霍华德.马克思所说的，在周期存续期间发⽣的这些事件，不应该只被看作⼀个事件接着⼀个事件地发⽣，⽽应该被看作⼀个事 件引发下⼀个事件，因果关系远远重于先后顺序，只有这样才能够更好地理解周期。只有更好地理解周期，才能更好地应用周期，记住我们所处周期的位置，它会深刻影响我们的获胜机会。</p>
<p>2004年豆粕行情回顾（见图3-11）</p>
<p>图3-11 2004年豆粕行情回顾</p>
<p>关键词：禽流感、紧缩政策、需求不足、毒大豆事件。</p>
<p>1）2004年1季度：强势上涨。</p>
<p>2004年1季度国内豆粕大涨，主要得益于禽流感得到控制，国家开始从税收和补贴角度来扶持养殖行业，豆粕的需求增加，导致一些观望的企业因为库存不足，开始大量采购豆粕，一时间豆粕需求大增，刺激了价格上涨。再加上CBOT大豆价格上涨，进口成本进一步增加，国内油厂也开始纷纷涨价，所以豆粕价格进一步大涨，一季度豆粕指数直接突破3700点。</p>
<p>2）2004年2季度：强势下跌。</p>
<p>2004年2季度国内豆粕大跌，主要在于国家紧缩政策的影响以及对禽流感的低估。尽管国家对家禽养殖进行了扶持，但禽流感度需求造成的影响开始逐步显现，需求端表现不佳，与此同时，国家为了抑制投资过热，采取了宏观调控措施，结果一些企业的资金链比较紧张，开始了大量抛售，从而导致豆粕价格暴跌，走出了一个倒V型反转。</p>
<p>3）2004年3季度：震荡下跌。</p>
<p>2004年3季度国内豆粕震荡下跌，尽管在南美毒大豆事件的影响下，预期国内大豆供应会有所减少，盘面上一度走出一波的反弹行情，但无奈在国家紧缩的宏观调控下以及禽流感的影响下，整体需求不容乐观，市场投机做多的热情也不是很强烈，价格略微反弹之后依然出现了震荡下跌。</p>
<p>4）2004年4季度：偏弱震荡。</p>
<p>2004年4季度国内豆粕偏弱震荡，由于美豆增产，所以价格上涨无力，但由于国外大豆价格下跌，豆农惜售，所以在这种情况下，国内豆粕价格上涨乏力，下跌缺乏空间，一直处于价格低位偏弱震荡状态。2004年之前天气和灾害的炒作似乎并不明显，尽管大豆锈病有可能导致南美大豆减产，但盘面上并没有发生剧烈的反应。</p>
<p>2008年豆粕行情回顾（见图3-12）</p>
<p>图3-12 2008年豆粕行情回顾</p>
<p>关键词：天气因素、生物柴油、奥运会、金融危机。</p>
<p>1）2008年1季度：区间震荡。</p>
<p>2008年1季度豆粕先涨后跌，整体处于区间震荡状态。此时我们国家经济整体向好，整体有一定的通胀趋势，年初的上涨部分原因是因为南方暴雪引发雪灾，整个交通不便，从而引发物价上涨，国际上对生物柴油的炒作，导致外盘大豆价格上涨，内盘豆粕也随之价格上涨。随着价格炒到将近3800点，资金的风险偏好开始上升，价格开始高位回落。国家也采取政策打压物价上涨，例如降低关税、抛出储备期货、控制贷款发放等，所以豆粕价格从高位下跌。</p>
<p>2）2008年2季度：强势上涨。</p>
<p>2008年2季度豆粕价格又迎来了一次大爆发，最直接的原因是美国大豆主产区在6月份遭受了大洪水，导致大豆重播以及收获时间推迟，进而增加了霜冻的可能性，所以市场预期将严重影响未来的单产。在此期间，USDA供需报告不断发相关利好，美国大豆大幅走高，创下了历史新高，而国内豆粕的行情再次被点燃，资金做多的热情非常强烈，期货盘面冲破了4300点。</p>
<p>3）2008年3季度：震荡下跌。</p>
<p>2008年3季度豆粕开启了下跌之路，一方面国内豆粕价格走高，技术上形成了双顶的形态，另一方面全球金融危机爆发，原油暴跌，从147美元/桶跌到35美元/桶，全球都蔓延在悲观的情绪当中，各种商品价格基本上都大幅下跌，市场开始走出来宏观行情，豆粕在天气炒作之后，也跟着全球大宗市场开始回调。</p>
<p>4）2008年4季度：强势下跌。</p>
<p>2008年4季度豆粕继续大幅下跌，主要还是受全球性金融危机的影响，整个市场弥漫着悲观的气息，市场的投机信心严重不足，做多的热情受到了打压，与此同时，国内外大豆价格连续破位下跌。覆巢之下安有完卵，豆粕连续出现一字跌停，价格加速下跌。</p>
<p>2012年豆粕行情回顾（见图3-13）</p>
<p>图3-13 2012年豆粕行情回顾</p>
<p>关键词：天气因素、北美大旱、宏观直下、洗船频发。</p>
<p>1）2012年1季度：强势上涨。</p>
<p>2012年1季度豆粕大涨，其根本的原因是南美大豆遭遇了干旱，市场预期南美大豆减产，外盘美豆价格也因此而不断上涨，再加上国内猪禽养殖需求旺盛，对饲料的需求比较稳定，在此背景下，需求端无忧，供应端由于南美干旱预期减产，所以现货价格不断上涨，期货盘面也是一路温和上涨，价格重心不断上移，逼近3500点大关。</p>
<p>2）2012年2季度：震荡回调。</p>
<p>2012年2季度豆粕震荡回调，一方面是由于南美进口大豆开始到港，而国内港口库存处于较高位置，供应端压力较大，另一方面全球宏观形势比较差，国际上欧债危机爆发，一些国家进行大选加剧了全球的不稳定性，国内螺纹也是一路向下。因为悲观的宏观预期，以及进口大豆到港带来的库存压力，盘面开始了从高位进行回调。</p>
<p>3）2012年3季度：再次大涨。</p>
<p>2012年3季度豆粕价格再次暴涨，根本原因在于拉尼娜导致美国遭遇了56年以来罕见的大旱，年初的南美干旱，再加上北美罕见的大旱，市场对全球大豆产量减产的预期更加强烈，外盘价格不断上涨，内盘豆粕价格也因此创下了年内新高，期货突破了4200点。较高的豆粕价格带来了丰富的榨利，导致许多油厂高价点豆，为后期豆粕的下跌埋下了隐患。</p>
<p>4）2012年4季度：大幅回调。</p>
<p>2012年4季度豆粕开始了下跌之路，在高榨利的驱使下，许多企业高价点豆，市场预期进口到港大豆增加，供应端压力不断显现，而需求端开始逐渐降温，所以资金的热情开始退却，由于之前进口大豆点价成本过高，再加上国内豆粕价格迅速下跌，从而导致许多压榨企业不堪重负，洗船现象频频发生。另外，USDA报告也对减产预期开始进行修复，所以四季度整个豆粕从高位不断回落。</p>
<p>2016年豆粕行情回顾（见图3-14）</p>
<p>图3-14 2016年豆粕行情回顾</p>
<p>关键词：天气因素、超限新规、到港延误、环保整顿。</p>
<p>1）2016年1季度：震荡下跌。</p>
<p>2016年1季度豆粕价格整体处于震荡下跌状态，之所以出现震荡下跌，最主要的原因是终端养殖业产能缩减，当时生猪存栏量同比大幅下跌，存栏量处于低位，饲料需求低迷，成交较低，所以现货价格不断下跌，再加上进口大豆数量的回升，从供应端进一步给豆粕价格施压，所以整个一季度，豆粕价格一路向下。</p>
<p>2）2016年2季度：强势上涨。</p>
<p>2016年2季度豆粕迎来了彻底的大爆发，最根本的原因是受到厄尔尼诺天气炒作，南美大豆预期减产，再加上USDA5月和6月报告也是利多支撑，所以美豆价格不断上涨，在此背景下，压榨企业开始涨价，豆粕价格不断上涨，现货价格一度涨到3400元/吨，有的地区都超过了3500元/吨。</p>
<p>3）2016年3季度：大幅回调。</p>
<p>2016年3季度豆粕从高位开始回调，国内南方地区迎来了暴雨，一些地区受灾严重，水产养殖以及猪禽饲料需求都受到较大影响，豆粕现货价格见顶回落，此外，USDA报告开始逐渐出现利空，外盘价格也是相对偏弱，所以在内部需求不佳以及外盘偏弱的情况下，国内豆粕开启了大幅回调下跌之路。</p>
<p>4）2016年4季度：再次上涨。</p>
<p>2016年4季度豆粕价格开启了回调之后的二次上涨。由于运营货车超载超限新规的实行，导致了物流成本上升，以及进口大豆到港延误，再加上南方广东地区环保整顿油厂，从而导致供应端再次偏紧，豆粕货源变得紧张，因此豆粕再次开启了上涨，不过此次上涨的力度远远小于二季度。</p>
<p>在2004年之前，天气的炒作并不明显，但我们可以发现，从2004年之后，但凡豆粕大涨的年份，都会有天气配合。2008年2季度美豆主产区遭遇了洪水，2012年1季度南美干旱导致大豆减产，3季度北美遭遇56年不遇大旱导致大豆减产，2016年2季度受厄尔尼诺影响南美大豆减产。尽管每次发生大涨行情时，各个事件会依次发生，但事件各不相相同，唯一相同的就是天气因素，所以关于豆粕的这种价格周期的背后，我们认为是天气炒作在作祟。</p>
<p>巧合的是，厄尔尼诺现象平均大约每4年发生1次，拉尼娜常发生于厄尔尼诺之后，但也不是每次都这样。厄尔尼诺与拉尼娜相互转变需要大约4年的时间。所以无论是平均4年发生1次的厄尔尼诺现象，还是平均4年与厄尔尼诺现象相互转变的拉尼娜现象，都与豆粕的每4年出现1次价格高点相吻合。</p>
<p>2008年厄尔尼诺现象，2012年拉尼娜现象，2016年厄尔尼诺现象。所以豆粕4年的价格周期都伴随着天气因素，而这种天气炒作不是厄尔尼诺现象就是拉尼娜现象，而厄尔尼诺现象或拉尼娜现象，是不以人的意志为转移的，它与地球自转有关，会相对周期性的发生。</p>
<p>所以，按照这种规律来看，2008年厄尔尼诺现象→2012年拉尼娜现象→2016年厄尔尼诺现象→2020年拉尼娜现象？所以2019年厄尔尼诺现象有可能转正常，在9月份结束，2020年春天开始爆发拉尼娜现象，此时正值南美大豆生长时期，高温干旱天气可能会导致南美大豆减产。2020年有可能上半年异常燥热，而冬季异常寒冷。</p>
<p>既然厄尔尼诺和拉尼娜现象对农产品的影响这么大，那怎么才能判断是否发生厄尔尼诺或者拉尼娜现象呢？其实，这个很简单，虽然我们并不是气象学家，但对于气象学界的常用工具，我们会用就可以了。</p>
<p>为了监测热带太平洋地区海面水温的变化，气象学界构造了各种指数，通过这些指数的变化来预测发生厄尔尼诺和拉尼娜现象的概率，其中最为著名的就是NINO SST INDEX（尼诺SST指数）。</p>
<p>它把赤道附近的热带太平洋地区根据相应的经纬度（S代表南纬，N代表北纬，E代表东经，W代表西经）进行划分，一共分成了4个区域</p>
<p>l Nino 1+2（0-10S，90W-80W）</p>
<p>l Nino 3（5N-5S，150W-90W）</p>
<p>l Nino 4（5N-5S，160E-150W）</p>
<p>l Nino 3.4（5N-5S，170W-120W）</p>
<p>各个划分的区域如图3-15所示，Nino 1+2这个区域是Nino SST指数当中最小的区域，也是最靠东的区域，它与南美海岸线对应，这个指数往往被当地居民认为最先可能发生厄尔尼诺现象，但问题是这个指数是所有Nino SST指数当中方差最大的一个。</p>
<p>图3-15 Nino SST指数</p>
<p>Nino 3这个区域过去曾是监测和预测厄尔尼诺现象的重要区域，但是后来研究人员发现海洋大气相互作用的关键区域位于西部，所以Nino 3.4在定义厄尔尼诺和拉尼娜现象时备受青睐。</p>
<p>Nino 3.4 这个区域发生异常时需要格外注意，它通常使用5个月的移动平均值，当Nino 3.4 SST超过0.4摄氏度持续6个月或更长时间时，就被定义为厄尔尼诺现象，反之，当Nino 3.4 SST低于-0.4摄氏度持续6个月或更长时间时，就被定义为拉尼娜现象。</p>
<p>Nino 4指数用于捕获赤道太平洋地区中部的SST异常，这个区域的方差往往比其他Nino区域要小。</p>
<p>在上述指数当中，我们观察的比较多的是Nino 1+2，Nino 3，Nino 3.4，Nino 4这4个区域的异常情况。我们可以在Tropical Tidbits这个网站上进行观察，这个网站有各种气象分析工具。</p>
<p>我们可以选择Ocean Analysis来看一下SST Anomaly Time Series，默认就是Nino 3.4区域的时间序列，还可以切换到Nino 1+2，Nino 3，Nino 4等几个区域的时间序列，从而来判断厄尔尼诺与拉尼娜现象的变化和发展情况。</p>
<!-- flag of hidden posts -->
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/期货多空逻辑/" rel="tag"># 期货多空逻辑</a>
          
        </div>
      

      
      
      

      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="CheBin">
            
              <p class="site-author-name" itemprop="name">CheBin</p>
              <div class="site-description motion-element" itemprop="description">看视频才能学会，看文字学不会的</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">1017</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">23</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">72</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          

          
          


          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <!-- modify icon to fire by szw -->
                <i class="fa fa-history fa-" aria-hidden="true"></i>
                近期文章
              </div>
              <ul class="links-of-blogroll-list">
                
                
                  <li>
                    <a href="/2023/04/04/结束语｜秒杀系统之上的业务协同思考/" title="结束语｜秒杀系统之上的业务协同思考" target="_blank">结束语｜秒杀系统之上的业务协同思考</a>
                  </li>
                
                  <li>
                    <a href="/2023/04/04/14｜百万级流量秒杀系统的关键总结/" title="14｜百万级流量秒杀系统的关键总结" target="_blank">14｜百万级流量秒杀系统的关键总结</a>
                  </li>
                
                  <li>
                    <a href="/2023/04/04/13｜优化番外篇：Vertx介绍及快速入门/" title="13｜优化番外篇：Vertx介绍及快速入门" target="_blank">13｜优化番外篇：Vertx介绍及快速入门</a>
                  </li>
                
                  <li>
                    <a href="/2023/04/04/12｜高性能优化：单机Java极致优化/" title="12｜高性能优化：单机Java极致优化" target="_blank">12｜高性能优化：单机Java极致优化</a>
                  </li>
                
                  <li>
                    <a href="/2023/04/04/11｜高性能优化：物理机极致优化/" title="11｜高性能优化：物理机极致优化" target="_blank">11｜高性能优化：物理机极致优化</a>
                  </li>
                
              </ul>
            </div>
        

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2023</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CheBin</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">站点总字数：</span>
    
    <span title="站点总字数">8.2m</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    
    <span title="站点阅读时长">124:48</span>
  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a></div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.1"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.1"></script>



  
  <script src="/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  

  

  


  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  

  
  

  


  

  

  

  

  

  

  

  

  
<script>
  $('.highlight').each(function(i, e) {
    var $wrap = $('<div>').addClass('highlight-wrap');
    $(e).after($wrap);
    $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function(e) {
      var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
        return $(e).text();
      }).toArray().join('\n');
      var ta = document.createElement('textarea');
      var yPosition = window.pageYOffset || document.documentElement.scrollTop;
      ta.style.top = yPosition + 'px'; // Prevent page scroll
      ta.style.position = 'absolute';
      ta.style.opacity = '0';
      ta.readOnly = true;
      ta.value = code;
      document.body.appendChild(ta);
      ta.select();
      ta.setSelectionRange(0, code.length);
      ta.readOnly = false;
      var result = document.execCommand('copy');
      
        if (result) $(this).text('复制成功');
        else $(this).text('复制失败');
      
      ta.blur(); // For iOS
      $(this).blur();
    })).on('mouseleave', function(e) {
      var $b = $(this).find('.copy-btn');
      setTimeout(function() {
        $b.text('复制');
      }, 300);
    }).append(e);
  })
</script>


  

  

</body>
</html>
