<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2">





















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="思考并回答以下问题：  基差的算法是什么样的？哪个价格在前面？为什么？">
<meta name="keywords" content="期货与衍生品基础">
<meta property="og:type" content="article">
<meta property="og:title" content="第四章-套期保值">
<meta property="og:url" content="http://yoursite.com/2022/02/04/第四章-套期保值/index.html">
<meta property="og:site_name" content="车斌的技术博客">
<meta property="og:description" content="思考并回答以下问题：  基差的算法是什么样的？哪个价格在前面？为什么？">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/2022/02/04/第四章-套期保值/t-1.png">
<meta property="og:image" content="http://yoursite.com/2022/02/04/第四章-套期保值/t-2.png">
<meta property="og:image" content="http://yoursite.com/2022/02/04/第四章-套期保值/t-3.png">
<meta property="og:image" content="http://yoursite.com/2022/02/04/第四章-套期保值/t-4.png">
<meta property="og:image" content="http://yoursite.com/2022/02/04/第四章-套期保值/t-5.png">
<meta property="og:image" content="http://yoursite.com/2022/02/04/第四章-套期保值/t-6.png">
<meta property="og:image" content="http://yoursite.com/2022/02/04/第四章-套期保值/t-7.png">
<meta property="og:image" content="http://yoursite.com/2022/02/04/第四章-套期保值/1.png">
<meta property="og:updated_time" content="2022-03-24T01:47:53.536Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第四章-套期保值">
<meta name="twitter:description" content="思考并回答以下问题：  基差的算法是什么样的？哪个价格在前面？为什么？">
<meta name="twitter:image" content="http://yoursite.com/2022/02/04/第四章-套期保值/t-1.png">






  <link rel="canonical" href="http://yoursite.com/2022/02/04/第四章-套期保值/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>第四章-套期保值 | 车斌的技术博客</title><meta name="robots" content="noindex">
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">车斌的技术博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">专注</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2022/02/04/第四章-套期保值/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CheBin">
      <meta itemprop="description" content="绝知此事要躬行，不动手就是懒。一篇文章看10遍，而不是10篇文章看1遍。">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="车斌的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">第四章-套期保值

              
            
          </h1>
        

        <div class="post-meta">

          

          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2022-02-04 11:15:13" itemprop="dateCreated datePublished" datetime="2022-02-04T11:15:13+08:00">2022-02-04</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2022-03-24 09:47:53" itemprop="dateModified" datetime="2022-03-24T09:47:53+08:00">2022-03-24</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/期货/" itemprop="url" rel="index"><span itemprop="name">期货</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">7.6k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">7 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>思考并回答以下问题：</p>
<ul>
<li>基差的算法是什么样的？哪个价格在前面？为什么？</li>
</ul>
<a id="more"></a>
<p>期货市场的基本功能之一是规避风险。这一功能可以通过套期保值操作来实现。</p>
<h1 id="套期保值的概念与原理"><a href="#套期保值的概念与原理" class="headerlink" title="套期保值的概念与原理"></a><span style="color:#339AFF;">套期保值的概念与原理</span></h1><h2 id="套期保值的概念"><a href="#套期保值的概念" class="headerlink" title="套期保值的概念"></a><span style="color:#00ACC1;">套期保值的概念</span></h2><p>套期保值，又称避险、对冲等。广义上是指企业利用一个或一个以上的工具进行交易，预期全部或部分对冲其生产经营中所面临的价格风险的方式。在此定义中，套期保值交易可选取的工具是比较多的，通常有期货、期权、远期、互换等衍生工具。</p>
<p>本章主要讲述的是期货的套期保值。期货的套期保值是指企业通过持有与其现货市场头寸相反的期货合约，或将期货合约作为其现货市场未来要进行的交易的替代物，预期对冲价格风险的方式。</p>
<h2 id="套期保值的原理"><a href="#套期保值的原理" class="headerlink" title="套期保值的原理"></a><span style="color:#00ACC1;">套期保值的原理</span></h2><p>套期保值可以起到风险对冲的作用，根本原理在于：期货价格与现货价格受到相似的供求等因素影响，两者的变动趋势基本一致。据此，通过套期保值，无论价格是涨还是跌，总会出现一个市场盈利而另一个市场亏损的情形，盈亏相抵，就可以规避因为价格波动而带来的风险，实现稳健经营。</p>
<p>在套期保值操作中要实现“风险对冲”，应满足以下条件：</p>
<p>（1）在套期保值数量选择上，要使期货与现货市场的价值变动大体相当。</p>
<p>在期货价格与现货价格变动趋于一致的情况下，企业可选择与其现货数量相当的期货合约数量，以保证期货与现货两个市场的价值变动大体相当。套期保值比率，即套期保值中期货合约所代表的数量与被套期保值的现货数量之间的比率，通常为1。</p>
<p>如果不存在与被套期保值的商品或资产相同的期货合约，企业可以选择其他的相关期货合约进行套期保值，选择的期货合约头寸的价值变动与实际的、预期的现货头寸的价值变动大体上应相当。这种选择与被套期保值商品或资产不相同但相关的期货合约进行的套期保值，称为交叉套期保值。</p>
<p>（2）在期货头寸方向的选择上，应与现货头寸相反或作为现货未来交易的替代物。</p>
<p>现货头寸包括多头和空头两种情况。当企业持有实物商品或资产，或者已按固定价约定在未来购买某商品或资产时，该企业处于现货的多头；当企业已按某固定价格约定在未来出售某商品或资产，但尚未持有实物商品或资产时，该企业处于现货的空头。</p>
<p>有时企业在现货市场既不是多头，也不是空头，而是计划在未来买入或卖出某商品或资产。这种情形也可以进行套期保值，在期货市场建立的头寸是作为现货市场未来要进行的交易的替代物。此时，期货市场建立的头寸方向与未来要进行的现货交易的方向是相同的。</p>
<blockquote>注意 期货头寸方向的选择一旦错误，企业不仅不能实现风险对冲，而且会使价格风险加倍增大。
</blockquote>

<blockquote> 考点回顾 单选
某建筑企业已与某钢材贸易商签订钢材的采购合同，确立了价格，但尚未实现交收，此时该建筑企业属于（）情形。
A.期货多头 B.现货多头 C.期货空头 D.现货空头
【答案】B
</blockquote>

<p>（3）期货头寸持有时间段与现货承担风险的时间段相对应。</p>
<p>当企业在现货市场的头寸已经了结或者现货交易已经实现时，企业应该将套期保值的期货头寸进行平仓，或者通过到期交割的方式将现货头寸和期货头寸同时进行了结。</p>
<p>这种时间段上的对应，并不一定是期货合约月份的选择与现货市场承担风险的时期完全对应起来，通常要求合约月份等于或远于这一时间段。有时企业套期保值的时间跨度特别长，例如，石油开采企业可能对未来5年甚至更长的时间的原油生产进行套期保值，此时市场上尚没有对应的远月期货合约挂牌，那么在选择合约时，可以先买入目前挂牌的1年后交割的合约，然后在它到期之前进行平仓，同时在更远期的合约上建仓。这种操作称为展期，即用远月合约调换近月合约，将持仓向后移。</p>
<h2 id="套期保值的运用"><a href="#套期保值的运用" class="headerlink" title="套期保值的运用"></a><span style="color:#00ACC1;">套期保值的运用</span></h2><p>套期保值的本质是“风险对冲”。通过套期保值，企业能够降低风险，实现稳健经营。因此，在评价套期保值效果时，应将期货头寸的盈亏与现货盈亏作为一个整体进行评价，两者冲抵的程度越大，则规避风险的效果越好。</p>
<p>但是，套期保值作为企业规避价格风险的可选择手段，并不一定适合所有企业。企业在权衡是否进行套期保值时，要进行对收益与成本的分析。套期保值操作具有规模经济的特点，即对于规模大的企业，进行套期保值的平均成本要低于规模小的企业。</p>
<p>除此之外，如果价格波动幅度不大，或者企业抗风险能力较强、价格的较大波动对其利润影响不大，再或者企业希望承担一定风险来获取更高的回报，企业也不必进行套期保值操作。</p>
<h1 id="套期保值的种类"><a href="#套期保值的种类" class="headerlink" title="套期保值的种类"></a><span style="color:#339AFF;">套期保值的种类</span></h1><p>套期保值的目的是规避价格波动的风险，而价格的变化包括上涨和下跌两种情形，相应地，套期保值可分为卖出套期保值和买入套期保值。</p>
<h2 id="卖出套期保值"><a href="#卖出套期保值" class="headerlink" title="卖出套期保值"></a><span style="color:#00ACC1;">卖出套期保值</span></h2><p>（一）卖出套期保值的概念</p>
<p>卖出套期保值，也称空头套期保值，是指套期保值者通过在期货市场建立空头头寸，以期对冲其目前持有的或者未来将卖出的商品或资产的价格下跌风险的操作。</p>
<p>（二）卖出套期保值适用的情形</p>
<p>卖出套期保值的操作主要适用于下列情形：</p>
<p>（1）持有某种商品或资产（即持有现货多头头寸），担心市场价格下跌，会使其持有的商品或资产的市场价值下降，或者其销售收益下降。</p>
<p>（2）已经按固定价格买入未来交收的商品或资产（即持有现货多头头寸），担心市场价格下跌，会使其商品或资产市场价值下降或其销售收益下降。</p>
<p>（3）预计在未来要销售某种商品或资产，但销售价格尚未确定，担心市场价格下跌，会使其销售收益下降。</p>
<blockquote>
<p>考点回顾 多选<br>2016年9月10日，白糖现货价格为6200元/吨。某糖厂决定利用白糖期货对其生产的白糖进行套期保值，当天以6150元/吨的价格在11月份白糖期货合约上建仓。10月10日，白糖现货价格跌至5700元/吨，期货价格跌至5720元/吨，该糖厂（）。<br>A.现货市场亏损480元/吨 B.期货市场盈利430元/吨<br>C.期货市场盈利450元/吨 D.期货市场的盈利与现货市场的亏损未完全抵消<br>【答案】BD</p>
</blockquote>
<p>【精析】该糖厂的套期保值结果如表4-1所示。</p>
<blockquote>
<p>表4-1 卖出套期保值分析</p>
</blockquote>
<img src="/2022/02/04/第四章-套期保值/t-1.png">
<p>本题中，该糖厂通过在期货市场建立一个空头头，进行卖出套期保值操作以规避价格下跌风险。由于现货白糖价格下跌，该糖厂每吨白糖少赚500元，即现货市场亏损500元/吨。期货市场因价格下跌盈利430元/吨，现货市场的亏损没有完全被期货市场的盈利对冲，是不完全套期保值，存在净亏损70元/吨。</p>
<h2 id="买入套期保值"><a href="#买入套期保值" class="headerlink" title="买入套期保值"></a><span style="color:#00ACC1;">买入套期保值</span></h2><p>（一）买入套期保值的概念</p>
<p>买入套期保值，也称多头套期保值，是指套期保值者通过在期货市场建立多头头寸，以期对冲其现货商品或资产空头，或者未来将买入的商品或资产的价格上涨风险的操作。</p>
<p>（二）买入套期保值适用的情形</p>
<p>买入套期保值的操作主要适用于下列情形：</p>
<p>（1）当预计未来要购买某种商品或资产，购买价格尚未确定时，担心市场价格，会使其购入成本提高。</p>
<p>（2）目前尚未持有某种商或资产，但按固定价格将该商品或资产卖出（即处于现货空头头寸），担心市场价格上涨，会影响其销售收益或者采购成本。</p>
<blockquote>
<p>考点回顾 综合<br>我国某榨油厂预计两个月后需要1000吨大豆作为原料，决定进行大豆套期保值交易。该厂在期货合约上的建仓价格为4080元/吨。两个月后，大豆现货价格为4350元/吨，该厂以此价格购入大豆，同时以4420元/吨的价格将期货合约对冲平仓，则该厂的套期保值效果是（）。（不计手续费等费用）<br>A.有净盈利40元/吨 B.期货市场与现货市场盈亏刚好相抵<br>C.有净盈利340元   D.有净亏损40元/<br>【答案】A<br>【精析】该榨油厂的套期保值果如表4-2所示。</p>
<p>表4-2 买入套期保值分析</p>
</blockquote>
<img src="/2022/02/04/第四章-套期保值/t-2.png">
<p>本题中，该榨油厂通过在期货市场上建立一个多头头寸，进行买入套期保值操作以规避价格下跌风险。该榨油厂在过了2个月后以4350元/吨的价格购入大豆，比2个月前购买大豆多支付了300元/吨，即现货市场亏损了300元/吨。在期货市场上，由于大豆价格上涨，盈利了340元/吨，现货市场与期货市场的亏盈相抵后，存在净盈利40元/吨。</p>
<h2 id="卖出套期保值与买入套期保值的区别"><a href="#卖出套期保值与买入套期保值的区别" class="headerlink" title="卖出套期保值与买入套期保值的区别"></a><span style="color:#00ACC1;">卖出套期保值与买入套期保值的区别</span></h2><p>卖出套期保值与买入套期保值的区别如表4-3所示。</p>
<blockquote>
<p>表4-3 卖出套期保值与买入套期保值的区别</p>
</blockquote>
<img src="/2022/02/04/第四章-套期保值/t-3.png">
<h1 id="基差与套期保值效果"><a href="#基差与套期保值效果" class="headerlink" title="基差与套期保值效果"></a><span style="color:#339AFF;">基差与套期保值效果</span></h1><p>假设期货价格与现货价格变动幅度一致，两个市场的盈亏完全冲抵的条件下进行的套期保值被称为完全套期保值或理想套期保值。但是，盈亏完全冲抵是一种理想化的状态，现实中期现货市场价格变动幅度并不完全一致。这就会导致不完全套期保值或非理想套期保值。</p>
<p>本节引入“基差”的概念描述期货价格与现货价格的关系，进而分析其对套期保值效果的影响。</p>
<h2 id="基差的概念"><a href="#基差的概念" class="headerlink" title="基差的概念"></a><span style="color:#00ACC1;">基差的概念</span></h2><p>基差是指某一特定地点某种商品或资产的现货价格与相同商品或资产的某一特定期货合约价格间的价差。其用公式可表示为：<span style="color:red">基差 = 现货价格 - 期货价格</span>。</p>
<p>不同的交易者，由于关注的商品品质不同，参考的期货合约月份不同，以及现货地点不同，所以关注的基差也会不同。</p>
<h2 id="基差走强与基差走弱"><a href="#基差走强与基差走弱" class="headerlink" title="基差走强与基差走弱"></a><span style="color:#00ACC1;">基差走强与基差走弱</span></h2><p>人们通常用“强”或“弱”来评价基差的变化。</p>
<p>（1）当基差变大时，称为“走强”。基差走强常见的情形有：①现货价格涨幅超过期货价格涨幅；②现货价格跌幅小于期货价格跌幅。也就是说，相对于期货价格表现而言，现货价格走势相对较强。</p>
<p>（2）当基差变小时，称为“走弱”。基差走弱常见的情形有：①现货价格涨幅小于期货价格涨幅；②现货价格跌幅超过期货价格跌幅。也就是说，相对于期货价格表现而言，现货价格走势相对较弱。</p>
<h2 id="基差变动与套期保值效果"><a href="#基差变动与套期保值效果" class="headerlink" title="基差变动与套期保值效果"></a><span style="color:#00ACC1;">基差变动与套期保值效果</span></h2><p>（一）基差变动与卖出套期保值</p>
<p>1，基差走强与卖出套期保值</p>
<p>5月份，某进口商以67000元/吨的价格从国外进口铜，并利用铜期货进行套期保值，以67500元/吨的价格卖出9月份铜期货合约。与此同时，该进ロ商与某电缆厂协商以9月份铜期货合约为基准价，以低于期货价格100元/吨的价格出售。8月10日，电缆厂以65700元/吨的期货价格作为基准价，进行实物交收。同时该进口商按价格将期货合约对冲平仓。此时现货市场铜价格为65600元/吨。套期保值果如表4-4所示。</p>
<blockquote>
<p>表4-4 卖出套期保值结果（基差走强情形）</p>
</blockquote>
<img src="/2022/02/04/第四章-套期保值/t-4.png">
<p>分析：在该案例中，由于现货价格下跌幅度小于期货价格下跌幅度，基差走强400元/吨。期货市场盈利1800元/吨，现货市场亏损1400元/吨，两者相抵后存在净盈利400元/吨。通过套期保值，该进口商售出铜的实际价格相当于是：现货市场实际销售价格十期货市场每盈利=65600+1800=67400（元/吨）。该价格要比5月份的价格高40元/吨，而这400元/吨正是基差走强的变化值。这说明，进行卖出套期保值时，如果基差走强，两个市场盈亏相抵后存在净盈利400元/吨，它可以使套期保值者获得一个更为理想的价格。</p>
<p>2，基差走弱与卖出套期保值</p>
<p>9月初，白糖现货价格为6200元/吨。某糖厂决定利用白糖期货对其生产的白糖进行套期保值，当天以6150元/吨的价格在11月份白糖期货合约上建仓。10月初，白糖现货价格跌至5700元/吨，期货价格跌至5720元/吨。套期保值结果如表4一5所示。</p>
<blockquote>
<p>表4-5 卖出套期保值结果（基差走弱情形）</p>
</blockquote>
<img src="/2022/02/04/第四章-套期保值/t-5.png">
<p>分析：在该案例中，由于现货价格下降幅度大于期货价格下降幅度，基差走弱70元/吨。期货市场盈利430元/吨，现货市场亏损500元/吨，两者相抵后存在净亏损70元/吨。通过套期保值，该经销商售出钢材的实际价格相当于是：现货市场实际销售价格十期货市场每吨盈利=5700+430=6130（元/吨）。该价格要比9月初的6200元/吨的现货价格低70元/吨，而这70元/吨正是基差走弱的变化值。这说明，进行卖出套期保值，如果基差走弱，两个市场盈亏相抵后存在净亏损，它将使套期保值者承担基差变动不利的风险，其价格与其预期价格相比要略差一些。</p>
<p>（二）基差变动与买入套期保值</p>
<p>1，基差走强与买入套期保值</p>
<p>3月初，某纺织厂计划在3个月后购进棉花，决定利用棉花期货进行套期保值。3月5日该厂在7月份棉花期货合约上建仓，成交价格为21300元/吨，此时棉花的现货价格为20400元/吨。至6月5日，期货价格为19700元/吨，现货价格19200元/吨，该厂按此价格购进棉花，同时将期货合约对冲平仓。套期保值结果如表4-6所示。</p>
<blockquote>
<p>表4-6 买入套期保值结果（基差走强情形</p>
</blockquote>
<img src="/2022/02/04/第四章-套期保值/t-6.png">
<p>分析：在该案例中，由于现货价格下跌幅度小于期货价格下跌幅度，基差走强400元/吨。期货市场亏损1600元/吨，现货市场盈利1200元/吨，两者相抵后存在净亏损400元/吨。通过套期保值，该纺织厂购入棉花的实际价格相当于是：现货市场实际采购价格十期货市场每亏损=19200+1600=20800（元/吨）。该价格要比3月初的20400元/吨的现货价格高400元/吨，而这400元/正是基差走强的变化值。这说明，进行买入套期保值，如果基差走强，两个市场盈亏相抵后存在净亏损，它将使套期保值者承担基差变动不利的风险，其价格与其预期价格相比要略差一些</p>
<p>2，基差走弱与买入套期保值</p>
<p>4月初，某企业在8月份黄金期货合约上的建仓价格为305元/克，当时市场上黄金的实际售价为300元/克。7月初，黄金期货价格升至325元/克，现货价格升至318元/克。该企业在现货市场购买黄金，同时将期货合约对冲平仓，该企业套期保值效果如表47所示。（不计手续费等费用）</p>
<blockquote>
<p>表4-7 卖出套期保值结果（基差走弱情形）</p>
</blockquote>
<img src="/2022/02/04/第四章-套期保值/t-7.png">
<p>分析：在该案例中，由于现货价格上涨幅度小于期货价格上涨幅度，基差走弱2元/克。期货市场盈利20元/克，现货市场亏损18元/克，两者相抵后存在净盈利2元/克。通过套期保，该企业购入黄金的实际价格相当于是：现货市场实际采购价格一期货市场每吨盈利=318-20=298（元/克）。该价格要比4月初的300元/克的现货价格低2元/克，而这2元/克正是基差走弱的变化值。这说明，进行买入套期保值，如果基差走弱，两个市场盈亏相抵后存在净盈利，它将使套期保值者获得的价格比其预期价格还要更理想。</p>
<p>根据以上分析，我们可以将买入套期保值和卖出套期保值在基差不同变化情形下的效果进行概括，如图4-1所示。</p>
<blockquote>
<p>图4-1 基差变动与套期保值的效果关系</p>
</blockquote>
<img src="/2022/02/04/第四章-套期保值/1.png">
<h2 id="影响基差的因素"><a href="#影响基差的因素" class="headerlink" title="影响基差的因素"></a><span style="color:#00ACC1;">影响基差的因素</span></h2><p>基差变动会给套期保值的效果带来不确定性，即为基差风险。套期保值的实质是用较小的基差风险代替较大的现货价格风险。基差的大小主要取决于持仓费。</p>
<p>持食费也称为持食成本，是指为拥有或保貿某种商品、资产等而支付的储费、保险费和利息等费用的总和。</p>
<p>持仓费的高低与距期货合约到期时间的长短有关，距交割时间越近，持仓费就越低。理论上讲，当期货合约到期时，持仓费会减小到零，基差也将变为零。</p>
<h2 id="正向市场与反向市场"><a href="#正向市场与反向市场" class="headerlink" title="正向市场与反向市场"></a><span style="color:#00ACC1;">正向市场与反向市场</span></h2><p>（一）正向市场</p>
<p>正向市场，是指当期货价格高于现货价格或者远期期货合约价格高于近期期货合约价格时的一种市场状态，此时基差为负值。正向市场主要反映了持仓费。在正向市场中，期货价格高出现货价格的部分与持仓费的高低有关，而持仓费的高低与持有商品的时间长短有关。一般而言，距离交割的期限越近，持有商品的成本就越低，期货价格高出现货价格的部分就越少。当交割月到来时，持仓费将降为零，期货价格和现货价格将趋同。</p>
<p>（二）反向市场</p>
<p>反向市场又称逆转市场、现货溢价，是指当现货价格高于期货价格或者近期期货合约价格高于远期期货合约价格时的一种市场状态，此时基差为正值。</p>
<p>反向市场的出现有以下两个原因：①近期对某种商品或资产的需求非常迫切，远大于近期产量及库存量，使现货价格大幅度增加，高于期货价格；②预计将来某商品的供给会大幅度增加，导致期货价格大幅度下降，低于现货价格。</p>
<p>反向市场的价格关系并不意味着现货持有者没有持仓费的支出，只要持有现货并储存到未来某一时期，仓储费、保险费、利息成本的支出就是必须承担的。不过，在反向市场上，由于市场对现货及近期月份合约需求迫切，购买者愿意承担全部持仓费来持有现货。在反向市场上，随着时间的推进，现货价格与期货价格如同在正向市场上一样，会逐步趋同，到交割期趋于一致</p>
<blockquote>
<p>考点回顾 多选<br>（一）属于反向市场。<br>A.远期期货合约价格低于近期期货合约价格<br>B.远期期货合约价格高于近期期货合约价格<br>C.期货价格低于现货价格<br>D.期货价格高于现货价格<br>【答案】AC</p>
</blockquote>
<h2 id="基差交易"><a href="#基差交易" class="headerlink" title="基差交易"></a><span style="color:#00ACC1;">基差交易</span></h2><p>基差交易能较好地降低套期保值的基差风险，是随着点价交易的出现而出现的，是一种结合点价交易与套期保值的操作方式。</p>
<p>（一）点价交易</p>
<p>点价交易，是指以某月份的期货价格为计价基础，通过期货价格加上或减去双方协商同意的升贴水来确定双方买卖现货商品的价格的定价方式。</p>
<p>点价交易从本质上来看是一种为现货贸易定价的方式，交易双方并不需要参与期货交易。</p>
<p>之所以使用期货市场的价格来为现货交易定价，主要是因为期货价格是通过集中、公开竟价方式形成的，具有公开性、连续性、预测性和权威性。使用大家都公认的、合理的期货价格来定价，可以省去交易者搜寻价格信息、讨价还价的成本，提高交易的效率。</p>
<p>在点价交易中，贸易双方是以约定的某月份期货价格为基准，在此基础上加减一个升贴水来确定现货价格的。升贴水的高低，与点价所选取的期货合约月份的远近、期货交割地与现货交割地之间的运费以及期货交割商品品质与现货交割商品品质的差异有关。由于在国际大宗商品贸易中，普遍应用点价交易，升贴水的确定也是市场化的，有许多经纪商提供升贴水报价，交易商可以很容易确定升贴水的水平。</p>
<p>根据确定具体时点的实际交易价格的权利归属划分，点价交易可分为买方叫价交易和卖方叫价交易。如果确定交易时间的权利属于买方，称为买方叫价交易；如果确定交易时间的权利属于卖方，则称为卖方叫价交易。</p>
<p>（二）基差交易的应用</p>
<p>交易者可以将点价交易与套期保值结合在一起进行操作，形成基差交易。</p>
<p>基差交易，是指企业按某一期货合约价格加上或减去升贴水方式确立点价方式的同时，在期货市场进行套期保值操作，从而降低套期保值中的基差风险的操作。基差交易与一般的套期保值操作的不同点是，由于基差交易是点价交易与套期保值操作相结合，在套期保值头寸了结的时候，对应的基差基本上等于点价交易时确立的升贴水。这保证了在套期保值建仓时，就已经知道了平仓时的基差，从而达到减少基差变动的不确定性，降低基差风险的目的。</p>
<h2 id="企业开展套期保值业应注意的事项"><a href="#企业开展套期保值业应注意的事项" class="headerlink" title="企业开展套期保值业应注意的事项"></a><span style="color:#00ACC1;">企业开展套期保值业应注意的事项</span></h2><p>虽然，套期保值操作可以在一定程度上规避价格风险，但并不能保证企业做套期保值就是进了“保险箱”。事实上，在套期保值操作中，企业除了面临基差变动风险之外，还会面临流动性风险、现金流风险、操作风险等各种风险。因此，企业在进行套期保值时，应注意以下几点：</p>
<p>（1）企业在参与期货套期保值之前，应该结合自身情况进行评估，来判断是否有套期保值需求，以及是否具备实施套期保值操作的能力。</p>
<p>（2）企业应完善套期保值的机构设置，来保证套期保值效果，因为规范的组织体系是科学决策、高效执行和风险控制的重要前提和基本保障。</p>
<p>（3）企业应该具备健全的内部控制制度和风险管理制度。</p>
<p>（4）企业应加强对套期保值交易中现金流风险、流动性风险和操作风险等的管理。</p>
<!-- flag of hidden posts -->
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/期货与衍生品基础/" rel="tag"># 期货与衍生品基础</a>
          
        </div>
      

      
      
      

      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="CheBin">
            
              <p class="site-author-name" itemprop="name">CheBin</p>
              <div class="site-description motion-element" itemprop="description">绝知此事要躬行，不动手就是懒。一篇文章看10遍，而不是10篇文章看1遍。</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">444</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">15</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">46</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          

          
          


          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <!-- modify icon to fire by szw -->
                <i class="fa fa-history fa-" aria-hidden="true"></i>
                近期文章
              </div>
              <ul class="links-of-blogroll-list">
                
                
                  <li>
                    <a href="/2022/07/01/B+树索引的使用/" title="B+树索引的使用" target="_blank">B+树索引的使用</a>
                  </li>
                
                  <li>
                    <a href="/2022/06/30/工作面试老大难-锁/" title="工作面试老大难-锁" target="_blank">工作面试老大难-锁</a>
                  </li>
                
                  <li>
                    <a href="/2022/06/30/事务隔离级别和MVCC/" title="事务隔离级别和MVCC" target="_blank">事务隔离级别和MVCC</a>
                  </li>
                
                  <li>
                    <a href="/2022/06/16/专题式讲解-语句加锁分析实例/" title="专题式讲解-语句加锁分析实例" target="_blank">专题式讲解-语句加锁分析实例</a>
                  </li>
                
                  <li>
                    <a href="/2022/04/29/2-Gin路由/" title="2-Gin路由" target="_blank">2-Gin路由</a>
                  </li>
                
              </ul>
            </div>
        

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#套期保值的概念与原理"><span class="nav-number">1.</span> <span class="nav-text">套期保值的概念与原理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#套期保值的概念"><span class="nav-number">1.1.</span> <span class="nav-text">套期保值的概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#套期保值的原理"><span class="nav-number">1.2.</span> <span class="nav-text">套期保值的原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#套期保值的运用"><span class="nav-number">1.3.</span> <span class="nav-text">套期保值的运用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#套期保值的种类"><span class="nav-number">2.</span> <span class="nav-text">套期保值的种类</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#卖出套期保值"><span class="nav-number">2.1.</span> <span class="nav-text">卖出套期保值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#买入套期保值"><span class="nav-number">2.2.</span> <span class="nav-text">买入套期保值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#卖出套期保值与买入套期保值的区别"><span class="nav-number">2.3.</span> <span class="nav-text">卖出套期保值与买入套期保值的区别</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#基差与套期保值效果"><span class="nav-number">3.</span> <span class="nav-text">基差与套期保值效果</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#基差的概念"><span class="nav-number">3.1.</span> <span class="nav-text">基差的概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基差走强与基差走弱"><span class="nav-number">3.2.</span> <span class="nav-text">基差走强与基差走弱</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基差变动与套期保值效果"><span class="nav-number">3.3.</span> <span class="nav-text">基差变动与套期保值效果</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#影响基差的因素"><span class="nav-number">3.4.</span> <span class="nav-text">影响基差的因素</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#正向市场与反向市场"><span class="nav-number">3.5.</span> <span class="nav-text">正向市场与反向市场</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基差交易"><span class="nav-number">3.6.</span> <span class="nav-text">基差交易</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#企业开展套期保值业应注意的事项"><span class="nav-number">3.7.</span> <span class="nav-text">企业开展套期保值业应注意的事项</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2022</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CheBin</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">站点总字数：</span>
    
    <span title="站点总字数">4.3m</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    
    <span title="站点阅读时长">65:13</span>
  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a></div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.1"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.1"></script>



  
  <script src="/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  

  

  


  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  

  
  

  


  

  

  

  

  

  

  

  

  
<script>
  $('.highlight').each(function(i, e) {
    var $wrap = $('<div>').addClass('highlight-wrap');
    $(e).after($wrap);
    $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function(e) {
      var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
        return $(e).text();
      }).toArray().join('\n');
      var ta = document.createElement('textarea');
      var yPosition = window.pageYOffset || document.documentElement.scrollTop;
      ta.style.top = yPosition + 'px'; // Prevent page scroll
      ta.style.position = 'absolute';
      ta.style.opacity = '0';
      ta.readOnly = true;
      ta.value = code;
      document.body.appendChild(ta);
      ta.select();
      ta.setSelectionRange(0, code.length);
      ta.readOnly = false;
      var result = document.execCommand('copy');
      
        if (result) $(this).text('复制成功');
        else $(this).text('复制失败');
      
      ta.blur(); // For iOS
      $(this).blur();
    })).on('mouseleave', function(e) {
      var $b = $(this).find('.copy-btn');
      setTimeout(function() {
        $b.text('复制');
      }, 300);
    }).append(e);
  })
</script>


  

  

</body>
</html>
