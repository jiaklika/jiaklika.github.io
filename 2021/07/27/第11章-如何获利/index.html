<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2">





















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">
<meta name="keywords" content="通向财务自由之路">
<meta property="og:type" content="article">
<meta property="og:title" content="第11章 如何获利">
<meta property="og:url" content="http://yoursite.com/2021/07/27/第11章-如何获利/index.html">
<meta property="og:site_name" content="车斌的技术博客">
<meta property="og:description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2021-11-05T07:47:08.241Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第11章 如何获利">
<meta name="twitter:description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">






  <link rel="canonical" href="http://yoursite.com/2021/07/27/第11章-如何获利/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>第11章 如何获利 | 车斌的技术博客</title><meta name="robots" content="noindex">
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">车斌的技术博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">专注</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/07/27/第11章-如何获利/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CheBin">
      <meta itemprop="description" content="绝知此事要躬行，不动手就是懒。一篇文章看10遍，而不是10篇文章看1遍。">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="车斌的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">第11章 如何获利

              
            
          </h1>
        

        <div class="post-meta">

          

          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2021-07-27 15:48:46" itemprop="dateCreated datePublished" datetime="2021-07-27T15:48:46+08:00">2021-07-27</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2021-11-05 15:47:08" itemprop="dateModified" datetime="2021-11-05T15:47:08+08:00">2021-11-05</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/期货/" itemprop="url" rel="index"><span itemprop="name">期货</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">11k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">10 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>思考并回答以下问题：</p>
<ul>
<li>总结一下，这章作者最主要想表达什么观点？</li>
</ul>
<a id="more"></a>
<p>你必须知道何时持有；知道何时放手；知道何时走开；知道何时跑开。——肯尼·罗杰斯，摘自《赌博者》</p>
<p>杰克·施瓦格在他的《市场奇才》中所描述的其中一位杰出的交易商曾在我们的一次研讨会上说，如果你想知道怎样进行交易，就应该去海滩看看海浪，很快你会注意到海浪拍击海岸，然后又掉转头，回归大海。他接着建议说，你开始随着海浪的节奏移动你的双手——当海浪袭来时把双手移向自己，在海浪退去时把双手移开。这么几次之后，你会发现自己很快与海浪联系在一起了。“当你达到与海浪的拍击合拍的境界时，”他说，“就会对如何才能成为一个交易商悟出很多道理。”要注意的是，为了能与海浪联系在一起，知道海浪何时停止涌动对你是很重要的。</p>
<p>有个人从澳大利亚来找我，他从计算机软件生意中赚了几百万美元，现在他想做些交易系统的研究。他已经在美国各地拜访了很多人，想通过他们了解交易的实质。我们在一起共进晚餐，他向我认真解释了他全部的交易思想。在听完他的交易思想后，我觉得这些想法都很好，但有点困惑。他的所有研究都与寻找入市的技巧有关，而对利用怎样的退出策略或者如何控制头寸规模没有任何研究。我向他建议，他需要花费至少和他花费在入市上一样多的时间来开发他的获利退出策略，并用同样多的时间（即使不是更多）在头寸规模确定上，他看上去很不高兴，因为他坚决认为选对股票是在市场上成功的全部奥秘。</p>
<p>人们似乎想忽视市场退出，也许因为他们在退出市场时就不能控制市场了。然而对那些想控制市场的人来说，退出市场确实控制着两个重要的可变因素—你是否会获得利润以及将获得多少利润，它们是开发一个成功的系统的关键因素之一。</p>
<h1 id="获利退出策略背后的目的"><a href="#获利退出策略背后的目的" class="headerlink" title="获利退出策略背后的目的"></a><span style="color:#339AFF;">获利退出策略背后的目的</span></h1><p>退出市场要解决一系列的问题。如果最坏的情形没有发生（你没有被截住），那么你的系统的主要任务就是让你实现的利润尽可能多，返还的尽可能少。只有退出策略能做到这一点。</p>
<p>注意我使用的是“退出策略”的复数形式，因为大多数系统需要几个退出策略来适当地完成以上任务。因此，对每一个系统目标，你要考虑采用不同的退出策略。在设计自己的系统时，要想到你将如何控制回报——风险比率以及如何采用本章所描述的各种获利退出市场策略以使你的利润最大。</p>
<p>除了初始止损之外，退出市场的策略有很多不同的分类，包括会带来损失但会降低初始风险的退出策略、使利润最大化的退出策略、防止利润返还市场太多的退出策略以及心理退出策略。这些分类存在某种程度的交叉。每一种退出策略都向你提供了可以考虑的几个技巧。在仔细阅读每一种退出策略时，不妨思考一下它如何能与你的系统相适应。大多数退出策略都令人难以置信地适合你的系统目标。</p>
<h2 id="会带来损失，但会降低初始风险的退出策略"><a href="#会带来损失，但会降低初始风险的退出策略" class="headerlink" title="会带来损失，但会降低初始风险的退出策略"></a><span style="color:#00ACC1;">会带来损失，但会降低初始风险的退出策略</span></h2><p>第10章讨论的初始止损指令是为最坏情形的损失设计的，它是为了保护你的资本。这种退出策略也会产生损失，但是它们是为了确保你的亏损尽可能少。</p>
<p><strong>（1）定时停价。</strong>一般来说，人们进入市场是因为他们期望在入市后不久价格就会发生对其有利的变化。因此，如果你获得了一个有意义的入市信号，那么一个潜在的有用的退出策略应该在无利可图的一段时间之后，让你退出市场。比如，这样一个退出策略可以是“如果这个头寸无利可图，那么在两天后收盘时就退出市场。”这样的退出策略会让你赔钱，但是，没有最坏情形的停价指令在被执行时赔得多。</p>
<p>定时停价的另一种情形是，当发现了一个极好的新的投资想法，而你的资金又全部投出去了的时候你能做什么呢？你已经没有钱再投资了。不过，如果你完全相信这是一次绝佳的投资机会，那么我建议你在资产组合中找出那个表现最差的股票，下定决心把它抛出去。你可以挑选赔钱的那只，也可以挑选没有按照你预期的速度增长的那只。</p>
<p><strong>（2）跟踪停价。</strong>跟踪停价是根据某种数学运算法则在周期性的基础上进行调整的停价。随机入市系统（在第9章描述的）使用一个3倍于波动幅度的跟踪停价，只有当它的移动有利于交易时才在每天的基础上自收盘之时进行调整。例如，在第一天的交易之后，如果价格的移动对你有利或者说波动幅度在收缩，那么跟踪停价就以对你有利的方式移动。它可能仍然是亏损的，但是正在以对你有利的方式移动。因此，如果市场的移动背离你足够远而将你截住，你仍然会承担损失，但是它不会大到你的初始停价。这种跟踪停价可以建立在许多因素的基础之上，包括波动幅度、一个移动平均、一次管道突破、各种价格盘整等，而每一种类型又由很多不同的变量控制着。见下一部分分析的一些具体的实例。</p>
<p>关于跟踪停价最重要的一点是，退出法则会不断做出调整以使退出的移动对你有利。这种移动也许是无利可图的，但是它将降低你潜在的亏损。</p>
<p>必须通过测试和检验结果来仔细考虑你是否想这样做。例如，通常在向上移动跟踪停价时，你降低了初始风险，只是放弃了获利的机会，但是，你可以只承担较小的亏损。在系统开发的这个环节一定要当心，如果你的系统确实利用窄小的停价，要意识到再入市策略是可以采用的。</p>
<h2 id="使利润最大化的退出策略"><a href="#使利润最大化的退出策略" class="headerlink" title="使利润最大化的退出策略"></a><span style="color:#00ACC1;">使利润最大化的退出策略</span></h2><p>为了使利润最大化（让它们滚动起来），你必须乐于把其中一部分返还回去。事实上，系统设计中具有讽刺意味的就是，如果你想让利润最大化，就必须愿意把已经积累起来的一大部分利润返还回去。就像一位精明和非常富有的交易商曾经说的，如果你不愿意赔钱，你就赚不到钱，它就像呼吸但是不愿意呼出一样。各种类型的退出策略就帮你做到了这一点（也就是充分呼吸），包括跟踪停价和百分比折回停价。</p>
<p><strong>（1）跟踪停价。</strong>跟踪停价有帮助你获得较大的利润的潜能，但是它也总是会将部分利润返还回去。下面看一下你有可能使用的一些跟踪停价的例子。</p>
<p>我在前面提到过，波动跟踪停价是市场每日波动的一个乘数。小威尔斯·怀尔德首次提出了这个概念。他认为波动跟踪停价应该是2.7-3.4之间的一个数乘以最近10天的平均真实波幅。我们在随机入市系统中使用3.0，波动停价的目的是将停价保持在市场噪声之外，每日波动的3倍当然可以胜任这一点。其他人则关注每周的波动。如果你使用每周波动，那么用0.7-2之间的某个数乘以每周的波动量或许也可以。</p>
<p>美元跟踪停价是又一个可以使用的指标。你可能决定使用某个数，比如1500美元，然后把跟踪停价维持在与昨天的收盘价相差这一数额的水平。美元停价如果有某些合理的基础是相当不错的。然而，在标准普尔合约、玉米合约、一只150美元的股票和一只10美元的股票上使用1500美元的停价简直是太离谱了。美元停价的数额要结合各个市场的不同做出合理的调整。确定每个市场多少金额是合理的其最好的办法是检查该市场的波动幅度。因此，你也可以使用一个基于波动幅度的停价策略。</p>
<p>管道突破跟踪停价也是很有用的。你也许决定在最近X天（由你自己确定这个天数）的极端价位退出市场。因此，如果做的是多头，你可能决定在市场价格跌破最近20天的最低价时卖出，而如果是空头，你会决定在价格涨破最近20天的最高价位时卖出。在价格以对你有利的方向变动时，这个数字也总是会做出对你有利的调整。</p>
<p>移动平均跟踪停价是又一个常见的跟踪停价。如果价格正朝着某个特定的方向移动，一个较慢的移动平均会跟在其后，这个移动平均就可以作为停价指令，但是你必须确定这个移动平均包含了多少时间段。例如，一个200天的移动平均可能让你在1982～2000年的长期牛市的大部分时间里在股市中频繁交易。</p>
<p>移动平均有很多不同的类型——简单的、指数型的、置换的、适应性的等——所有这些都可以用做跟踪停价。你的任务是找出一个或几个能最好地帮你实现目标的移动平均。各种类型的移动平均在本书第9章进行了深入的讨论。</p>
<p>还有其他一些基于盘整或图表模式的跟踪停价。例如，每次市场穿越一个盘整模式时，原来的盘整模式就可以成为新的停价的基础。这相当于一个任意的跟踪停价，它会把大量的利润返还市场。不过，如果与其他类型的退出策略相结合，它还是有一些优势的。</p>
<p><strong>（2）利润折回停价。</strong>这种停价策略假定，为了让利润增长，必须把其中一定百分比的利润返还回去。因此，它确定了一个允许折回的数值，并把它作为系统的一部分。但使用利润折回停价，前提是必须达到了一定水平的利润，比如2R。</p>
<p>下面是这种停价的运作。假定你以52美元的价格买进了100股Micron的股票。你最初假定1R的风险是6美元，也就是假定在股票跌到46美元时就抛出。一旦股票价格上涨到64美元，获得了一个2R的利润即12美元，你就决定开始实施利润折回停价。假如你决定采用一个30%的利润折回停价，你现在获得了12美元，就愿意放弃其30%，即3.6美元。</p>
<p>如果利润上升到了13美元，一个30%的折回现在就变成了3.9美元；在利润是14美元时，30%的折回就变成了4.2美元。因为按照一个固定的百分比计算得出的实际美元金额是随着利润的增长而增长的，所以你就需要随着利润变大而改变百分比。例如，你可以以30%的折回开始，在利润是3R时将其降为25%，在4R时降为20%。你可以继续将百分比降低，直到在7R时只允许5%的折回，或者一旦达到4R，你也可以让该百分比保持在20%的水平。这完全取决于你在设计自己的系统时的目标。</p>
<p><strong>（3）百分比折回停价。</strong>另外一个非常简单的停价是百分比折回停价。例如，你可以用一个25%的折回停价，即最初将退出策略设定为25%的价格下跌，每次股票价格（或任何你所买进的东西）创出了新高，你就以该价格25%的折同作为新的停价标准。当然，你总是提高停价标准，但是从不会降低它。</p>
<p>1999年斯蒂夫·斯格瑞德、成为牛津俱乐部的投资部主任，我被指定为他们的顾问小组成员。斯蒂夫读过本书的第1版，他立即在牛津俱乐部所有推荐的交易中指定一个25%的停价规则，运转良好。自1999年2月直到他们在2000年5月抛出所有的证券这一期间，斯蒂夫一直是投资部主任，我考察了他在任期间推荐的所有交易。在此期间他所推荐的交易的期望收益是2.5R，已经非常不错了，而且我相信其成功的主要原因是他们采用了25%的停价规则。其他的时事通讯曾试过50%的跟踪停价，但是这些都不起作用，因为它们返还太多的利润以及在出现巨额损失时，股票要经过很长时间才能回到盈亏平衡点。想一想，如果损失了49%，只是为了回到盈亏平衡点，你就必须再实现将近100%的利润。然而，如果只是损失了24%，为了回到盈亏平衡点，你只要实现33%少一点的利润即可。因此，我认为25%的跟踪停价对股票来说是原来“买进并持有”哲学的极佳的翻版。</p>
<h2 id="防止利润返还市场太多的退出策略"><a href="#防止利润返还市场太多的退出策略" class="headerlink" title="防止利润返还市场太多的退出策略"></a><span style="color:#00ACC1;">防止利润返还市场太多的退出策略</span></h2><p>如果你是在经营他人的钱财，那么让亏损最小远比赚取大额回报要重要得多，因此，你可能需要考虑防止利润返还太多的退出策略。例如，你在3月31日未结清的头寸上将客户3月份账单上的账户金额增加了15%，如果你将这笔利润的很大一部分又返还了市场，这个客户将会对此感到非常沮丧，他会认为这笔未结清的利润是他的钱。因此，一旦你达到了一个特定的目标或在向客户汇报了业绩之后，你需要某种退出策略来锁住大部分利润。</p>
<p>正如我在前面提到过的，很多退出策略的分类是互相交叉的。例如，百分比折回退出策略与利润目标退出策略（见下述）结合起来就是一个很好的防止返还太多利润的方法。不过，其他一些方法也不错。</p>
<p><strong>（1）利润目标。</strong>有些人使用预测利润目标的交易系统（比如艾略特波浪）。如果使用这样的系统，就可以设定一些具体的目标。</p>
<p>不过，我们还可以使用第二种方法来设定目标。如果你获得了初始风险某一具体倍数的利润，就可以基于历史的检验，确定你的方法产生了你所期望的回报一风险比率。例如，初始风险的4倍即4R是一个不错的目标，如果能够达到这个目标那么你就可能希望变现利润或者在这一水平执行一个紧密得多的停价指令。下面讨论的所有方法都可以在达到利润目标后以某种方法进行紧缩。</p>
<p><strong>（2）利润折回退出策略。</strong>前面提及的有关退出策略的一个极好的主意是，愿意把一定百分比的利润返回去，而且在某一重要的时刻（比如向客户做了汇报或达到了一个利润目标）之后紧缩这一百分比。例如，在获得了2R的利润后，为了让利润增长，你可能愿意把这一利润的30%返回。当获得了更大的利润，比如4R，在退出市场之前，你就可能只愿意返回其中的5%～10%。</p>
<p>比如，假定你以400美元的价格买进黄金，停价指令设定为390美元，因此，你的初始风险是10个点，或者说每笔合约1000美元。金价涨到了420美元，因此你获得了20个点的利润（2R），这可能会启动你只允许利润折回30%的退出策略，即每笔合约600美元。如果金价降到414美元，你就会实现利润。</p>
<p>金价继续上涨，达到440美元，结果你现在拥有了4R的利润，即4000美元。直到达到4R的利润之前，你都愿意放弃利润的30%，即当利润是4000美元时，愿意放弃1200美元。然而，现在4R的利润水平是你只愿意承担利润的10%的风险信号。你的停价现在就变为436美元了，即你只允许每笔合约的利润下跌400美元多一点。</p>
<p>我的意图不是向你建议一个具体的水平（比如在4R时10%的折回），而只是向你建议一个可以实现目标的方法。确定什么水平能够帮助你最好地实现目标由你自已来决定。</p>
<p><strong>（3）不利于你的大幅度波动。</strong>你可以使用的最佳退出策略之一是市场出现了不利于你的大幅度波动。实际上，这种波动也是一个非常好的入市信号——就是大家所熟知的波动幅度突破系统。</p>
<p>你所要做的就是跟踪平均真实波幅。当市场出现了不利于你的反常的大幅度波动时（比如每日平均波动幅度的2倍），你就退出市场。假如你有200股IBM的股票，交易价格是145美元，其每日平均波动幅度是1.50美元，你决定当市场在一天之内出现了不利于你的波动达到每日平均波幅的2倍时就退出市场。也就是说，市场收盘价是145美元，每日波幅的2倍是3美元，如果第二天市场价格跌到142美元，你就退出市场。这可能是对你不利的巨大的市场波动，如果这种波动发生了，你就不想滞留在市场中。</p>
<p>这不能是你唯一的退出策略，其原因应该是很明显的。假设你继续使用这一2倍于波动幅度的停价，今天市场价是145美元，你的波动幅度退出点是142美元。如果市场收盘时跌了一个点，到了144美元，那么现在你新的波动幅度退出点就是141美元了。第二天，市场又降了一个点以143美元收盘，现在新的波动幅度退出点则是140美元。这可以继续下去直到价格降到零。因此，你需要一些其他的退出策略，比如保护性停价和某种跟踪停价以使你退出市场保护资本。</p>
<p><strong>（4）抛物线停价。</strong>抛物线退出策略最早是由小威尔斯·怀尔德提出来的，它们也是非常有用的。抛物线从原来的最低点开始，在呈上升趋势的市场中有一个加速因子。随着市场趋势的延伸，抛物线退出点越来越接近价格，因此它在锁定利润方面效果非常好。遗憾的是，在交易之初，它与实际价格相去甚远，而且，抛物线停价有时会有点过于接近价格，在市场继续沿着趋势延伸下去时，你会被截住。</p>
<p>有几种办法可以解决这些缺陷。一种办法是根据市场的真实价格调整抛物线停价的加速因子，使其增快或减慢。通过这种方法，抛物线停价可以很好地适应你的特定的系统和所交易的市场。</p>
<p>为了在交易之初更好地控制风险，可以设定一个分立的美元停价策略。例如，如果在买进头寸时，抛物线停价策略提供的是3000美元的风险，你就可以简单地设定一个1500美元的停价标准，直到抛物线停价标准接近距离实际合约价格1500美元为止：一个3000美元的风险可能对你特定的目标来说太大了。</p>
<p>此外，如果你正在使用抛物线退出策略，应该考虑设计一个再入市技巧。如果抛物线停价过于接近实际价格，你可能就会在你正在跟踪的某个趋势结束之前被截住。因为你不想错过余下的趋势中的机会，所以你需要回到交易中。尽管抛物线停价在风险控制方面可能不如其他的入市技巧优越，但它在保护利润方面还是不错的。</p>
<h2 id="心理退出策略"><a href="#心理退出策略" class="headerlink" title="心理退出策略"></a><span style="color:#00ACC1;">心理退出策略</span></h2><p>任何人都可以使用的最明智的退出策略之一就是心理退出策略，这一策略更多地依赖于你本身而不是市场的表现。既然你是交易中最为重要的因素，因此心理退出策略就是很重要的。</p>
<p>有些时候你在市场中赔钱的概率会大大增加——不论市场表现如何。包括你由于健康状况或者精神方面出现问题而感觉不舒服的时候、在承受的压力很大时、在你正经历离婚时、在你刚刚生了一个小孩时、当你正在搬家时，等等。在这些状态期间，可能会因为做了什么而导致你在市场中赔钱的概率大大增加。因此，我强烈建议你使用心理退出策略将自己拉出市场。</p>
<p>另外一个使用心理退出策略的好时机是你因为生意或度假而不能在市场中交易的时候，这些时候也不宜留在市场中。我建议你在此期间实施心理退出策略。</p>
<p>有些人会争论说一次交易可能赚到一整年的利润，而你不想错过这次交易。如果你在交易中是非常自律且相当自动化的，我同意这个交易哲学，但大多数人不是这样。在我上面提到的任何一种情形下，一般人都会赔钱，即使他们是处于一笔很好的交易中。因此，了解你自己至关重要。如果是一笔不错的交易，你都有可能泄气，那么就必须采取心理退出策略了。</p>
<h1 id="使用停价和利润目标"><a href="#使用停价和利润目标" class="headerlink" title="使用停价和利润目标"></a><span style="color:#339AFF;">使用停价和利润目标</span></h1><p>设计一个交易系统的目标之一，可能就是使获得较高的R乘数交易的概率最大。例如，你可能为了获得一个20R的交易而决定使用窄小的停价，为了实现目标，你可能决定使用第10章描述的突破一折回策略来开发一个窄小的停价。假如你对一只高价股票的停价标准只有1美元，那么100股股票只会损失100美元。这将是一个非常窄小的止损，比如，对于正在经历剧烈突破的100美元的股票而言就是一个非常窄小的停价。你可能会连续5次被截住，每次只有100美元的亏损，全部亏损就是500美元。优先股一次20美元的移动会带来2000美元的利润，或者说1500的净利润。在六次中你只有一次是正确的，但是却可以获得扣除佣金后1500美元的净利润。</p>
<p>为了使这个策略发挥应有的作用，必须避免使用跟踪停价策略或者这些停价必须非常宽。你仅有的退出策略是1R的初始停价和利润目标，这将为你带来最大的获取20R利润的机会。你也许不得不忍受利润下降1000美元或更多，但是永远不会多于初始资本的1R或100美元。记住，你的目标是一个20R的利润，这也许是可以经常实现的。</p>
<h1 id="简单和多元退出策略"><a href="#简单和多元退出策略" class="headerlink" title="简单和多元退出策略"></a><span style="color:#339AFF;">简单和多元退出策略</span></h1><p>简单的概念在系统设计中最起作用。简单有用是因为它一般都是建立在理解而非优化的基础之上的。它起作用是因为我们可以将简单的理念推广应用到许多市场和交易工具中去。</p>
<p>然而，你依然可以使用多元的退出策略并将其简单化。不要混淆这两个概念。简单是必需的，只有这样你的系统才会发挥作用，而多元退出策略通常是实现目标所必需的。当然、多元退出策略中的每一个都可以是简单的。</p>
<p>让我们来看一个例子。假如你的目标是使用一个趋势跟踪系统，你希望在市场中停留很长时间。你认为入市信号没有什么神奇的，因此想为头寸留出大量的空间。你认为一次不利的大的市场移动可能会导致潜在的灾难，因此在其发生时你希望退出市场。最后，你决定，既然初始风险会比较宽，一旦获得一次4K的利润，你就必须尽可能多地去获取。</p>
<p>因此，让我们基于以上想法来设计一些简单的退出策略。从这个例子中你要注意到，认识自己的想法是什么，然后再设计一个适合该想法的系统很重要。这是开发一个适合你的系统的秘诀的一部分。</p>
<p>首先，你想要一个较宽的初始停价标准，给头寸留有较大的余地，从而在退出市场时不会遭到双赔，也不会导致你必须几次进入市场而承担交易成本。因此，你决定采用前面提及的3倍于波动幅度的停价标准。这将是你最坏情形的停价标准，也将是你的跟踪停价标准，因为你每天要从收盘时起对它进行跟踪—总是希望它朝着对你有利的方向移动。</p>
<p>其次，你认为一次不利的强劲的波动是一个很好的预警信号。因此，你决定，无论什么时候，只要市场自前一天收盘时起在短短一天之内发生了不利于你的2倍于每日波动幅度的波动，你就退出市场。这个停价标准优于其他的停价。</p>
<p>最后，一个4K的利润会启动一个窄小得多的停价，因此你不会返还很多利润，而且也可以确定实现已经到手的利润。因此，在一个4R的利润实现后，你的跟踪波动幅度停价就上移为平均真实波幅的1.6倍（也就是说，不再是3倍），这就是你现在唯一的退出策略。</p>
<p>注意，所有这些停价都很简单，它们都源于对什么样的停价策略能够实现目标的思考。因为没有经过测试，所以它们不会过度优化；因为没有什么高深的科学，所以它们都很简单。现在有三个不同的退出策略可以帮助你实现交易系统目标，但是在市场中一次只能使用其中的一个——最接近目前市场价格的那一个。</p>
<h1 id="要避免的方面"><a href="#要避免的方面" class="headerlink" title="要避免的方面"></a><span style="color:#339AFF;">要避免的方面</span></h1><p>还有一种退出策略旨在摆脱亏损，但是却与前面所说的“截住损失，滚动利润”的黄金交易法则完全相悖，结果，这种退出策略产生的是巨额损失和较少的利润。这种退出策略的做法是，先进入市场建立较大的头寸规模，然后利用各种退出策略逐渐清仓。例如，你可能以买进300股股票开始，在全部300股股票能盈亏持平时抛出其中的100股，然后又为赚取500美元的利润抛出另外100股，留下最后100股以获取巨额利润。短期交易商非常频繁地使用这种策略。</p>
<p>从直觉上看，这种交易很有意义，因为你好像是在给自己的利润“上保险”，但是对这种退出策略退一步思考，认真研究，你就会发现它是很危险的。</p>
<p>利用这种退出策略，实际上是在实践交易的黄金法则的对立面。你要确保在承担最大的损失时会有很多头寸。在这一侧子中，你可能会在300股上都出现亏损。你还要确保在实现最大的利润时，只有最小规模的头寸——在这个例子中是100股。对于那些有强烈的追求正确的倾向的人来说，这是一个再好不过的方法，但是它不会优化你的利润，甚至不能确保你的利润。现在你还觉得它合理吗？</p>
<p>如果你对为什么要避免使用这类交易还不明白，那么就请你把这个数字计算出来。设想你要么遭受完全的损失，要么充分实现利润。考察过去的交易，并确定这种交易将会产生多大的差异。在我每次要求客户这样做的时候，他们几乎都会对持有一个完整的头寸最终可能赚到多少钱惊诧不已。</p>
<h1 id="常见系统采用的退出策略"><a href="#常见系统采用的退出策略" class="headerlink" title="常见系统采用的退出策略"></a><span style="color:#339AFF;">常见系统采用的退出策略</span></h1><h2 id="股市系统"><a href="#股市系统" class="headerlink" title="股市系统"></a><span style="color:#00ACC1;">股市系统</span></h2><p><strong>（1）威廉·欧奈尔的CAN SLIM系统。</strong>威廉·欧奈尔基本的利润获取法则就是，每当获得利润时，实现其中的20%。因为他的止损标准大约是8%，也就是说相当于2.5R的利润，所以他的基本获利退出策略就是一个目标。</p>
<p>不过，欧奈尔又利用36条其他的抛售法则来调节其利润获取法则，其中有一些是基本抛售法则的例外，而其他的则是说明为什么要早一点抛售的原因。另外，他还增加了8条关于何时应该持有股票的法则。我的意图只是解释各种系统是如何适应本章所勾勒的框架的，而不是介绍这一系统的细节，所以我建议想了解该系统细节的读者去读一读欧奈尔写的那本精彩的书。</p>
<p><strong>（2）沃伦·巴菲特的公司方法。</strong>沃伦·巴菲特一般不抛售其投资的原因有三个。</p>
<p>第一，在抛售时，必须支付资本收益税。因此，如果确定该公司在你所投资的金额上会有很好的回报，你为什么要卖呢?抛售只会自动地把一些利润转交给美国政府。</p>
<p>第二，如果一家公司基本上是安全的而且可以带来不错的利润，为什么要卖它呢?如果一家公司将其资本进行投资的方式可以获得不错的回报，那么你所投进去的钱也会获得不错的回报。</p>
<p>第三，如果真的卖出，还会承担交易成本。因此，如果市场只是在经历心理的起伏，那么为什么要卖掉一个很好的投资呢？</p>
<p>不过，在我看来，巴菲特不卖出其投资与其说是一个事实，不如说是一个神话。这一神话的产生也许是由于巴菲特本人从未写过有关自己的投资策略这一事实造成的。结果，其他存在强调人市的典型倾向的人就试图破解巴菲特交易策略的秘密。</p>
<p>如果巴菲特持有的股票的商业形势发生了剧烈的变化，那么他就不得不抛售。让我举一个例子。1998年年初，巴菲特曾经宣称他拥有世界白银供给的20%左右。白银是不派发红利的，因此，如果你持有和巴菲特一样多的白银，实际上要为储存和保护这些白银付出成本。对这批白银，巴菲特如果没有计划好一个退出策略，那么在我看来，他就会在其投资生涯中犯下最大的错误之一。反过来说，如果他的确有一个计划好的退出策略的话，那么我猜想对于所购买的大多数股票，他都有计划好的退出策略。其他人在写巴菲特时，只是反映他们自己的倾向，只是关注巴菲特的入市和方案策略，而忽视了他的退出策略。</p>
<h2 id="期货市场系统"><a href="#期货市场系统" class="headerlink" title="期货市场系统"></a><span style="color:#00ACC1;">期货市场系统</span></h2><p><strong>（1）考夫曼的适应性方法。</strong>考夫曼警告说，他的基本趋势跟踪系统不应该与一个完整的策略相混淆。他只是将它作为一种方法提出来，在入市或退出的选择中没有任何奥妙之处。</p>
<p>适应性移动平均在第9章里是作为一个基本的入市技巧介绍的。在移动平均以超过预先设定的过滤量的速度增长时，就以多头入市；在其以超过预先设定的过滤量的速度下降时，就以空头入市。</p>
<p>考夫曼评论说，每当效率超过某一预定的水平时，就应该实现利润。例如，他说一个很高的效率比值是不可持续的，一旦达到较高的比值，它就会快速下降。因此，考夫曼有两个基本的退出信号：①当适应性移动平均在相反的方向上出现变化时（也许是当它在相反的方向超过某一个门槛值时）；②当平均效率达到一个非常高的值，比如0.8时。</p>
<p>我认为适应性退出策略要比其他任何形式的退出策略更有潜力。我的一些客户就开发了随市场上升的退出策略，在它移动时给头寸留有很大的余地。然而，一旦市场开始转向，这些退出策略就可以让你退出市场。它们令人难以置信地富有创造力但又很简单。在市场恢复趋势时，其基本趋势跟踪系统又会让他们马上返回市场。我强烈建议你在系统开发的这一领域花费大量的时间。</p>
<p><strong>（2）加拉赫的基本面交易。</strong>加拉赫的系统是让你在以下情况下进入市场：在基本面条件具备时以及当市场出现一个10天的新高时（一个10天的管道突破）。他使用的系统一般是一个反转系统，因此，该系统总是在市场中。基本上是在10天的最低价被打破（一个10天的管道突破）时清仓。但是，加拉赫并没把它作为一个反转系统使用。</p>
<p>记住，加拉赫只按照市场中基本面关系的方向建立头寸。因此，除非市场的基本面关系发生了剧烈的变化，否则他只会在一个10天的最低价出现时退出一个多头（不会反转它），同时只会在一个10天的最高价出现时退出一个空头（不会反转它）。这是一个非常简单的退出策略，不会造成很多麻烦。但是，我的揣测是，该系统可以利用更成熟的退出策略而大大改进。</p>
<p><strong>（3）肯·罗伯茨的1-2-3方法。</strong>肯·罗伯茨的利润实现方法，在我看来是非常主观的，它相当于一个盘整跟踪停价方法。如果罗伯茨的方法是正确的，而且市场进入了长期的移动，那么他只是建议你提高停价，新的盘整点一经形成就会将你的停价置于它之下（或之上）。</p>
<p>这是在20世纪70年代一个非常有效的传统的趋势跟踪方法。其主要缺点是可能返还大量的利润。它现在依然有效，但是这一方法如果与本章所讨论的很多退出策略结合起来运用也许会更有效，其中我特别推荐多元退出策略。</p>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a><span style="color:#339AFF;">小结</span></h1><p>人们总是回避寻找好的退出策略，因为退出不能让他们控制市场，但退出策略确实控制着某些方面。它控制着你是获利还是亏损，还控制着这一利润或损失将会有多大。既然它有那么大的影响力，因此，值得我们为此做出比大多数人所做的更多的研究。</p>
<p>我们回顾了四大类退出策略-会降低初始风险的退出策略、使利润最大化的退出策略、使返还的利润最小的退出策略以及心理退出策略。每一大类都给出了各种具体的退出策略，它们之间存在很大程度的交叉。</p>
<p>读者对简单的多元退出策略加以考虑是最好的。简单的退出策略容易概念化，而且无须大量的优化，即使需要一些）。我之所以推荐多元退出策略，是因为它有助于你最为充分地实现你的交易系统所设定的目标。</p>
<p>我们考察了如何设置一个期望收益很高的系统，使该系统自身就能够产生好的利润回报。第13章将讨论机会因素如何与期望收益相互作用。</p>
<!-- flag of hidden posts -->
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/通向财务自由之路/" rel="tag"># 通向财务自由之路</a>
          
        </div>
      

      
      
      

      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="CheBin">
            
              <p class="site-author-name" itemprop="name">CheBin</p>
              <div class="site-description motion-element" itemprop="description">绝知此事要躬行，不动手就是懒。一篇文章看10遍，而不是10篇文章看1遍。</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">455</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">16</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">47</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          

          
          


          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <!-- modify icon to fire by szw -->
                <i class="fa fa-history fa-" aria-hidden="true"></i>
                近期文章
              </div>
              <ul class="links-of-blogroll-list">
                
                
                  <li>
                    <a href="/2022/07/25/10人以下小团队管理手册/" title="10人以下小团队管理手册" target="_blank">10人以下小团队管理手册</a>
                  </li>
                
                  <li>
                    <a href="/2022/07/19/InnoDB数据页结构/" title="InnoDB数据页结构" target="_blank">InnoDB数据页结构</a>
                  </li>
                
                  <li>
                    <a href="/2022/07/09/Explain详解（上）/" title="Explain详解（上）" target="_blank">Explain详解（上）</a>
                  </li>
                
                  <li>
                    <a href="/2022/07/09/Explain详解（下）/" title="Explain详解（下）" target="_blank">Explain详解（下）</a>
                  </li>
                
                  <li>
                    <a href="/2022/07/07/事务简介/" title="事务简介" target="_blank">事务简介</a>
                  </li>
                
              </ul>
            </div>
        

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#获利退出策略背后的目的"><span class="nav-number">1.</span> <span class="nav-text">获利退出策略背后的目的</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#会带来损失，但会降低初始风险的退出策略"><span class="nav-number">1.1.</span> <span class="nav-text">会带来损失，但会降低初始风险的退出策略</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使利润最大化的退出策略"><span class="nav-number">1.2.</span> <span class="nav-text">使利润最大化的退出策略</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#防止利润返还市场太多的退出策略"><span class="nav-number">1.3.</span> <span class="nav-text">防止利润返还市场太多的退出策略</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#心理退出策略"><span class="nav-number">1.4.</span> <span class="nav-text">心理退出策略</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#使用停价和利润目标"><span class="nav-number">2.</span> <span class="nav-text">使用停价和利润目标</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#简单和多元退出策略"><span class="nav-number">3.</span> <span class="nav-text">简单和多元退出策略</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#要避免的方面"><span class="nav-number">4.</span> <span class="nav-text">要避免的方面</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#常见系统采用的退出策略"><span class="nav-number">5.</span> <span class="nav-text">常见系统采用的退出策略</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#股市系统"><span class="nav-number">5.1.</span> <span class="nav-text">股市系统</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#期货市场系统"><span class="nav-number">5.2.</span> <span class="nav-text">期货市场系统</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#小结"><span class="nav-number">6.</span> <span class="nav-text">小结</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2022</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CheBin</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">站点总字数：</span>
    
    <span title="站点总字数">4.5m</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    
    <span title="站点阅读时长">67:49</span>
  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a></div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.1"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.1"></script>



  
  <script src="/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  

  

  


  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  

  
  

  


  

  

  

  

  

  

  

  

  
<script>
  $('.highlight').each(function(i, e) {
    var $wrap = $('<div>').addClass('highlight-wrap');
    $(e).after($wrap);
    $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function(e) {
      var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
        return $(e).text();
      }).toArray().join('\n');
      var ta = document.createElement('textarea');
      var yPosition = window.pageYOffset || document.documentElement.scrollTop;
      ta.style.top = yPosition + 'px'; // Prevent page scroll
      ta.style.position = 'absolute';
      ta.style.opacity = '0';
      ta.readOnly = true;
      ta.value = code;
      document.body.appendChild(ta);
      ta.select();
      ta.setSelectionRange(0, code.length);
      ta.readOnly = false;
      var result = document.execCommand('copy');
      
        if (result) $(this).text('复制成功');
        else $(this).text('复制失败');
      
      ta.blur(); // For iOS
      $(this).blur();
    })).on('mouseleave', function(e) {
      var $b = $(this).find('.copy-btn');
      setTimeout(function() {
        $b.text('复制');
      }, 300);
    }).append(e);
  })
</script>


  

  

</body>
</html>
