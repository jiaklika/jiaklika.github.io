<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2">





















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">
<meta name="keywords" content="通向财务自由之路">
<meta property="og:type" content="article">
<meta property="og:title" content="第4章 系统开发的步骤">
<meta property="og:url" content="http://yoursite.com/2021/07/26/第4章-系统开发的步骤/index.html">
<meta property="og:site_name" content="车斌的技术博客">
<meta property="og:description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2021-11-05T07:43:56.571Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第4章 系统开发的步骤">
<meta name="twitter:description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">






  <link rel="canonical" href="http://yoursite.com/2021/07/26/第4章-系统开发的步骤/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>第4章 系统开发的步骤 | 车斌的技术博客</title><meta name="robots" content="noindex">
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">车斌的技术博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">放弃会成为一种习惯</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/07/26/第4章-系统开发的步骤/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CheBin">
      <meta itemprop="description" content="看视频才能学会，看文字学不会的">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="车斌的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">第4章 系统开发的步骤

              
            
          </h1>
        

        <div class="post-meta">

          

          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2021-07-26 19:29:38" itemprop="dateCreated datePublished" datetime="2021-07-26T19:29:38+08:00">2021-07-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2021-11-05 15:43:56" itemprop="dateModified" datetime="2021-11-05T15:43:56+08:00">2021-11-05</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/期货/" itemprop="url" rel="index"><span itemprop="name">期货</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">15k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">14 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>思考并回答以下问题：</p>
<ul>
<li>总结一下，这章作者最主要想表达什么观点？</li>
</ul>
<a id="more"></a>
<p>肯定会有一张数据图或一种数据模型向我们展示可以达到的目标以及通往目标的最佳路线。——大卫·福斯特博士</p>
<p>如果有几个人能把某件事情做得很好，那么这种技能就可以被模仿或者模拟，并传授给其他人，相信这一点非常有用。这就是神经语言程序（NLP），或叫做模拟科学研究。为了开发一个好的模型，需要找到能完成你要模拟的事情的几个人，然后去采访这些人，以找出他们行为的共性，这些都是进行模拟的关键工作。找出他们行为的共性非常重要，如果没有找到共性，则只会发现其各自的特性，而特性通常都不那么重要。</p>
<p>在过去的25年里，我以教练的身份，与成百上千位杰出的交易商和投资者一起工作。期间，我有机会向这些专家学习怎样从事交易研究，步骤非常清楚也很容易做到。本章是我通过这些接触所开发的模型的提要，另外，自本书第1次出版以来我还对模型进行了改进。</p>
<h1 id="列出清单"><a href="#列出清单" class="headerlink" title="列出清单"></a><span style="color:#339AFF;">列出清单</span></h1><p>第一个关键步骤是进行一下盘点，列出自己的优势和劣势。为了获得成功，必须开发出一个适合你的系统。要做到这点，就必须对自己做一次认真的盘点——清点你的技能、性情、时间、资源、优势以及劣势。如果没有这样的盘点，你就不太可能开发出一个适合自己的系统来。</p>
<p>你需要考虑的问题有：</p>
<ul>
<li>你是否有过硬的计算机技能？如果没有，你是否有资源去雇用有这些技能或者能够帮你成为计算机专家的人？</li>
<li>你有多少资本？其中有多少是风险资本？你必须要有足够的资金供你开发的系统进行交易和投资。缺少充裕的资金是很多交易商和投资者所面临的主要问题，如果没有充裕的资金，就不能适当地确定头寸规模，这是大多数人忽视的一个成功系统的基本要素。</li>
<li>你对亏损的承受能力如何？</li>
<li>你的数学功底如何？你对统计学和概率的理解水平如何？</li>
</ul>
<p>还有很多重要的问题应该仔细考虑。比如，你要想一想有没有时间限制，如果你有一份全职工作，可以考虑使用一个长期的系统，这种系统只需要每晚花半个小时看一下收盘数据就行，而止损指令会在第二天送到你的经纪人手中。使用这样一种系统交易不需要占用太多时间，因此如果你没有很多时间，使用这种系统就比较合适。事实上，很多整天扑在市场上的专业人员也仍然依赖只需使用收盘数据的长期系统。</p>
<p>看另外一个应该考虑的问题。你进入市场用的是自己的钱还是别人的钱？如果是为别人交易，就必须克服其心理状态对你的交易的影响，这种影响可能会是相当大的。比如，你在整天面对一些发牢骚的客户的情况下，你的交易会是什么样子？</p>
<p>假设你是一个资金管理者，在两个月的亏损之后，客户撤走了资金。之后你有了三个月的盈利，这个客户又决定把钱投到你这儿；在你又亏损了两个月之后，她再次撤资；她决定一直等到你在市场上变得真正很热门的时候再来，接着在你五个月的盈利之后，她又把钱放了进来，之后你又有了两个月的亏损。最终的结果是这个客户连续不断地亏损，而你作为资金管理者却赚了一大笔钱，但她所经历的损失同样会对你以及你的交易产生影响，尤其是当她抱怨时。</p>
<p>我建议你对自己的个人心理进行一次彻底的清点。你需要花大量的时间思考一下在第3章“自我评价”部分提出的有关经营客户资金的问题并想想自己的答案。你是很快给出答案，还是对你相信的和感觉到的做一次精确的评估？另外，你是否会在将答案写在纸上之前，对每一个回答都进行深入的思考？把你的答案与汤姆.巴索的答案对比一下，你就可以将自己与一个顶级资金管理专家进行对比了。</p>
<p>除第3章的问题之外，作为自我评价的一部分，请你问自己一个非常重要的问题：我是谁？对这个问题的回答是所有其他问题的基础，因此你要认真思考一下。</p>
<p>我曾在一个大的交易公司工作，2006年年初，公司总裁取消了他与我每月一次的交流。他说他正在改变所做的工作，需要整理一些重要的事情。看完他的电子邮件，我一下子就明白他是在重申这一问题：我是谁。具体到他的情况，他曾是公司的CEO，交易集团的一把手以及集团最优秀的交易员之一。他思考的结果最终导致他解散了集团，以便集中更多的精力在他自己的交易上，因为他的自我评价帮助他做出决定，即第二的角色不适合他。</p>
<p>为了正确地回答“我是谁”这个问题，我强烈建议你写下对自己的所有看法，坐下来，拿出几张纸，着手写出关于你自己的所有评价。你是谁？你相信什么？ 当你写出大约100个看法时，你就会有一个很好的想法。下面是我的一位客户写下的几点认识：</p>
<ul>
<li>我是一个职业交易员，每天有几个小时确保我成为我能做到的最好的交易员；</li>
<li>在以后的12个月里，我完全可以承诺成为全职的交易员；</li>
<li>我对自己的账户做短期交易，对退休金账户做非常长期的交易；</li>
<li>我相信在短期交易账户上，能实现50%甚至更多的盈利，而对退休金账户，我只想努力胜过市场。</li>
</ul>
<p>这些只是他自己写下的几点认识，但是希望你能举一反 。现在该写你对自己的认识了。</p>
<h1 id="培养开放的观念，收集市场信息"><a href="#培养开放的观念，收集市场信息" class="headerlink" title="培养开放的观念，收集市场信息"></a><span style="color:#339AFF;">培养开放的观念，收集市场信息</span></h1><p>开发一个适合你的盈利系统是我们举办为期3天的研讨会的目的之一，并且我们还有前一次研讨会有关这一专题的系列录音资料。大多数人从这次研讨会或是录音资料中学到了很多东西，但是只有首先处理好自己的一些心理问题，才能学到足够多的东西。比如，有些人好像对我们努力传授的东西充耳不闻，他们对想要的东西有自己的想法，不仅不接纳可以改善其方法的一般模型，还对应如何改变的具体建议持排斥态度。有趣的是，那些对我们所提出的方法最为排斥的人通常是最需要这些方法的人。</p>
<p>因此，系统开发模型第二步的第一部分就是培养一种完全开放的观念。下面是有关如何培养开放观念的一些建议。</p>
<p>你要理解别人教给你的几乎所有的东西都是由一些观点形成的，包括你在这本书中读到的每一句话。地球是平的是一种观点，地球是圆的同样是一种观点。你可能会说：不，第二句话陈述的是一个事实。可能是事实，但它也是一种观点，每一个词都有很多重要的意义。例如，圆是什么意思或者地球是什么意思？</p>
<p>任何看上去是事实的东西仍然是相对的，它依赖于所处情形的语义，也依赖于你对所处情形所做的一些假定和看法，所有这些也都是观点。如果你把事实看做自己归纳的一些有用的观点，你的思维就会少些僵化，而变得更加灵活与开放。</p>
<p>记住下面的话：你不是在市场中交易或投资，而是根据你对市场的看法进行交易或投资。</p>
<p>我们所知道的事实仅仅是由一些观点构成的，一旦你改变了观点，事实也将改变。当然，我刚才说的这句话也是一种观点。然而，如果你接受这一观点的话，你就会承认自己其实并不知道到底什么是真的。事实上，你只有有关你赖以生存的这个世界的模型而已，因此，你就可以从效用方面来评价每一条新的观点。如果有些事情与你的知识或信仰相冲突，你可以想一想：这是否有可能是一个更有用的观点呢？你会惊讶于突然间对新观点和新东西变得这么开放。我最喜欢爱因斯坦的一句话：“事物的本质我们永远不会知道，永远不会。”</p>
<p>因此，拥有一个开放的观念的必要条件之一就是你要确定自己对市场的观点。如果你不够开放，它们看起来就不像是“观点”，而只像是“是什么”。用你的错觉进行交易，这正是每个人都在做的事，在你没有意识到的时候特别危险。你可能正在彻底地被自己的观点所欺骗。</p>
<p>查尔斯·勒博是一个有40年交易经验的老手。他说在他刚开始为计算机设计交易系统时，对市场有成百上千条观点，而其中大多数在精准的计算机测试中都站不住脚。</p>
<p>如果你的观念是开放的，就可以开始阅读一些有关市场的书。我极力向大家推荐杰克·施瓦格写的几乎每一本书，可以从《市场奇才》和《股市奇才：美国股市精英访谈实录》两本书开始，它们是现有的有关交易和投资的最好的书中的两本。他的另外两本书《基本面分析》 和《技术分析》也很棒。</p>
<p>由查尔斯·勒博和大卫·卢卡斯合写的《期货市场的计算机分析》是现有的有关交易系统开发过程最好的书之一。我从这本书以及与查克举办的定期研讨班中学到了很多东西。我还想推荐一下佩里.考夫曼的《精明交易者》，辛西娅·凯思的《利用概率做交易）以及威廉·欧奈尔的《笑傲股市》。此外，图莎尔·钱德的《超越技术分析》也非常好，因为它可以引领读者思考这些书没有涉及的概念。</p>
<p>以上推荐的读物可以提供给你发展有关市场的有用的观点所需的背景知识，这此背景知识对你要进入的游戏会有所帮助，它们可以回答许多可能正在闲扰你的有关交易的紧迫问题。</p>
<p>读完这些书之后，写下你对市场的看法。本书的每一句话都代表了我一条或更多的看法。你可能想找到那些你所认同的与市场有关的观点，这为你找到有关市场的观点提供了良好的开端，它将为你进行市场探索和系统开发所必须完成的任务做好准备。你将完成的对市场的研究以及你的研究将会产生的一系列观点（你应该至少写出其中100条）很可能会成为适合你的交易系统的基础。最起码，这一系列观点会成为很好的起点。阅读本书所描述的每一交易系统的每一部分，一定要对每一部分都列出你的观点。</p>
<p>阅读本书时，记下赞同的和不赞同的。没有对和错，只是一些你对它们持有的观点、认识的意义和你所花费的精力。做这种练习可以告诉你很多关于观点的东西，例如，我把这本书的书稿给了10位交易员，让他们给出评价，我收到的反馈反映了他们各自的观点。下面是其中一些例子：</p>
<ul>
<li>我认为头寸规模确定是你的系统的一部分，而不是一个独立的系统。</li>
<li>指标不是数据图的歪曲，而是其衍生物。</li>
<li>期望收益部分有很多瑕疵，这是由于像曲线拟合、数据挖掘等判断捷径和长期数据存在的问题造成的</li>
<li>我认为灾害性事件除了有可能增加或减少市场的流动性和/或市场价值外，本身是不可预测的，因此，设计适应市场流动性变化的系统才是关键。</li>
<li>一笔坏的交易并非输了的交易，而是没有满足我的入市标准而我又做了的交易。</li>
<li>我认为可靠度（赢的比率）和你的入市没有关系，恰恰相反，它和你的市场退出有关。</li>
<li>如果你说我们正处于一个长期的熊市，就会给读者造成心理倾向，你没有一个水晶球（意思是你没有一个预言未来的方法）。</li>
<li>你说市场在85%的时间里微横向移动，我认为这一估计有点偏高——或许在50%～75%的时间里是这样。</li>
</ul>
<p>持有以上观点的每一个人都希望我对本书做些修改以反映他们的观点，然而，我还是选择保留自己的观点，但要提醒你，你的观点可能会和我的相冲突。你一定要确保你的观点对你是有用的，真正重要的是你要认识到自己的观点，因为你只能利用一个适合你的观点的系统进行交易。</p>
<h1 id="确定任务和目标"><a href="#确定任务和目标" class="headerlink" title="确定任务和目标"></a><span style="color:#339AFF;">确定任务和目标</span></h1><p>除非你完全明白自己想在市场上实现什么目标，否则就无法开发出一个能让你在市场上赚到钱的成功的系统。认真思考你的目标，并清晰地整理出来，是你开发一个系统的首要任务。事实上，它在你的系统设计中应该占20%～50%的时间。不幸的是，大多数人完全忽视了这一工作，或者只花几分钟时间。你是否给予目标足够的重视？可以回忆一下你在做第3章的练习时花了多少时间。</p>
<p>请认真阅读和思考第3章，它包括了要求你回答得非常详细的问题。如果你只花了15～30分钟来回答我问汤姆·巴索的同样的问题，这是不够的。确立目标是很多人想问避的任务之一，但是如果你想开发一个非常好的交易或投资系统，那么就必须对此给予足够的重视。保持开放的观念非常重要，为你的目标做充分的工作是观念开放的一部分。</p>
<h1 id="确定交易观念"><a href="#确定交易观念" class="headerlink" title="确定交易观念"></a><span style="color:#339AFF;">确定交易观念</span></h1><p>根据我作为一个交易教练的经验，只是某些观念有用。你下一步就是要熟悉各种有用的观念，并决定你希望专注于哪一个。我用了整整一章来解释这些观念，现在我再简要地概括一下。</p>
<h2 id="趋势跟踪"><a href="#趋势跟踪" class="headerlink" title="趋势跟踪"></a><span style="color:#00ACC1;">趋势跟踪</span></h2><p>这一观念认为市场在某一时期往往是有趋势的（也就是说在相当长的一段时间里，市场是上涨或下跌的），如果趋势一开始，你就能发觉，并且捕捉到了很大幅度的市场移动，那么作为交易商你就会赚到很多钱。然而，作为一个趋势跟踪者，必须买涨卖跌，而且如果市场已经上涨了一段时间，你想按照这一特定的观念进行交易，就必须依然能够买进。所有的趋势跟踪者都必须问自己以下问题：</p>
<ul>
<li>我将如何发现趋势？我将如何知道市场是有趋势的？</li>
<li>我将在上涨的趋势和下跌的趋势中交易吗？</li>
<li>当市场做横向移动时（根据很多估计，85%的时间里会做横向移动），那我该怎么办？</li>
<li>我的入市标准是什么？</li>
<li>我将如何进行纠正？</li>
<li>我将如何知道趋势在什么时候结束？</li>
</ul>
<p>图4-1给出了一个完美的趋势的例子。你可以看到，如果能足够早地发现这一趋势，你就会有一个挣到一大笔钱的绝好的机会。在第5章，汤姆·巴索精彩地分析了趋势跟踪这一观念。</p>
<blockquote>
<p>图4-1 一只呈明显上升趋势的股票</p>
</blockquote>

<h2 id="波段交易"><a href="#波段交易" class="headerlink" title="波段交易"></a><span style="color:#00ACC1;">波段交易</span></h2><p>人们可以成功交易的第二个观念是波段交易。这一观念认为交易市场大致在一定范围内波动，市场在有限的时段内是上升的，然后达到范围的最高点，接着就是在有限的时段内呈下降趋势，直到达到该范围的最低点。图4-2给出了一个你可以用来进行交易的在一定范围波动的市场的例子。</p>
<blockquote>
<p>图4-2 在一定范围内波动的市场</p>
</blockquote>

<p>注意就这里所选的特定的股票，即Linear技术公司的股票，只要在价格触到并由此进入上升段时卖出股票，你就干得很漂亮；同样只要在价格触到并由此进入下降段时买进，你同样干得很漂亮。不过，总是存在同样的问题，你如何确定这些波段？我只是在事后把它们给画出来，但也有数学方法可以将其做得更为客观。你如何结清一个头寸，尤其是价格总是不会进入相反的波段时？如果你正在使用的波段范围失效，你该怎么办？</p>
<p>如果能觉察这样一个在一定范围内波动的市场，那么你的目标将是在价格到达该范围最高点时卖出，在最低点时买进。如果你喜欢这一特定的交易观念，那么你必须问自己的主要问题如下：</p>
<ul>
<li>我如何发现在一定范围内波动的市场并在这样的市场上买进？</li>
<li>波段在一个有趋势的市场上也会有效吗？</li>
<li>我如何界定这个范围？比如，我应该用固定的或者是静止的波段？</li>
<li>我的入市标准是什么</li>
<li>波段如果失效，我该怎么办？我如何退出市场？</li>
<li>我要在波段的另一端退出市场吗，是在什么标准下？</li>
</ul>
<p>D.R.巴顿在第5章对波段交易进行了精彩的分析。</p>
<h2 id="价值交易"><a href="#价值交易" class="headerlink" title="价值交易"></a><span style="color:#00ACC1;">价值交易</span></h2><p>价值交易集中在价值的某种确定上。采用这种观念，买进的是那些价值被低估的股票或商品，卖出的是那些价值被高估的股票或商品。在采用这种方法时，你要问自己以下一些关键问题：</p>
<ul>
<li>我如何确定价值？</li>
<li>股票或商品的价值何时被低估了？</li>
<li>我判析买进价值被低估的股票或商品的标准是什么？</li>
<li>我判析卖出价值被高估的股票或商品的标准是什么？</li>
</ul>
<p>很多基本面分析者和资产组合经理也都使用某种形式的价值交易。</p>
<h2 id="套利"><a href="#套利" class="headerlink" title="套利"></a><span style="color:#00ACC1;">套利</span></h2><p>套利是指在某地以低价买进某一商品而在另一地高价卖出。这种价格差异的出现通常是由于法律或市场运作方式出现了某些暂时的漏洞。比如，我有位客户最近发现他可以花300万美元买到芝加哥交易所的一个席位，然后把这个席位拆卖到380万美元，这笔交易就有27%的潜在收益，是稳操胜券来钱快的买卖，但来钱快的买卖通常都很容易完蛋。在这个例子中，你要买CBOT的席位，就得买CBOT的股票，而且要求你持有这一股票6个月才能卖出。如果你买的股票，在要求持有的6个月期间跌了27% ，那么你所有的利润都会被抵消殆尽。所以，像大多数套利交易一样，这一套利也有风险。</p>
<p>如果套利是适合你的方法，你也必须问问自己以下关键问题：</p>
<ul>
<li>我需要在什么市场范围内寻找和发现漏洞？</li>
<li>准确的漏洞是什么，我如何最好地利用漏洞？</li>
<li>风险是什么？</li>
<li>漏洞会持续多长时间，我如何知道它已经消失？</li>
</ul>
<p>很多场内经纪人，尤其是从事期权交易的经纪人，都在利用各种形式的套利。另外，那些自2000年幸存下来的屈指可数的几个日交易商都是因为发现了有利的套利机会才得以幸存下来的。已故的雷·凯利在第5章对套利进行了精彩的分析。</p>
<h2 id="价差交易"><a href="#价差交易" class="headerlink" title="价差交易"></a><span style="color:#00ACC1;">价差交易</span></h2><p>做市商和期权交易商所使用的另一种交易技巧就是价差交易。价差交易与套利是相关的，因为它们通常都要求买进一种商品而卖出另一种商品，要求买卖顺序是对的。比如，很多外汇交易就是一种价差交易，因为你在一种货币中成为多头（也就是说，你拥有这种货币并从其汇率上涨中获利）；而在另一种货币中你成为空头（就是说你从这种货币的汇率下跌中获利）。</p>
<p>作为价差交易商，必须问自己如下关键问题：</p>
<ul>
<li>我认为什么商品的价格会移动？</li>
<li>对这种移动，我应该卖出什么以防范我面临的风险？</li>
<li>我的利润封顶吗（就像有些期权交易那样）？</li>
<li>如果我判断错误，我将如何发现？</li>
<li>如果判断准确，我又如何知道移动已经结束？</li>
</ul>
<p>第一位加入我的顶级交易人项目的凯文·托马斯写了第5章价差交易这一部分。</p>
<p>第5章所讲到的你可以从中进行选择的其他交易观念还有季节性概念（在一个最适合市场变化的某些特定的时间段进行交易）和认为万物都存在着某种神秘的秩序的观点。除了以上所说的这些观念以外，我不知道是否还有其他的交易观念，但是这些观念已经很多了，你可以从中选择一两种。</p>
<h1 id="确定大环境"><a href="#确定大环境" class="headerlink" title="确定大环境"></a><span style="color:#339AFF;">确定大环境</span></h1><p>我自1982年以来就从事交易商的教练工作，在此期间， 目睹了很多市场周期。在我刚开始做教练时，很多客户都是期货交易商和期权交易商。这很有意思，因为我正是在股票市场呈严重的长期熊市之初开始教练工作的。</p>
<p>20世纪80年代，我的很多客户继续做期货交易，尽管期货交易有一种被大的CTA主宰的趋势。到80年代末，期货市场趋于萎缩（因为通货膨胀已结束），慢慢地，所有这些交易商都转向了外汇交易。</p>
<p>到20世纪90年代，我的客户中开始有了很多股票交易商。到2000年3月达到顶峰，那时有70多个人参加了我的股票市场研讨班。当时，在举办这些研讨班的旅馆，一个酒店伙计说： “也许我们应该参加撒普博士的股票市场研讨班。”但是，另外一个伙计却这样回答：“不会吧，我都能去教这样的研讨班。”</p>
<p>类似的事情通常发生在市场出现极端情形时，你知道2000年发生了什么事情。现在，到2006年，我又发现大约一半的客户是期货交易商，可见我的客户明显地进行周期性的转移，他们被吸引到热门市场上-不过也许转向的时机不对。因此。我现在认为把对大环境的评估作为系统开发的一部分是至关重要的。适合大环境的几个互不相关的系统有可能构成一个非常不错的交易计划，另外，如果大环境有所改变，应该多开发几个系统来使用。</p>
<p>我相信这一步是至关重要的，因此在这本书中，我特意加了整整一章的内容来帮助你评估大环境。另外，我对大环境的分析放在了我的免费电子邮件通讯——《撒普思想》中并每月进行更新。</p>
<h1 id="确定交易的时间架构"><a href="#确定交易的时间架构" class="headerlink" title="确定交易的时间架构"></a><span style="color:#339AFF;">确定交易的时间架构</span></h1><p>第六个任务是决定你想在市场上的活跃程度。你交易的时间架构是怎样的？你是否想进行非常长期的观望，也许一个季度只改变一次资产组合？你是否想成为一个持有头寸一年或更长时间的股票商？你是否想成为持有头寸1-6个月的长期期货商？你是否想成为一个每天都有可能做几笔交易，每次持有头寸都不会超过几天的摆动交易商？还是思选择最后一种——成为一个日交易商，每天做3～10笔交易，在每天收盘前结清所有的交易，不承受隔夜风险？</p>
<p>表4-1列出了长期交易的优点和缺点。长期交易和投资是很简单的，每天只需花一点时间，也只需承受很小的心理压力——尤其是你想利用空闲时间来做或者作为一个业余爱好时。如果能适当地调整头寸，使用一个相当简单的系统，你也可以赚到很多钱。</p>
<blockquote>
<p>表4-1 长期交易的优点和缺点</p>
</blockquote>

<p>我认为长期交易或者投资的主要优点是，市场中的每一个头寸都给你带来无限的利润空间（至少从理论上说是这样的），在研究了很多通过投资致富的那些人后，你会发现在很多情况下，财富都是因为人们买了很多股票并且一直持有而逐渐积累起来的（这些人有可能买了一打低股本的股票，可能有11种是毫无价值的，而有一个却变成了新的大股。因为他们根本就没把股票当同事，结果买股票的人既没有在垃圾股变得一钱不值前甩掉它，也没有发现哪此是绩优股，直到它变得非常值钱），其中一只股票最后变成了一座金矿：它在10～20年时间内，把几千块钱的投资变成了上百万。</p>
<p>长期交易或投资的主要缺点是你必须要有耐心。例如，你不可能有很多机会，因此必须等待它的出现。另外，一旦你进入了一个头寸，就必定会经历非常剧烈的资本变动（尽管你可以进行某些设计以使其最小化），你必须耐心地等待这些变动结束。长期交易的另一个缺点是一般需要投入较多的钱，如果没有足够的钱，那么就不能适当地调整资产组合的头寸。实际上，很多人在市场上赔钱，仅仅是因为他们没有足够的钱来实践其正在做的交易或者投资类型。</p>
<p>短期交易（可以是任何形式的短期交易，从日交易到1-5天的摆动交易）具有不同的优点和缺点，这些都列在了表4-2中。将其与表4-1对比一下，你就可以决定哪一种交易适合自己的个性。</p>
<blockquote>
<p>表4-2 短期交易的优点和缺点</p>
</blockquote>

<p>一次我遇到一位短期外汇交易商，他每天大约完成6笔交易，且没有一笔交易会持续一两天以上。最有意思的是他的收益和亏损大致相等，而他75%的交易是赚钱的。这是一种绝妙的交易方法。他自己拿出50万美元来交易，又从银行获得1000万美元的信贷额度。在你理解了本书后面即将讨论的头寸规模确定的概念后，就会认识到这一系统和任何存在的事物一样接近圣杯。他利用这一系统和所拥有的资本每年可以轻而易举地赚到上亿美元（然而，命运对拥有这样一个极好的系统的人却是残酷的。在这个例子中，这个人不能交易持仓量，也不可能从心理上解决他的问题，因为他不相信他和问题会有任何关联。实际上，到这一步他根本不可能进行交易，因为他很紧张，而且认为是他的胃在妨碍他进行交易，因此，在我看来，他并没有理解圣杯系统背后的真正含义，即在市场中找寻自我。）。</p>
<p>然而，大多数短期系统并非如此，其中大多数的可靠度都不会高于60% ，其收益通常还不及亏损，甚至会带来负的期望收益（我的一位客户基于显著大于亏损的收益开发了一个日交易系统，其系统的可靠度不到50%，但还是给他带来了巨额的问报。这表明仍有其他方法来构筑短期交易系统。）。有时，一笔大额亏损就有可能摧毁整个系统，从心理上打垮交易商。另外，短期交易的心理压力非常大。曾经有一个人打电话对我这样说：</p>
<blockquote>
<p>我几乎每天都赚钱，在两年的时间里几乎从未有一个星期是赔钱的，至少到目前为止是这样的，但昨天，我把过去两年赚到的钱全给赔进去了。</p>
</blockquote>
<p>在确定短期交易适合你之前，记住这一点：利润是有限的，而交易成本是非常高的。最为重要的是，短期交易产生的心理压力有可能把你击垮。尽管如此，我还是认为最大的利润百分比是由具备与交易系统和谐一致的心理并频繁进行交易的短期交易商实现的。我曾见过一些短期交易商，在其与市场及其自身非常协调一致时.能够实现每月50%甚至更高的利润（利用像50000美元这样的小额账户）。</p>
<h1 id="确定交易的实质以及如何客观地加以测试"><a href="#确定交易的实质以及如何客观地加以测试" class="headerlink" title="确定交易的实质以及如何客观地加以测试"></a><span style="color:#339AFF;">确定交易的实质以及如何客观地加以测试</span></h1><p>你奉行的主要理念是什么？你的理念的首要内容应该告诉你这些变动发生的条件。你如何才能客观地测试这一首要内容呢？一般地，对这个问题的回答会给出系统的两个要素：你可能想用的方案条件和时机选择或入市信号。这两个问题会在本书后面给以深入的分析。</p>
<p>方案和时机选择信号对系统的可靠度非常重要——在这种移动发生时，你多长时间会赚到一次钱？对它们的测试应该独立于系统中的所有其他要素。</p>
<p>前面提到过的勒博和卢卡斯有非常好的测试这类信号的方法。他们的做法是确定在各种时段之后信号的可靠度（在百分之多少的时间，系统是盈利的）。你可以尝试一个小时、一天中的最后时刻，或者1天、2天、5天、10天和20天之后。一个随机系统平均应该有大约50%的可靠度（也就是说，一般会在45%～55%之间）。如果你的观念比随机系统要好，那么它就应该达到55%的可靠度或者更好，特别是在1～5天的时间段内。如果达不到，就说明你的观念并不比随机系统好，无论这一观念看上去多么合理。</p>
<p>在进行入市检验时，如果入市可靠度是你的目标，那么唯一要注意的就是在选定的时间段后获利的频率是多少。因为没有止损，所以这不是问题。如果加入止损，系统的可靠度就会降低，因为有些可以获利的交易有可能亏本出售。在确定系统的可靠度时没有考虑交易成本（如价格差异和佣金），一旦你把交易成本加进去，可靠度也会降低。你想知道的是在这些要素加进去之前，入市可靠度是否显著高于碰运气。</p>
<p>有些理念在刚开始奉行时看上去是非常高超的。你可能会发现自己有100次有利的移动的例子，而且你的想法与它们都是吻合的。因此，你变得非常兴奋，然而，你还必须考虑到因为你的测试方法或步骤有缺陷而得出你希望的结果的比率。在没有好的移动时你的观念出现的频率又如何？如果错误地得出希望的结果的比率非常高，那么你就并未拥有一个很好的理念，而且可能不比碰运气好多少。</p>
<p>在使用这类测试时应该记住的是可靠度并不是系统唯一需要考虑的方面。如果入市理念帮你捕捉了大量的获利移动.那么它也可能是非常有价值的。</p>
<p>有些人可能会说我忽略了系统开发中很重要的一环：优化。然而，优化只是让你的观念与历史吻合，优化做得越多，将来系统的有效性就越差。相反，我认为应该尽最大努力去理解理念，对自己的优势理解得越多，你必须去做的历史性测试就越少。</p>
<h1 id="确定初始风险1R"><a href="#确定初始风险1R" class="headerlink" title="确定初始风险1R"></a><span style="color:#339AFF;">确定初始风险1R</span></h1><p>理念的另一重要内容就是要知道它什么时候失效，因此，下一步就是理解保护性止损的作用（止损用在这里，是因为在市场上大多数人通过提交一个停价指令来实现这种止损。意思是一旦市场达到这个价位，把我的指令当做一个市场指令来执行。）。保护性止损是系统告诉你，为了保护资金，什么时候该退出交易的那一部分。它是任何系统的关键部分，是你为了保住资金而应该退出市场的那个点，因为你的理念看上去并不起作用。如何知道理念不起作用取决于理念的本质</p>
<p>比如，假设你知道某一理论这样说：通往市场完全是有规律可循的。你可以确定一天中市场的转折点-有时甚至是一小时的转折点。在这种情况下，理念将告诉你市场应该移动的时点。入市信号应该是一个价格确认，即市场确实在移动，如波动幅度突破点（见第9章）。此时，你需要有一个止损点来告诉你，你的理念没起作用。你会选择什么作为止损点呢？如果还没有实现很大的盈利，市场就突破了时间的窗口，你该怎么办？你可能就想退出来，因为你没有预测到让你入市的市场的转折点。或者你可能会把最近10天的日平均价格波动幅度（比如平均真实波幅）看做市场的干扰。如果价格以此干扰輛度（或者几倍于此的干扰幅度）向着背离你的方向移动，你可能就想退出来。</p>
<p>第10章会对保护性止损的例子给予深入的讨论。仔细阅读那一章，选择最适合你理念的一种（或更多种）做法。也许你的理念会产生一种第10章没有谈到的合理的止损点，如果是这样，那么就去用吧。</p>
<p>想-想你入市想实现的目标是什么。它是不是相当武断？你认为一个大的走势应该出现吗？如果是这样的话，那么你很有可能是想留给市场很大的空间，以便这个趋势能够发展。结果，你将会使用一个非常宽的止损。</p>
<p>也许你的理念很严谨。你预计很多时候会是错的，但是如果你对了，交易就不会赔钱。如果是这样，那么你可以确立一些非常接近的止损，在得到执行时不会损失很多钱。</p>
<p>一旦你决定了止损的本质，就可以把止损和交易费用（估计的价格差异和佣金）加到先前的步骤中，再重新计算一次。你可能会发现，在加进这些因素后，人市信号的可靠度显著下降。比如，如果初始可靠度是60%，在把止损和交易成本加到每一笔交易之后，它可能就会降到50%～55%之间了。</p>
<p>在这个阶段，你已经确定了你所做的每笔交易的初始风险（或R）是多少，这对你来说很重要，因为你现在可以把利润设定成初始风险的几倍（或R的倍数）。例如，大多数优秀的交易商坚持认为，除非能给他们带来至少3倍于其潜在风险的潜在收益（3R），否则他们绝不会做这笔交易。在本书后面，你将会明白每一个系统其实都是由它所产生的利润和损失的R乘数的分布来表示的。</p>
<h1 id="增加见利抛售通道确定系统的R乘数分布及其期望收益"><a href="#增加见利抛售通道确定系统的R乘数分布及其期望收益" class="headerlink" title="增加见利抛售通道确定系统的R乘数分布及其期望收益"></a><span style="color:#339AFF;">增加见利抛售通道确定系统的R乘数分布及其期望收益</span></h1><p>系统的第三部分内容就是应该告诉你移动何时结束，因此，下一步就是要确定你怎样实现利润。第11章对市场退出进行了广泛的讨论，到时你将知道什么样的市场退出是最有效的，认真阅读第11章并确定什么样的市场退出最适合你的理念。在你退出市场之前，想一想自己的情形：你想努力实现什么？你交易的时间架构如何以及你的观念是什么。</p>
<p>一般来说，如果你是一个长期的交易商或者投资者，试图捕捉大的走势或获得长期基本价值的回报，那么就需要一个非常宽的止损区间。如果你不想频繁进出市场，就只能在30%～50%的头寸上赚钱，因此你期望收益是大额的-大到平均风险的20倍。如果属于这种情况，那么你的市场退出应该旨在捕捉一些大的利润。</p>
<p>如果你是一个频繁进出市场的日交易商或转手倒卖者，就会青睐一个相当窄的止损区间。你期望50%以上的头寸是正确的-事实上也必须如此，因为你在市场上停留的时间不够长，难以捕捉巨额的回报。事实上，你在寻找一些回报一风险比率为1的小亏损。50%～60%的时间赚钱，将损失保持在最低的水平以及仍然能捕捉几次可以带来高额利润的交易都是有可能的。</p>
<p>总的来说，当你考虑市场退出时，需要让系统的期望收益尽可能高。期望收益是交易系统的R乘数的平均数，换一种说法，就是在系统中，经过很多次交易之后，平均每笔交易每一美元可以赚到的钱。计算期望收益的精确公式以及影响它的一些因素，将在第7章中进行深入讨论。不过，模型到此为止，你的目标就是获得尽可能高的期望收益。你也在寻找尽可能多的交易机会（在有限的时间架构范围内）以实现这一较高的期望收益。</p>
<p>在我看来，期望收益是由市场退出控制的，因此，最好的系统要有3个或者4个不同的市场退出选择，你需要一个一个地检验所选择的退出策略。你可能需要根据自己的交易和/或投资理念合理地进行选择。不过，你需要利用（到目前为止）一切可利用的手段来测试它，从而确定它对你的期望收益有何影响。</p>
<p>一旦确定了期望收益，就可以逐一查看系统交易的结果。期望收益是由什么形成的？它是否主要由很多回报——风险比率为1：1或2：1的交易构成？还是你发现期望收益主要是由一两笔大额交易形成的？如果是长期交易，而期望收益中大宗交易并没有占到多大的份额，那么你可能就需要调整市场退出策略，以捕捉到一些大宗交易（如果你是根据真实交易的结果（你在市场上正在做的交易）来看待期望收益的，那么如果它比较低（比如说每美元15美分或更少），这有可能是由你的心理问题造成的，比如，你没有遵循系统或由于恐慌而过旱地将盈利实现。）。</p>
<h1 id="确定R乘数分布的准确性"><a href="#确定R乘数分布的准确性" class="headerlink" title="确定R乘数分布的准确性"></a><span style="color:#339AFF;">确定R乘数分布的准确性</span></h1><p>现在你已经清楚了交易系统的实质，因为你应该能够确定系统的R乘数分布。换句话说，回顾所有历史交易的盈亏结果，看看你的系统分布是怎样的。亏损是1R，还是小于1R，还是大于1R？利润作为初始风险的函数，看上去如何？是否偶尔会有些交易达到20R，甚至达到30R？有很多2R或3R的收益吗？得出的R乘数分布的特点是什么？</p>
<p>在初次确定期望收益时，你可能受到很多偏见的影响，因此，现在需要通过进行小额的安时交易来确定R乘数分布的准确性。如果交易1～10股股票或一手商品合约会怎样？你会得到什么样的R乘数分布？它是否和你通过理论推导出来的或通过历史测试得出来的结果类似？它的期望收益是否不错？</p>
<p>你还需要知道交易系统在各种市场上会产生什么样的R乘数分布。例如，市场可能上涨，可能下跌，也可能做横向移动。它们在这样移动时，有可能是在不知不觉中进行，也有可能是以剧烈的方式进行。如果把所有这些因素综合起来考虑，我们就有以下六种不同类型的市场：</p>
<ul>
<li>平缓的上涨；</li>
<li>剧烈的上涨；</li>
<li>平缓的横向移动；</li>
<li>剧烈的横向移动；</li>
<li>平缓的下跌；</li>
<li>剧烈的下跌。</li>
</ul>
<p>你应该知道在以上每一种类型的市场上，系统都会出现什么样的结果，这意味着对以上每一种类型的市场进行完整交易的结果应该至少是R的30倍即30R，如果得不到这样的结果，至少需要在进行交易之前，从理论上理解你的系统在以上每一种类型的市场上是如何表现的。系统在剧烈下跌的市场上有效吗？除少数期权系统以外，很多系统在平缓横向移动的市场上是不起作用的。你需要确切地进行了解。</p>
<h1 id="评价整体系统"><a href="#评价整体系统" class="headerlink" title="评价整体系统"></a><span style="color:#339AFF;">评价整体系统</span></h1><p>在有了一个系统之后，你需要对它的效果进行评价。有几种方法可以用以对系统进行评价。</p>
<p>通过成功率来评价系统如何之好是最幼稚的方法，因为你会认为大多数时间都能赚钱的系统将是最好的系统。然而，在第1章有关判断捷径部分，我就已经阐明，你的系统可能在90%的时间里都是对的，但是如果用它来进行足够的交易，最后还是会让你赔钱。因此，成功率并非最优的度量标准。</p>
<p>你可以有很多更好的方法用来确定系统的优劣：</p>
<ul>
<li>系统的期望收益。难道一个平均每笔交易能帶来2.3R收益的系统不比一个平均每笔交易仅能带来0.4R的系统好吗？答案是未必。</li>
<li>在一个固定的时间段结束之际，系统的预期收益是R的多少倍？如果系统1在一个月末带来20R的收益，而系统2带来30R的收益又怎样呢？答案依然是：产生30R收益的系统有时不比20R的好。因为它还取决于系统的可变性。比如，一个能平均产生30R收益的系统有可能在30%的时间里带来负的期望收益，而一个平均能带来20R收益的系统很可能从不会产生负的期望收益。</li>
</ul>
<p>一旦确定了系统的准确性，了解了它在各种市场上的表现以及通过和其他可能的系统相比较其表现如何，你就该努力实现你的目标了。实现目标的方法是确定头寸规模。</p>
<h1 id="利用头寸规模确定实现目标"><a href="#利用头寸规模确定实现目标" class="headerlink" title="利用头寸规模确定实现目标"></a><span style="color:#339AFF;">利用头寸规模确定实现目标</span></h1><p>期望收益是对系统真正潜能的粗略估计。你已开发出了一个合适的系统，接下来就需要决定你将用什么计算方法来确定头寸规模。确定头寸规模在任何系统中都是最重要的部分，因为只有通过头寸规模的确定你才能达到目标。确定头寸规模就是交易系统中帮助你实现目标的那一部分。</p>
<p>在每一个头寸上你的规模是多少？你能否承受只建立一个头寸（就是说一股股票或者一份期货合约）？这些问题是能否实现目标的关键——无论你是渴望三位数的回报率还是平稳的收益曲线。如果确定头寸规模的计算方法不适当，你就会破产，不管你对破产如何定义（是赔掉资金的50%，还是全搭上）。但是，如果你确定头寸规模的技巧对资金、系统和目标都进行了很好的设计的话，那么一般情况下就能达到目标。</p>
<p>本书第14章讨论了很多用来确定头寸规模的模型，都是你在设计系统时需要给予考虑的。在确立了自己的目标，开发了一个具有高期望收益的系统后，你就可以利用这些模型去实现目标。然而，你需要应用和测试各种不同的头寸规模确定模型，直到找到那种可以完美地与你渴望实现的目标相匹配的模型。</p>
<h1 id="确定如何改进系统"><a href="#确定如何改进系统" class="headerlink" title="确定如何改进系统"></a><span style="color:#339AFF;">确定如何改进系统</span></h1><p>开发系统的下一个任务是确定如何改进它。市场研究是一个持续进行的过程，</p>
<p>市场往往会根据在其中运作的人的特点而改变。比如，眼下股票市场是由专业的共同基金经理控制的，然而，在这7000多位经理当中，在市场中工作了足够长的时间且日睹了20世纪70年代长期熊市的不到10位。另外，期货市场是由一些专业的期货顾问控制的，他们中的大多数都使用趋势跟踪战略操纵着大量的资金，而在另一个10～20年之间，可能是截然不同的参与者，因此市场会呈现出另一种不同的特点。</p>
<p>任何一个具有不错的正的期望收益的系统，只要在给定的时间段内进行更多的交易，其效果都会有所改进。因此，可以通过加入独立的市场来改进系统的效果。事实上，一个好的系统可以在很多不同的市场中都表现良好，因此增加更多的市场仅仅是给了你更多的机会。</p>
<p>另外，系统的效果还可以通过增加毫无关联的其他系统来改进—每一个系统都有自己独特的头寸规模确定模型。例如，如果你有一个主要的趋势跟踪系统和-个非常短期的利用市场盘整的系统，那么把两者结合起来效果就可能非常好，在市场趋势不明朗时，短期系统可以为你赚钱。它还可以减轻在此期间趋势跟踪系统产生的任何账户价值的亏损所带来的冲击，或者从总体上看，你也许还能赚到钱。无论哪一种情况，你的收益都会更好，因为你可以以较大的资金基础进入趋势。</p>
<h1 id="做好面对最坏情形的精神准备"><a href="#做好面对最坏情形的精神准备" class="headerlink" title="做好面对最坏情形的精神准备"></a><span style="color:#339AFF;">做好面对最坏情形的精神准备</span></h1><p>想一想系统在各种不同的情形下可能的表现很重要。你期望系统在所有的市场情形下——包括剧烈变动的市场、盘整的市场、趋势很强的市场以及缺乏信心的萧条的市场——将如何表现？除非你了解在每一种可能的市场情形下，系统有可能会如何表现，否则你不会真正知道它的表现会如何。</p>
<p>汤姆·巴索很乐意在我们的系统研讨班中告诉学生们，他们应该这样思考其系统：</p>
<blockquote>
<p>设想一下如果每次交易你都采取了相反的做法，那将如何？假装你恰恰是买进（而不是卖出）或假装你恰恰是卖出（而不是买进），你的感觉如何？你会怎么想？</p>
</blockquote>
<p>这一练习是你可以做的最重要的练习之一。我强烈建议你认真去做。</p>
<p>你也需要为每一种有可能发生的大灾难做好准备。例如，如果市场出现了对你不利的1～2天的价格冲击（非常大的移动），你的系统将会如何表现？想一想你如何忍受意料之外的一辈子只会碰到一次的剧烈市场波动，比如道琼斯指数下降500点（其实在过去10年中已经发生过两次了）或者在海湾战争期间科威特发生的原油灾难。由于目前商品行情暴涨，目前原油价格涨到了每桶70美元，如果需求将其推至每桶150美元又会怎样？这将如何影响你和你的交易？如果又出现了剧烈的通货膨胀而把我们的债务一笔勾销了又会怎样？如果货币与黄金挂钩而被稳定下来，而你又是一个货币交易商，这会如何影响你的系统？或者如果一颗流星在大西洋中央坠落，摧毁了欧洲和美国一半的人口，又会怎样？或者发生了诸如通信被中断或计算机被盗这样很平常的事情，那又会怎样？</p>
<p>你必须考虑有可能发生的最坏的情形以及你将如何应对。充分考虑并确定你能想到的每一种可能给系统造成灾难的情形，在列出这些灾难之后，针对每一项灾难设计出可以执行的几个方案来，在头脑中想象一下你的反应并进行演练。一旦你计划好了在意料之外的灾难性事件发生时应如何行动，那么你的系统就是完备的了。</p>
<!-- flag of hidden posts -->
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/通向财务自由之路/" rel="tag"># 通向财务自由之路</a>
          
        </div>
      

      
      
      

      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="CheBin">
            
              <p class="site-author-name" itemprop="name">CheBin</p>
              <div class="site-description motion-element" itemprop="description">看视频才能学会，看文字学不会的</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">1140</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">27</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">79</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          

          
          


          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <!-- modify icon to fire by szw -->
                <i class="fa fa-history fa-" aria-hidden="true"></i>
                近期文章
              </div>
              <ul class="links-of-blogroll-list">
                
                
                  <li>
                    <a href="/2023/07/19/zero-admin-3/" title="zero-admin-3" target="_blank">zero-admin-3</a>
                  </li>
                
                  <li>
                    <a href="/2023/07/19/zero-admin-2/" title="zero-admin-2" target="_blank">zero-admin-2</a>
                  </li>
                
                  <li>
                    <a href="/2023/07/19/zero-admin-1/" title="zero-admin-1" target="_blank">zero-admin-1</a>
                  </li>
                
                  <li>
                    <a href="/2023/07/19/Day7-服务发现与注册中心/" title="Day7 服务发现与注册中心" target="_blank">Day7 服务发现与注册中心</a>
                  </li>
                
                  <li>
                    <a href="/2023/07/19/Day6-负载均衡/" title="Day6 负载均衡" target="_blank">Day6 负载均衡</a>
                  </li>
                
              </ul>
            </div>
        

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#列出清单"><span class="nav-number">1.</span> <span class="nav-text">列出清单</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#培养开放的观念，收集市场信息"><span class="nav-number">2.</span> <span class="nav-text">培养开放的观念，收集市场信息</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#确定任务和目标"><span class="nav-number">3.</span> <span class="nav-text">确定任务和目标</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#确定交易观念"><span class="nav-number">4.</span> <span class="nav-text">确定交易观念</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#趋势跟踪"><span class="nav-number">4.1.</span> <span class="nav-text">趋势跟踪</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#波段交易"><span class="nav-number">4.2.</span> <span class="nav-text">波段交易</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#价值交易"><span class="nav-number">4.3.</span> <span class="nav-text">价值交易</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#套利"><span class="nav-number">4.4.</span> <span class="nav-text">套利</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#价差交易"><span class="nav-number">4.5.</span> <span class="nav-text">价差交易</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#确定大环境"><span class="nav-number">5.</span> <span class="nav-text">确定大环境</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#确定交易的时间架构"><span class="nav-number">6.</span> <span class="nav-text">确定交易的时间架构</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#确定交易的实质以及如何客观地加以测试"><span class="nav-number">7.</span> <span class="nav-text">确定交易的实质以及如何客观地加以测试</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#确定初始风险1R"><span class="nav-number">8.</span> <span class="nav-text">确定初始风险1R</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#增加见利抛售通道确定系统的R乘数分布及其期望收益"><span class="nav-number">9.</span> <span class="nav-text">增加见利抛售通道确定系统的R乘数分布及其期望收益</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#确定R乘数分布的准确性"><span class="nav-number">10.</span> <span class="nav-text">确定R乘数分布的准确性</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#评价整体系统"><span class="nav-number">11.</span> <span class="nav-text">评价整体系统</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#利用头寸规模确定实现目标"><span class="nav-number">12.</span> <span class="nav-text">利用头寸规模确定实现目标</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#确定如何改进系统"><span class="nav-number">13.</span> <span class="nav-text">确定如何改进系统</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#做好面对最坏情形的精神准备"><span class="nav-number">14.</span> <span class="nav-text">做好面对最坏情形的精神准备</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2023</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CheBin</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">站点总字数：</span>
    
    <span title="站点总字数">8.9m</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    
    <span title="站点阅读时长">135:21</span>
  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a></div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.1"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.1"></script>



  
  <script src="/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  

  

  


  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  

  
  

  


  

  

  

  

  

  

  

  

  
<script>
  $('.highlight').each(function(i, e) {
    var $wrap = $('<div>').addClass('highlight-wrap');
    $(e).after($wrap);
    $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function(e) {
      var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
        return $(e).text();
      }).toArray().join('\n');
      var ta = document.createElement('textarea');
      var yPosition = window.pageYOffset || document.documentElement.scrollTop;
      ta.style.top = yPosition + 'px'; // Prevent page scroll
      ta.style.position = 'absolute';
      ta.style.opacity = '0';
      ta.readOnly = true;
      ta.value = code;
      document.body.appendChild(ta);
      ta.select();
      ta.setSelectionRange(0, code.length);
      ta.readOnly = false;
      var result = document.execCommand('copy');
      
        if (result) $(this).text('复制成功');
        else $(this).text('复制失败');
      
      ta.blur(); // For iOS
      $(this).blur();
    })).on('mouseleave', function(e) {
      var $b = $(this).find('.copy-btn');
      setTimeout(function() {
        $b.text('复制');
      }, 300);
    }).append(e);
  })
</script>


  

  

</body>
</html>
