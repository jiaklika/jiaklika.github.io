<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2">





















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？ 表述定律，意思是当人们认为某事物被指定用来代表另一事物时，它就是它应该代表的那件事物。怎么理解？">
<meta name="keywords" content="通向财务自由之路">
<meta property="og:type" content="article">
<meta property="og:title" content="第2章 判断之偏好：掌握市场为何对多数人来说如此之难">
<meta property="og:url" content="http://yoursite.com/2021/07/24/第2章-判断之偏好：掌握市场为何对多数人来说如此之难/index.html">
<meta property="og:site_name" content="车斌的技术博客">
<meta property="og:description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？ 表述定律，意思是当人们认为某事物被指定用来代表另一事物时，它就是它应该代表的那件事物。怎么理解？">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/2021/07/24/第2章-判断之偏好：掌握市场为何对多数人来说如此之难/1.jpg">
<meta property="og:updated_time" content="2021-11-05T07:44:37.108Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第2章 判断之偏好：掌握市场为何对多数人来说如此之难">
<meta name="twitter:description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？ 表述定律，意思是当人们认为某事物被指定用来代表另一事物时，它就是它应该代表的那件事物。怎么理解？">
<meta name="twitter:image" content="http://yoursite.com/2021/07/24/第2章-判断之偏好：掌握市场为何对多数人来说如此之难/1.jpg">






  <link rel="canonical" href="http://yoursite.com/2021/07/24/第2章-判断之偏好：掌握市场为何对多数人来说如此之难/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>第2章 判断之偏好：掌握市场为何对多数人来说如此之难 | 车斌的技术博客</title><meta name="robots" content="noindex">
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">车斌的技术博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">专注</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/07/24/第2章-判断之偏好：掌握市场为何对多数人来说如此之难/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CheBin">
      <meta itemprop="description" content="绝知此事要躬行，不动手就是懒。一篇文章看10遍，而不是10篇文章看1遍。">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="车斌的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">第2章 判断之偏好：掌握市场为何对多数人来说如此之难

              
            
          </h1>
        

        <div class="post-meta">

          

          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2021-07-24 16:03:02" itemprop="dateCreated datePublished" datetime="2021-07-24T16:03:02+08:00">2021-07-24</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2021-11-05 15:44:37" itemprop="dateModified" datetime="2021-11-05T15:44:37+08:00">2021-11-05</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/期货/" itemprop="url" rel="index"><span itemprop="name">期货</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">17k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">15 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>思考并回答以下问题：</p>
<ul>
<li>总结一下，这章作者最主要想表达什么观点？</li>
<li>表述定律，意思是当人们认为某事物被指定用来代表另一事物时，它就是它应该代表的那件事物。怎么理解？</li>
</ul>
<a id="more"></a>
<p>你现在已经明白了对圣杯系统的寻找其实是一种内在的寻找。本章将帮助你走出寻找的第一步，即知道是什么在妨碍你。当你清楚了是什么在妨碍你，并接受了你要对自己的人生负责的观点后，你就有了改变的能力。</p>
<p>总的来说，所有问题的根源是我们必须经常处理大量的信息。从耶稣时代到达·芬奇时代的1500年的时间里，信息流翻了一倍；到1750年（大约250年之后），信息流又翻了一倍；接下来到19世纪末20世纪初的一次翻倍只花了150年的时间；计算机时代将信息流翻倍的时间缩短到了约5年。由于计算机、光纤以及互联网等，当前面临的信息流大约1年甚至在更短的时间里就会翻一番。</p>
<p>研究者估计，人类利用当前的大脑潜能，每次只能摄取所有视觉信息的1%～2%，对于交易商和投资者来说，这种情形就是一个极端了。交易商或投资者同时关注着世界上所有的市场，每一秒钟都要面对上百万字节的信息流。很多交易商同时开着2～4台电脑，由于一天24小时世界上总有一些市场是开放着的，因此信息流是永不停止的。一些被误导的交易商也就目不转睛地盯着交易屏幕，试图竭尽全力处理尽可能多的信息。</p>
<p>而大脑处理信息的能力是非常有限的，即使是在理想的情形下，一次也只能吸收5～9个信息集。一个信息集可以是1个字节，也可以是成千上万个字节（比如，一个信息集可以是数字2，也可以是数字687941）。比如，看完以下一串数字，合上书，然后努力把它们都写下来。</p>
<center>6 38 57 19 121 83 41 917 64 817 24</center>

<p><br>你能记住所有的数字吗？或许不能，因为我们只能有意识地处理7±2个信息集。然而每秒钟都有上百万字节的信息涌向我们，而且当前我们可获得的信息流的速度每年都在翻倍。我们该如何应付？</p>
<p>答案是：对所面临的信息进行归纳、剔除和曲解。我们归纳及剔除大部分的信息，比如“噢，我对股市不感兴趣”，这一句话就概括了可获得的有关市场信息的大约90%，将其概括为“股市信息”而不予考虑。</p>
<p>我们对自己确实很关注的信息进行选择性的归纳，如“我只想浏览一下符合以下标准的每日行情柱状图”，然后按照这些标准利用计算机对数据进行分类，结果，多得令人难以置信的信息突然间就缩减成了计算机屏幕上的几条线，而这几条线是我们的大脑能够处理的。</p>
<p>然后，大多数交易商和投资者就通过把留下来的信息表示成指数的形式对这些归纳出来的信息加以曲解。比如，我们不是只看最近的蜡烛图，相反，我们认为以10天的指数移动平均，或者14天的RSI（相对强弱指标），或者一个随机数，或者一个波段或趋势线等形式表示的信息更有意义。所有这些指标都是信息歪曲失真的例子，而人们交易的是基于他们对失真信息的评价，这些看法可能是有用的，也可能是没有用的。</p>
<p>心理学家总结了大量的信息剔除和曲解，并汇总标以“判定捷径”。之所以称其为“判定”，是因为它们影响我们的决策过程；称其为“捷径”，是因其简便易行，使得我们能够在短时间内对大量的信息进行筛选和整理。没有它们，我们就不可能做出市场决策，但是对于那些没有意识到信息的存在，以及没有意识到已经对信息在加以利用的人来说，这些信息也是非常危险的，它们影响我们进行交易系统开发和市场决策的方式。</p>
<p>大多数人使用判定捷径的基本方式是维持现状。通常我们是在对市场的看法进行交易，而且一旦形成了这些看法，就不太可能有所改变。在进行市场运作时，我们想当然地认为自己已经考虑到了所有可能的信息。其实不然，我们有可能通过选择性的感知而排除了最有用的信息。</p>
<p>很有意思的是，卡尔·波普指出：认知的进步更多地来自我们对理论进行的挑剔，而不是对它进行的证明。如果这一理论正确，那么我们越是能认识到自己的看法和判析（尤其是对市场的判析），并加以推翻，就越有可能在市场上成功地赚钱。</p>
<p>本章旨在探究这种判断捷径或者倾向如何影响交易或投资的过程。首先，我们将概括那些扭曲系统开发过程的倾向，本章所涉及的大多数倾向都属于此类。然而，其中有些倾向也会影响交易的其他方面。例如，赌徒谬论会影响交易系统的开发，因为投资者想要的是不会产生一连串亏损的系统，但系统一经开发出来，这一倾向也会影响我们利用系统进行交易的方式。</p>
<p>其次，我们将概括那些会影响你如何检测系统的倾向。例如，一位绅士在面对本书中的一些内容时，声称这些内容到处都是矛盾而且遗漏了关键部分，事实上，这些评价只是他自己的认识而已。本书中所展示的内容并无冲突，它们只是信息，因此，如果你察觉了某种矛盾，那是因为这些矛盾来自你自己。另外，本书将很多人进行系统开发的某些步骤给略去了，它们是被有意略去的，因为研究表明它们并不重要，对于一个良好系统的开发，与其说它们是帮助还不如说是障碍。</p>
<p>最后，我们归纳了那些可能会影响你就已开发出来的系统如何进行交易的倾向。尽管这是一本研究交易系统的书，但其所归纳的倾向仍是很重要的，因为在你实际开始交易之前进行调研时必须对此加以考虑。然而，我特意把本章这一部分压缩到最小篇幅，因为在我为交易商和投资者开设的函授课程里对这些倾向有更详细的论述。</p>
<h1 id="影响交易系统开发的偏好"><a href="#影响交易系统开发的偏好" class="headerlink" title="影响交易系统开发的偏好"></a><span style="color:#339AFF;">影响交易系统开发的偏好</span></h1><p>在考虑交易系统之前，你必须将可获得的市场信息以你的大脑能够处理信息的方式表述出来。如图2-1，它是一个典型的蜡烛图，也是大多数人分析市场活动的方式。日蜡烛图概括了一天的数据，包含四个信息：开盘价、收盘价、最高价和最低价，从中也可以直观地看出市场总体上是上涨还是下跌。图中较粗的部分（蜡烛）代表开盘价与收盘价之差，而两头（烛芯）代表最高价和最低价。实芯烛形表示市场下跌，空芯的表示市场上涨，市场变化看起来就更容易了。</p>
<blockquote>
<p>图2-1 蜡烛图</p>
</blockquote>
<img src="/2021/07/24/第2章-判断之偏好：掌握市场为何对多数人来说如此之难/1.jpg">
<h2 id="表述偏好"><a href="#表述偏好" class="headerlink" title="表述偏好"></a><span style="color:#00ACC1;">表述偏好</span></h2><p>图2-1所示的日蜡烛图就是我们每个人都用的第一种判定捷径的很好的例子，称为<span style="color:red">表述定律，意思是当人们认为某事物被指定用来代表另一事物时，它就是它应该代表的那件事物。</span>因此，我们大多数人都只看日蜡烛图，并认为它代表了一天的交易。事实上，它只不过是纸上的一条线罢了——仅此而已，但你却认为它富有意义，因为：</p>
<ul>
<li>在你第一次开始研究市场时，别人就告诉你它是有意义的；</li>
<li>其他人都用日蜡烛图来代表市场；</li>
<li>在你购买或免费获得数据时，它们一般都是以日蜡烛图的形式表示的；</li>
<li>在考虑一天的交易时，你一般也是将其设想成日蜡烛图。</li>
</ul>
<p>图2-1的蜡烛图只向你展示了三个信息：第一，它表明一天之内发生的价格波动范围；第二，它表明了价格是如何变动的——如何从开盘价变化到收盘价（加上一些最高价和最低价的变化）；第三，蜡烛图通过蜡烛实芯和空芯的使用使得一天的整体变化更直观。</p>
<p>日蜡烛图没有告诉你什么呢？它没有告诉你发生了多少交易；没有告诉你在什么价位成交了多少交易；它不能告诉你一天中商品或股票是何时按给出的价格成交的（除了在开始或结束时）。而这些信息对交易商和投资者来说都是有用的。你可以通过缩小时间范围并查看5分钟蜡烛图或最小波动点图来获取这些信息，但是使用日蜡烛图不就是为了减少信息流量以免得我们招架不住吗？</p>
<p>还有一些对交易商可能有用的其他信息也没有在日蜡烛图中显示出来。比如对期货来说，这些交易是否包括新合同的签订和原有合同的交割？在进行交易的都是些什么人？是不是少数几个场内交易商整天在彼此交易，竭力算计和彼此操纵？有多少交易是一手合约（如100股股票或者一手商品合约）？有多少交易是大宗的？有多少是由大头寸交易商买进或抛出的？有多少是由共同基金资产组合经理或大头寸商品基金经理买进或抛出的？又有多少是被套期保值者或大公司买进或抛出的？</p>
<p>还有第三类信息也没有在日蜡烛图中显示出来，就是谁在市场中。比如，有多少人当前是多头或空头？他们的头寸分别是多少？这类信息是可以获得的，但一般不容易得到。在计算机的支持下，各种交易每天都可以存储和报道如下信息：</p>
<blockquote>
<p>价格从83点升到85点。共有4718位投资者持有多头头寸，头寸平均规模是200个单位，一天内，多头头寸增加了共50600个单位。有298位投资者持有空头头寸，头寸平均规模为450个单位，空头头寸增加了5个单位。前100个头寸由以下人持有，他们的头寸分别是……（接下去就是一串列表）。</p>
</blockquote>
<p>也许你会说，是的，我就想知道谁持有以及他们的头寸是多少。难道你获得了这些信息，就知道该怎样加以利用了吗？它就会对你更有意义了吗？也许不会，除非你已经具备了某些可以让你交易的决定。</p>
<p>而且日蜡烛图也没有给你提供任何统计意义上的概率，比如，假如X发生了，那么Y发生的概率是多少？你可以利用历史数据来确定Y发生的概率，但变量X（以及本例中的变量Y）必须包括在你的数据里面，但是如果X或Y很有意义却没有包括在你的数据里又会怎样呢？</p>
<p>还有另一类至关重要的信息也没有包含在一个简单的日蜡烛图中——心理信息。这类信息涉及多头和空头持有信心的强度。各类交易商可能会在什么时间什么价位清盘？他们对各类信息或价格变化会如何反应？有多少人置身市场之外观望，并相信市场会上涨或下跌呢？他们是否会将对市场的预期转变为行动从而进入市场？他们会在什么情况下实现这种转变？如果进入市场，他们会在什么价位进入，背后可能会有多大的资金实力支撑其头寸？即使拥有了这些信息，你是否已形成能帮助你从中赚钱的结论了呢？</p>
<p><span style="color:red">直到现在，你可能都一直认为日蜡烛图就是真正的市场。记住，你所看到的只是计算机或书上的一条简单的线而已。你设想它代表了市场，可以把它看成给定某一天市场活动的概括，你也只能这么看。可怕的是，充其量只是概括性信息的日蜡烛图，却正是你决策时要处理的原始数据。 </span></p>
<p>我希望你已经开始理解为什么判定捷径对你作为一个投资者来说如此重要。然而我讲述的只不过是判定捷径偏好的一个例子罢了，我们不得不认为一幅蜡烛图真的代表了一天的市场活动的倾向。</p>
<p>你可能仅凭蜡烛图进行交易，但是大多数人在进行交易前希望对数据做些加工，因此他们会使用指标。然而不幸的是，人们在使用市场指标时会犯同样的错误，认为这些指标就是事实，而不是只尝试着用来代表可能发生的事情模拟。RSI、随机数据、移动平均、MACD等——似乎是呈现了事实，但是它们只不过是一些被假定用来代表某些事物的对原始数据的曲解罢了。</p>
<p>考虑一下图上支撑位的技术概念。最初，技术分析师发现，一旦价格跌到图中某一区域时就好像会反弹，这一区域就被认为是很多买家都愿意买进的价位，因此而“支撑”了股票的价格水平。不幸的是，很多人视诸如支撑位和阻力位这样的词语为真实的现象，而其实它们只是代表了人们过去所观察到的现象的新的推断而已。人们在判断一些事情时，倾向于“它看上去什么样”，而不是“它的可能概率是多少”，前面已在此基础上讨论了表述的偏好。这在使用交易系统或交易信号时尤其重要。在开发交易系统或评估信号的有效性时，你是否考虑过信息的可能性概率？就是说，你有没有考虑过你预计的结果符合真实交易信号的可能性是多少？很可能没有，因为我在1000个交易者中没有见过一位是这样做的——尽管我对他们一再强调这一点。这就意味着大多数人都不检查他们的系统，或者不知道系统的期望收益（见第7章）。</p>
<p>下面讨论一些其他的倾向，我确定这些倾向对你考虑市场和交易系统开发会有影响。</p>
<h2 id="可靠性偏好"><a href="#可靠性偏好" class="headerlink" title="可靠性偏好"></a><span style="color:#00ACC1;">可靠性偏好</span></h2><p>与表述偏好相关的另一个偏好是我们假定数据是可靠的——它们真的就是被期望的那样。就日蜡烛图而言，我们设想它代表了一天的数据，看上去也像是一天的数据，因此就应该是。然而，很多数据销售商通常把白天的数据和晚上的数据进行合并，那么它还是一天的数据吗？而且这些数据的准确性又如何呢？</p>
<p>经验丰富的交易商和投资者都知道，判定数据的可靠性可能是他们遇到的最糟糕的问题之一。大多数数据销售商提供的数据就日蜡烛图而言还是相当准确的，但是当你开始使用最小波动点数据、5分钟蜡烛图、30分钟蜡烛图等时，准确性就不复存在了。因此，如果你测试一个基于5分钟蜡烛图的系统时，大部分结果（不管是好还是坏）更多的是与不准确的数据有关，而不是真正期望的结果。</p>
<p>下面新闻特写中的故事就是有关在数据方面会遇到的问题。这是在一份业务通讯中报道的查克·布兰斯科姆的真实故事。</p>
<blockquote>
<p>我用自己设计的系统对16个期货市场的资产组合进行交易。我每晚利用资产组合交易系统软件根据白天的数据来运行我的系统代码以生成指令。基本的入市/退出规则编入了一个实时软件程序，这样当我在某一市场中建立头寸时就会被告知。<br><br>1995年7月10日，在开盘前，我准确无误地发出了我所有资产组合的入市和退出指令。芝加哥货币市场刚刚开盘，实时软件就警示我进入了加拿大元多头头寸。我大吃一惊，因为那天我根本没有发出加拿大元的指令。我只是怀疑地盯着屏幕看了几秒钟。因为受过在遭遇市场突发事件时的心理训练，我自动地进入了演习状态：做深呼吸，从头到脚全身放松，对错误原因按照可能性从大到小进行系统检查。<br><br>仅仅花了几分钟时间，我就发现为运行资产组合交易软件而下载的数据和我的实时软件收集到的数据，有关前一天的最低价是不同的。我对前一天最小波动点数据进行快速检查后，证实了我的怀疑：资产组合系统中使用的数据是无效的。我很快对数据库进行手工编辑并再次运行了程序，结果生成了一个入市指令。我看了一眼屏幕，结果发现市场现在跌停回升远远在我的入市点之上。我非常沮丧，但还是平静地将信息从程序输入到我的资产组合经理的空白表格上以确定头寸规模。盯着屏幕，我发现市场又上升了5个最小波动点，我也做好了发出指令的准备。那一刻我的反应完全是下意识和集中的：给我的交易员打电话，发出指令进入市场。<br><br>整个过程大约花了10分钟时间，在这一过程中，加拿大元的价格继续回升，离我入市时的价位越来越远。幸运的是，心理训练使我不去揣测行为的结果。我的交易目标是不能错过任何一次入市机会，因为我不知道市场什么时候就会出现一次巨大的移动。<span style="color:red">错过一次大笔的成功交易要比做了一笔少有亏损的交易糟糕得多。</span>当我意识到应该入市时，打电话成了一个下意识和专注的反应。就我所做的交易类型而言，这是正确的做法。希望市场回到入市时的价位或者揣测是否应该坚持下去是没有用的。<br><br>这件事情的发生表明我需要创建一个程序，迫使我对每一个期货合约的日数据进行严格的检查。直到那一刻，我还以为自己对日数据的检查已经足够充分的了。过去我也发现过很多错误，但是现在我才知道每天还需要做更多的工作以确保我能够按照预计的方案进行交易。</p>
</blockquote>
<p>读完这个故事，你就能明白市场远不是大多数人想象的那样，一切都并非如你所期望的那样。在你以为拥有了一个很好的系统时，也许只是因为糟糕的数据使系统看上去很好；反之，在你以为系统很差时，也许正是糟糕的数据使系统看上去很差。</p>
<p>但是假定你已经接受了日蜡烛图确实代表了市场这一事实，你想接受这些概括性的信息并进行交易，那我要告诉你，还有很多其他的倾向有可能渐渐地潜入你的思维中。</p>
<h2 id="彩票偏好"><a href="#彩票偏好" class="headerlink" title="彩票偏好"></a><span style="color:#00ACC1;">彩票偏好</span></h2><p>彩票偏好和人们在以某种方式操纵数据时信心倍增有关——就好像操纵数据是有意义的，能让他们控制市场。既然你已经把日蜡烛图作为表述市场的方式，那么就必须按照蜡烛图进行交易。或者以某种方式加以处理，直到你能信心百倍地利用它进行交易。其实，对数据进行处理本身就能够并且也将给你增强信心。</p>
<p>产生控制错觉的一个很好的例子就是州政府经营的一种博彩游戏，即抽数字。在玩抽数字时，要挑出一些数字，通常是6或7个数字，如果全部命中，你立刻就会成为百万富翁。人们真的喜欢玩这种游戏，即使那些清楚投注赔率、富有逻辑性的人也是如此。为什么呢？因为中彩回报是如此丰厚，而风险是如此之小（1美元的彩票比起巨额的中彩回报是微不足道的），使得人们趋之若鹜。即使运气差到买100万张彩票（每张上面的数字都不相同）都不能中彩，他们也不在乎。你在州政府发行的彩票中赢得100万美元的概率是1/13000 000（如果你想赢得更多，概率更小）。</p>
<p>以区区小钱去赌巨彩也是一种判断捷径，但还不是彩票偏好。彩票偏好指的是人们在做游戏时产生的控制错觉，因为自己可以挑选数字，因此他们就认为成功的概率会增大，于是有些人就料想如果他们选择生日或周年纪念日的数字，可能会增加成功的概率。比如，几年前，一名男子赢得了西班牙国家彩票头奖，之所以中奖，是因为他对梦的解释。他连续7个晚上都梦见了7这个数字，错误地认为7乘以7等于48，于是他就选择了上面有数字4和8的彩票。</p>
<p>其他有些人不是靠梦，而是与心理学家或占星家交换意见。事实上，你可以通过购买各种各样的点子来帮助自己赢得彩票，那些分析了数字就认为自己能够预测随后出现的数字的人非常愿意把点子卖给你。还有一些人有自己的彩票机，他们相信彩票机摇出的一系列随机数字，也许正好和州政府控制的彩票机挑出的数字一样。如果有些“大师”或占星家声称他有几个大奖赢家时（如果他有足够多的信徒的话，当然是有这种可能的），那么会有更多的人跟在他后面。人们会千方百计地寻找那些神奇的数字。</p>
<p>如果这些看起来有些熟悉，就对了!这正是投机市场上发生的事情。人们相信通过选择正确的数字，可以一下子挣到一百万美元。选择正确的数字，对投机商和投资者而言，就是指他们想知道该买什么以及什么时候买。一般人关心的最重要的问题就是，我眼下买什么会让我大发一笔。大多数人宁愿让别人告诉他们该做什么。</p>
<p>人们会千方百计地想出眼下该做什么，他们购买软件来选取数字和分析趋势。经纪人发现，如果他们在收音机和电视节目上快速解读入市点来帮助人们选取数字，成千上万的人会需要他们的主意。如果大家都知道你在公开地给人出谋划策，不管你的主意多么准确（或不准确），别人都会把你当做专家。除此之外，还有许多“大师”擅长鼓动并乐此不疲地在他们的业务通讯中告诉别人该买什么以及何时买。当然，占星家在这个过程中同样扮演着某种角色。</p>
<p>也有些人认为自己可以改善自己的境况，结果，他们开始沉迷于入市信号，在他们看来，入市信号等同于一套完整的交易系统。你会有一种控制了入市信号的感觉，因为你选择入市的那一点正是你希望市场这样做的。结果，你觉得自己好像可以进行某些控制了——不只是控制你的入市，还可以控制市场。不幸的是，一旦你持有头寸，市场便开始按照自身的方式运行，除了可以决定退出之外，你再也无法控制别的任何事情。</p>
<p>我对人们如何看待一个交易系统大为震惊!几年前，一位绅士从澳大利亚来见我，此人已经与美国各地的很多专家就什么样的交易系统有效进行过探讨。在一次晚宴上，他跟我谈起他学到的东西，还向我展示了他发现的各种系统的“精华”，希望得到我的认可。他有一些很不错的思想，然而他向我展示的所有交易系统都与入市技巧有关。事实上，他对每一个交易系统的描述都只有一点，那就是入市。我的评价是他的方向是正确的，但是如果他能花同样的工夫去研究一下市场退出和头寸规模确定，那么他就真的会有一个好的交易系统。</p>
<p>很多人认为如果有某一入市点能够让他们赚钱，他们就有了交易系统。读到本书的后面，你会知道一个专业的交易系统由多达10个部分组成，而入市信号可能是最不重要的。然而很多人就只想知道什么时候进入市场。</p>
<p>1995年，我在马来西亚召开的期货与股票技术分析国际会议上发过言。来自美国的演讲者大约有15人，听众对我们的发言都打了分。那些得分最高的演讲者讲得最多的就是入市信号。有一位讲的是交易系统的各个组成要素，其实他的演讲是非常有价值的，但得分却最低。</p>
<p>我参加了其中一个得分较高的演讲。演讲人是一个非常聪明的交易商，1994年他的账户金额增加了76%，只有一个10%的亏损。然而他讲的主要是捕捉趋势的变化信号，一共展示了6～8个这样的信号，当人们问他问题时，他才略微提及一些关于市场退出和资金管理的问题。后来，我问他那些信号都用得上吗？他的回答是“当然不是！我用的是趋势跟踪信号，但是他们就想听这些，我当然就给他们讲这些了。”</p>
<p>我的一位客户读了这些资料后，做了如下记录：“一直以来，我认为‘彩票偏好’，是一种因为缺乏控制感而感到焦虑时进行交易的一种方式。许多人宁愿假装市场尽在掌控之中（尽管有时是错误的），也不愿因不能控制自己必须身处的环境而感到焦虑。意识到‘我可以控制自己的行为’是跨越性的一步，这也就足够了！”</p>
<p>这种偏好如此强大，以至于人们总是得不到能让他们在市场中赚钱的信息，相反，得到的只是他们想听到的。毕竟，一般来说，人们是通过给他人想要的而不是给其所需要的而挣到大部分钱的。本书对此是一个例外，并且，希望将来会有很多这样的例外。</p>
<h2 id="小数定律偏好"><a href="#小数定律偏好" class="headerlink" title="小数定律偏好"></a><span style="color:#00ACC1;">小数定律偏好</span></h2><p>图2-3所示的模式可以描述一些人的另一种倾向。市场有4天时间没有任何移动（在图示的前5天里），随后便是大涨。如果仔细阅读过一些图表书，你会发现四五个这样的例子。小数定律指的是你没有用很多此类的案例就得出了结论。例如，当市场在4天的窄幅波动后随之出现了价格大涨，我们就在此时入市。</p>
<blockquote>
<p>图2-3 倾向于吸引人们入市和获得入市信号的实例</p>
</blockquote>

<p>实际上，大多数人是依据他们从几个精选的例子中观察到的模式进行交易的。如果你看到一个如图2-3所示的模式，其后有一个较大的波动，那么你就会认为这个模式是一个很好的入市信号。请注意，到目前为止我们所讨论过的四种偏好都进入了你的入市决策。</p>
<p>威廉·埃克哈特下面的一段话很好地阐述了小数定律偏好：</p>
<blockquote>
<p>我们不是中性地看待数据，也就是说，当我们的眼睛浏览一张图表时，并不是对所有的数据点等量观之，给以同等的关注，而是会集中于某些突出的情形，并倾向于基于这些特殊的情形而形成我们的观点。选出一个取得惊人成功的案例，而忽视其日复一日惨败的情形，是人类的本性。因此，即使相当认真地阅读图表，你也会倾向于认为该系统比其本身真实的情况好得多。</p>
</blockquote>
<p>科学研究是清楚这种偏好的。即使最认真的研究者也会倾向于使其结果符合原先的假定，这就是为什么科学家要进行双盲试验的原因，即在试验结束之前，试验者并不知道哪一组是测试组，哪一组是控制组。</p>
<h2 id="保守主义偏好"><a href="#保守主义偏好" class="headerlink" title="保守主义偏好"></a><span style="color:#00ACC1;">保守主义偏好</span></h2><p>一旦脑海中有了交易的概念，保守主义偏好又会左右我们：我们认识不到，甚至看不见相互矛盾的例证。人类的大脑总是一下子就能看到寥寥几个很显眼的有效波动的例子，而回避或忽视那些系统无效的例子。例如，看到许多数据，你可能会发现图2-3中的模式随后有20%的时间出现了较大的波动，而其他时间没什么重大的变化。</p>
<p>大多数人完全忽视相互矛盾的例证，尽管它是非常显著的。然而，连续亏损七八次后，他们会突然开始关注交易系统的有效性，而从来都不确定会发生多少次亏损。</p>
<p>如果在20%的时间里出现的移动足够大的话，仍然是可以交易的，但是你必须在其他80%的时间里谨慎地止损，而这正好也说明了彩票偏好的重要性。如果只是关注模式，你也许就不会赚到钱。</p>
<p>这种偏好的含义是指人们在市场中搜寻他们想要的和期望看到的东西，结果，大多数人都不是中性地看待市场，因此无法把握走势。相反，他们总是在搜寻他们期望看到的。</p>
<h2 id="随机性偏好"><a href="#随机性偏好" class="headerlink" title="随机性偏好"></a><span style="color:#00ACC1;">随机性偏好</span></h2><p>接下来的偏好以两种方式影响交易系统的开发。首先，经济学家以及很多投资者倾向于认为市场是随机的——价格是按照随机的可能而变动的；其次，如果这种随机性存在的话，人们对它可能的含义做出的假定是错误的。</p>
<p>人们喜欢选择最高点和最低点的原因之一是，他们认为市场能够并将会在任何时刻扭转走势。从根本上说，他们认为市场是随机的。的确，许多学者仍然持有市场是随机的这样的看法，但这种设想正确吗？即使是正确的，人们能够在这样一个市场中交易吗？</p>
<p>市场可能有随机性的特征，但这并不表明它就是随机的。例如，你可以利用随机数字生成器软件产生一系列的蜡烛图。当你观察这些蜡烛图时，它看起来就像蜡烛图，但这正是一个表述偏好的例子，看起来像是随机的并不等于就是随机的。这种数据不像是市场数据，因为市场价格的分布有两个极端的尾部，这是你无法根据呈正态随机分布的价格预测出来的。为什么呢？你观察一下市场数据，会发现样本的波动性随着数据的增加变得越来越大。在标准普尔指数期货合约问世后的10年间，1987年10月19日标准普尔指数下跌了80点，这是很难根据一个随机数字系列预测到的。这种事情可能10000年才出现一次，但它就在现实生活中发生了，而且，它还发生了第二次。1997年10月27日，标准普尔指数又下跌了70点，第二天，它的变化幅度是87点。类似地，在2000年和2002年间，纳斯达克也出现了几次在一天内大幅度下跌的情形。</p>
<p>市场价格分布的方差往往会无穷大，或几近无穷大，这一事实表明：超乎你想象力的更极端的情形可能行将发生。因此，任何由此推出的风险都将被大大地低估，而且不幸的是，大多数人在市场中承受了太多的风险。像汤姆·巴索这样的市场奇才声称：在一个头寸上承担的风险高达资本的3%，你简直就是一个“枪手”。可见大多数人就其承担的风险而言，的确是太疯狂了。</p>
<p>即使市场是随机的，人们也没有理解随机的含义。如果在一个随机序列中出现了一个长期趋势，人们就认为它不是随机的。他们发明了一些理论，说它不是一个随机序列中的一个长期趋势，而是别的什么东西，这种现象来自我们认为世界万物都是可以预测和理解的自然偏好。因此，人们总是寻找那些根本不存在的模式，并认为那些未经证实的因果关系是存在的。</p>
<p>随机性偏好（以及彩票偏好）的一个后果是人们往往想选取最高点和最低点。我们希望自己是正确的并且能够掌控市场，同时将自己的想法贯彻到市场中去，结果就会产生一个看法，即我们能够找到最高点以及最低点。试图这样做的那些人注定要面临许多失败。</p>
<h2 id="理解需要偏好"><a href="#理解需要偏好" class="headerlink" title="理解需要偏好"></a><span style="color:#00ACC1;">理解需要偏好</span></h2><p>许多人在开发交易系统的方法上会产生理解需要偏好，他们完全忽略随机因素，甚至未将头寸规模确定视为交易系统的一部分。</p>
<p>我的一个客户，乔，声称他在进入一个头寸时会存在很大的困难，他很困惑。因此，我问了他几个问题。“你的头寸多长时间获利一次？”他的回答是大约60%的时间都是正确的。“在对市场感到困惑时，你有多少次退出一笔盈利的交易？”这次他的回答是几乎一次都没有。然后我说：“你的系统给你带来的机会比碰运气好不到哪儿去，可见你可能对市场不甚了解，但当你不知所措时，就应该退出市场。”他也认为这可能是一个好主意。</p>
<p>仔细想想乔的交易系统，会发现实际上他并没有一个系统。为什么？因为乔过于专注去理解市场的每一个方面，以至于他不能清楚地界定市场退出信号，这些信号告诉他何时应该退出市场以保护资金以及何时应该实现收益。</p>
<p>大多数人仍然需要构建一个关于市场上究竟在发生什么的详细理论。媒体总是想向人们解释市场，尽管它们对市场一无所知。例如，当道琼斯工业平均指数下降超过100点时，第二天各大报纸会充斥各种各样的解释。下面就是你有可能会在当地报纸上看到的东西：</p>
<blockquote>
<p>周三来自美联储有可能提高利率的最新消息会令投资者在周四紧张不安。因害怕整个行业范围的盈利下滑，股票，尤其是建筑公司的股票会大跌。在今天的市场氛围下，无论什么时候只要投资者认为利率可能提高，他们看起来就会异常紧张。他们也会对中东局势的影响非常关注。任何异常的迹象都会令投资者紧张不安。</p>
</blockquote>
<p>第二天道琼斯工业平均指数可能会上升100点之多，你可能就会看到类似下面一段的报道：</p>
<blockquote>
<p>华尔街走出了因利率可能大幅提高的谣言带来的恐慌再次投身市场，道琼斯工业平均指数上涨了100点以上。H.P.Mor证券公司的R.P.吉尼如此评论说：“盈利是如此之高，以至于投资者似乎很容易摆脱潜在灾难性信息的影响。”</p>
</blockquote>
<p>在交易系统设计中，理解需要偏好变得更加复杂。人们用各种各样奇怪的方式操控日蜡烛图，并且据此发明一些奇怪的理论来解释市场。这样形成的理论可能有其自身的道理，但几乎没有现实的依据。比如，艾略特波浪理论的合理依据是什么？为什么市场有时三条腿移动，有时又两条腿移动呢？</p>
<p>现在你理解交易系统开发的任务为什么包含了如此多的心理偏好了吗？我的经验是，大多数人如果没有解决因恐惧或生气造成的一些心理问题，那么他们就无力处理交易系统设计中出现的问题。此外，有些人甚至不想解决这些问题——实际上，这些人很可能略过这一部分，直接进入系统开发的实质阶段。</p>
<h1 id="影响交易系统测试的偏好"><a href="#影响交易系统测试的偏好" class="headerlink" title="影响交易系统测试的偏好"></a><span style="color:#339AFF;">影响交易系统测试的偏好</span></h1><p>以下是影响交易系统测试的一组偏好。很多人从未显露过这些偏好，因为他们从未达到过进行系统测试这一步。事实上，本章前面讨论的保守主义偏好会阻止大多数人对系统进行测试。更重要的是，很多人从未拥有过一个可测试的系统。对于那些确实达到系统测试这一步的人而言，潜伏着下列偏好的影响。</p>
<h2 id="自由度偏好"><a href="#自由度偏好" class="headerlink" title="自由度偏好"></a><span style="color:#00ACC1;">自由度偏好</span></h2><p>自由度是一个参数，对每一个允许的数值都会产生一个不同的系统。例如，一个基于10天的移动平均产生的结果会不同于一个基于24天的移动平均产生的结果，因此，移动平均的长度代表一个自由度。人们往往希望在自己的交易系统中有尽可能多的自由度。加进的指标越多，就越能更好地描述市场历史价格。系统中的自由度越大，系统本身就越有可能与一个价格系列相吻合。不幸的是，一个系统与其开发所依据的数据越吻合，它就越不可能在将来产生利润。</p>
<p>系统开发软件（大多数）的确诱导自由度偏好。给一位系统开发商充足的自由空间，他将会有一个能够完美预测市场走向并在纸面上赚到成千上万美元的系统，也就是说在某些历史市场上多数软件能让人达到心理最大满足的程度。最终，他们得到的是一个毫无意义的系统，这一系统只能靠它赖以产生的数据赚钱，而在实际交易中却表现极差。</p>
<p>大多数系统开发软件正是迎合这一偏好而设计的。人们想知道有关市场的准确信息，希望能够完美地预测市场。你现在就可以花几百美元买个软件，它能让你对过去的市场数据进行大量的研究。几分钟后，你就会认为市场是可以被精确预测的，你会一直持有这样的看法，直到你试图在真实的市场上而不是在根据历史数据优化了的市场上交易为止。</p>
<p>对于这一偏好无论我说多少，大多数人还是会陷进去。你还是希望尽可能地优化自己的系统，所以，我还是就这些优化给你提出一些警告。首先，要很好地理解你所使用的概念，这样你就不会觉得需要优化你的系统了。你对自己所交易的概念理解得越好，就越不需要进行历史测试。</p>
<p>其次，我强烈建议你想象一下市场中有可能会发生的各种情形。例如，你可以想象下一场战争、核恐怖袭击、欧元被当做世界储备货币、亚洲共同货币的采用或失业率升至120%的报道等。有些想法可能看上去很荒唐，但是如果你能够明白，万一真的发生，你的系统将会怎样处理这些事件，那么你就非常好地理解了你的概念。不管交易商和投资者多么清楚过度优化所产生的危险，他们还是想优化。因此，我强烈建议你在系统中使用的自由度最多不要超过四五个。在你的整个系统中，如果使用两个指标（每一个都表示一个自由度）以及两个滤嘴，这就是你能忍受的极限了。你要考虑的滤嘴和指标，将在本书后面进行深入的探讨。</p>
<h2 id="事后错误偏好"><a href="#事后错误偏好" class="headerlink" title="事后错误偏好"></a><span style="color:#00ACC1;">事后错误偏好</span></h2><p>人们在使用那些只有在事后才能得到的信息进行测试时就会犯事后错误。在系统测试中，这种错误非常普遍，而且很容易犯。例如，有些软件，如果不够小心，你就会使用今天的数据进行系统测试，通常就会产生事后错误——你可以设想一下用今天的收盘价格来预测今天的价格会有什么意义，这就是一个事后错误。</p>
<p>有时候这些错误是难以察觉的。例如，因为你的数据中最高价位后几乎总是伴随着一些较低的价格，所以就将高价引入到一个交易规则中，结果这个规则运行得非常好是很有可能的——但这只是事后性的。</p>
<p>当测试数据时，如果你的结果看上去特别好，可能就是事后性的。或许你是由于事后性的错误才得到这些结果的。</p>
<h2 id="缺乏自我保护不够偏好"><a href="#缺乏自我保护不够偏好" class="headerlink" title="缺乏自我保护不够偏好"></a><span style="color:#00ACC1;">缺乏自我保护不够偏好</span></h2><p>在你设计一个系统时，你的目标应该是设计一个产生低风险的系统，我对低风险的定义是：</p>
<blockquote>
<p>它是一种方法，它产生的是长期的正的期望收益和你可以赖以生存的回报（总体回报）与风险（最高点到最低点的账户价值亏损）的比率。这种方法必须在这样一种确定头寸规模的水平（通常是按照资本的一个百分比）上交易，即在短期内，它能够保护你免遭最坏的可能情形的冲击，而在长期，又可以让你获得系统的期望收益。</p>
</blockquote>
<p>大多数人的偏好是，他们并不选择在一个风险小到能够保护其在短期内免遭这些最坏情形的冲击的头寸规模确定水平上进行交易。很多人不能，也没有预见到所有的可能会影响其交易系统的事件。因此，对于任何有价值的交易和投资方法，你都必须有各种各样的辅助手段，当你处于一个对你不利的交易时，它能够给你提供保护。</p>
<p>随便问一个人：“如果处于一个不利的交易，你如何脱身？”他或许根本没有想法，大多数人真的没有应备的辅助手段。更重要的是，他们在一个过高的水平上进行交易。如果你有50000美元，同时交易五个甚至更多的期货合约，那么交易所处的风险水平可能就过高了。如果你是个日交易商，被通知追加保证金，那么面对的风险就太高了。这么高的风险水平可能会给你带来较高的回报，但是它最终会让你破产。请想一想保护偏好，仅仅是注意这一偏好就可以保护你目前账户中已有的大部分资本。</p>
<h1 id="影响交易系统运行的偏好"><a href="#影响交易系统运行的偏好" class="headerlink" title="影响交易系统运行的偏好"></a><span style="color:#339AFF;">影响交易系统运行的偏好</span></h1><p>假定你已经检查了系统，也对它进行了全面的测试，认为它能够进行交易了。但即便如此，仍存在一些其他的偏好会导致你推翻这一系统。</p>
<p>你想实现最大的业绩，因此总是存在一些诱惑，让你推翻交易系统，你脑海中总是会浮现偶尔几次你来执行你的系统操作但提高了你的业绩的记忆。然而，你往往忘了那些系统不管用的时候，以及那些曾威胁到你的盈亏底线的日复一日的价格差异（交易成本）。</p>
<p>如果没有一个交易系统，那么就会有许多偏好影响你的交易。然而，即使有了最好的交易系统，你仍然会受到许多关键偏好的影响。让我们来看一下那些会导致人们推翻其交易系统的偏好。</p>
<h2 id="赌徒谬论偏好"><a href="#赌徒谬论偏好" class="headerlink" title="赌徒谬论偏好"></a><span style="color:#00ACC1;">赌徒谬论偏好</span></h2><p>赌徒谬论偏好是随机性偏好的一个自然结果。赌徒谬论是这样一种看法，即它认为如果某一趋势是建立在一个随机序列中的（在这里是建立在市场中），那么这一趋势随时都可以改变。因此，在市场连续4天上涨之后，会预测后面出现下跌，就是那些深受尊敬的市场研究者同样也会有这种偏好。例如，在我看来，拉里·威廉姆斯在下面的一句话中就展示了这种偏好：</p>
<blockquote>
<p>“在你连续三四次交易受挫之后，下一笔交易你不仅可能成功，而且会是一个大成功。”</p>
</blockquote>
<p>如果能像职业赌徒那样，理解赢意味着什么，你就会在连续获胜之后下更大的赌注，而在连续失败之后减少赌注。然而，一般人的做法却恰恰相反：在连续失败后下的赌注更大，而在连续成功后下的赌注更少。</p>
<p>有一次拉尔夫·文斯给40位博士做了一个试验。”要求他们玩100次简单的计算机游戏，有60%的获胜机会。给他们每人1000美元，并告诉他们每次玩时下多少赌注都可以。结果，这些博士们没有一人懂得头寸规模确定（也就是说，赌注大小对这个游戏的结果产生的影响）。</p>
<p>他们中有多少人赚到钱了呢？40位参加者中只有2位在游戏结束后手里的钱比最初的1000美元多，即占5%。然而如果每次都下注10美元，游戏结束时他们就会拥有大约1200美元。如果为了实现最好的收益，而做出最优的下注组合（每次拿出新资本的20%去冒险，这是作者不提倡的），他们最后能够获得7490美元（平均）。到底是怎么回事呢？原来这些参加者倾向于在上次游戏结果不利时下更多的赌注，而在有利时下更少的赌注。假如前三局每次都下了100美元的赌注，最后都输了，结果你的赌本就减到了700美元。你就会想，既然我已经连续输了3次，而获胜的概率是60%，因此下一次一定会赢。结果，你下了400美元的赌注。可是你又输了，现在你的赌本只有300美元，想将它赢回来的机会几乎没有了。</p>
<p>赌徒谬论偏好会影响很多人如何开发一个交易系统、如何确定头寸规模以及如何进行交易。他们完全忽略了随机因素。他们寻找确定的事情，对自己的系统进行交易，好像真的拥有一个系统一样，不为自己提供足够的保护。因此，他们甚至不认为确定头寸规模是系统的一部分。</p>
<h2 id="获利时保守与损失时冒险的偏好"><a href="#获利时保守与损失时冒险的偏好" class="headerlink" title="获利时保守与损失时冒险的偏好"></a><span style="color:#00ACC1;">获利时保守与损失时冒险的偏好</span></h2><p>交易的首要准则就是止损获利。那些遵循这一简单原则的人会在市场中获取巨额财富。然而，大多数人都有一种偏好使得他们要么无法止损，要么无法获利。</p>
<blockquote>
<p>考虑下面的例子，有两种选择，你会选择哪一个：①9000美元确定的损失；②5%不赔的可能加上95%的输掉10000美元的可能。</p>
</blockquote>
<p>你选哪一个？是确定的损失还是冒险去赌？在这个例子中，大约有80%的人会选择冒险赌博。然而，冒险赌博计算出来的损失更大（10000美元×0.95+0美元x0.05=9500美元-大于9000美元确定的损失）。冒险赌一把违反了交易的关键原则：止损。然而，很多人仍然愿意选择赌博，因为他们认为市场会止跌回升。事实通常并非如此，结果损失变大，变得更加令人难以承受。接着这个过程就会再一次开始，最后，损失巨大，赌的人不得不接受它。许多小的投资者因为无法承受损失而最后破产。</p>
<blockquote>
<p>下面这个例子，你选择哪一个：①9000美元确定的收益；②95%赢得10000美元的可能和5%什么也不赚的可能。</p>
</blockquote>
<p>你选的是确定的收益还是冒险赌博？约有80%的人选择确定的收益。然而，风险赌博算出的收益更大（10000美元×0.95+0美元x0.05=9500美元-大于9000美元的确定收益）。选择确定的收益违反了交易的关键原则的第二个方面：获利。</p>
<p>一旦盈利在手，人们就会非常害怕失去这些盈利，以至于不管市场出现何种反弹信号，都倾向于守住确定的收益。即使其系统没有显示市场退出的信号，也不愿意失去手中的利润，以至于很多投资者和交易商不停地后悔为了少量的确定收益而失去赚大钱的机会。</p>
<p>一个古老的谚语很好地诠释了这两种常见的偏好：抓住机会，并在逆境中坚守阵地。优秀的交易商最好记住下面的格言：仔细留意可以获利的机会，若一旦有不利的迹象要像鹿一样快跑。</p>
<h2 id="当前交易或投资必须成功的偏好"><a href="#当前交易或投资必须成功的偏好" class="headerlink" title="当前交易或投资必须成功的偏好"></a><span style="color:#00ACC1;">当前交易或投资必须成功的偏好</span></h2><p>造成所有这些问题非常突出的原因是人们要兑现当前头寸（眼下手中持有的头寸）之结果的强烈欲望。怎么理解？一方面，如果现在的头寸在赔钱，你会慢慢地耗下去，希望它能有所转机，结果，赔钱的交易往往越做越大；另一方面，为了确保盈利能成为事实，又总是过早地变现当前盈利。</p>
<p>为什么？人们强烈追求做事准确无误。交易商和投资者一次又一次对我说，在他们进行市场预测时准确无误如何重要，更严重的是，他们认为投资市场也是如此。我曾经和一位客户一起工作，他每天传真发布某一特定商品的行情预测，世界各地的大商人都订购了他的传真，因为其信息的准确性非常突出，他也因此名扬世界。然而，尽管其准确性令人瞩目，但他进行交易的能力相当差。为什么？正是因为他对正确的需求。人一旦对事物进行预测，虚荣心就会体现其中，使得他很难去接受在交易过程中出现的看起来与他的预测相异的任何事情。因此，对自己以任何方式进行公开预测的东西进行交易就变得非常困难。</p>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a><span style="color:#339AFF;">小结</span></h1><p>一般人面对的信息量每年都在翻倍，然而，在信息流失前，只能有意识地处理7个信息集。因此，我们发展了许多捷径来帮助应对及处理所面临的大量信息。这些捷径在大多数情况下是有用的，但是，对交易商和投资者而言，这些捷径的暗示作用极其强烈，因此我认为一般人是不可能在市场上赚到钱的，除非他们能够克服这些暗示。我将这些捷径分为三类偏好，归纳如下：</p>
<h2 id="影响交易系统开发的偏好-1"><a href="#影响交易系统开发的偏好-1" class="headerlink" title="影响交易系统开发的偏好"></a><span style="color:#00ACC1;">影响交易系统开发的偏好</span></h2><p><strong>（1）表述偏好</strong>。人们认为当某件事物被指定用来代表另一件事物时，它就是其应该代表的那件事物。因此，我们认为日蜡烛图就是市场，或者说我们喜欢的指标就是市场。相反，我们需要记住，表述只是展示大量信息的一个捷径，而更糟糕的是，它是对信息的曲解。</p>
<p><strong>（2）可靠性偏好</strong>。也许并非正确的事情而人们认为它是正确的。比如，你在进行历史测试时所使用的市场数据，或者你收到的即时数据，经常充斥着错误。除非你认为会有错误，而且的确存在错误，否则你就可能在进行交易和投资决策时犯很多错误。</p>
<p><strong>（3）彩票偏好</strong>。人们总是想掌控市场，因此在入市前，往往专注于入市，这样就能够“迫使”市场做很多事情。不幸的是，一旦他们入市，市场将做市场该做的事。交易的黄金法则是止损获利，与入市无关，而与市场退出关系重大。</p>
<p><strong>（4）小数定律偏好</strong>。人们喜欢看到那些并不存在的模式，只需几个精选的事例就足以说服人们这一模式是有意义的。当你将这种偏好和保守主义偏好结合起来时，你就会处于非常危险的处境。</p>
<p><strong>（5）保守主义偏好</strong>。一旦你相信自己已经找到了一种模式，并相信它有效（通过几个精选的事例），你就会尽一切可能回避它无效的事实。</p>
<p><strong>（6）随机性偏好</strong>。人们愿意认为市场是随机的，有很多最高点和最低点，他们能够轻易地进行交易。然而市场并非随机的。价格分布表明，长期来看，市场变化的方差无穷大，或统计学家所称的钟形曲线尾部的“长尾”。此外，人们没有理解，即使是一个随机市场也会有一个长期趋势，结果，抓住最高点或最低点成了最困难的交易类型。</p>
<p><strong>（7）理解需要偏好</strong>。我们试图理出市场的规则并且为任何事情找到理由。这种寻找规则的尝试会影响人们跟随市场的能力，因为我们看到的只是我们希望看到的事情，而并非真正发生的事情。</p>
<h2 id="影响交易系统测试的偏好-1"><a href="#影响交易系统测试的偏好-1" class="headerlink" title="影响交易系统测试的偏好"></a><span style="color:#00ACC1;">影响交易系统测试的偏好</span></h2><p><strong>（1）自由度偏好</strong>。我们希望优化自己的系统，而且相信操控的数据越是与历史吻合，就能越好地了解交易。其实不然，如果你理解了用来交易或投资的概念是如何运作的，并只做最少量的历史测试，你的状况就会大为改观。</p>
<p><strong>（2）事后错误偏好</strong>。我们会在系统开发中无意识地使用在现实交易中根本没有出现的数据。比如，如果把今天的收盘价考虑进去，那么你的测试结果可能非常好-尤其是当你在收盘前正要退出时。</p>
<p><strong>（3）缺乏自我保护偏好</strong>。人们没有考虑到头寸规模确定和退出市场策略是交易的关键组成部分，因此，在给定的交易中，他们经常将自己太多的资本置于风险之中。</p>
<h2 id="影响交易系统运行的偏好-1"><a href="#影响交易系统运行的偏好-1" class="headerlink" title="影响交易系统运行的偏好"></a><span style="color:#00ACC1;">影响交易系统运行的偏好</span></h2><p><strong>（1）赌徒谬论偏好</strong>。人们认为在一连串的失败之后，成功的可能性会上升；或在一连串的成功之后，失败的可能性会上升。</p>
<p><strong>（2）获利时保守与损失时冒险的偏好</strong>。人们想很快变现利润，而给亏损留些余地，这给了他们一个错觉，以为自己做的是对的，但实际上他们恰恰是在“停止获利，继续亏损”。</p>
<p><strong>（3）当前交易或投资必须成功的偏好</strong>。这一偏好可能是其他倾向产生的基础，然而，事实上，准确无误与赚钱无关。</p>
<!-- flag of hidden posts -->
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/通向财务自由之路/" rel="tag"># 通向财务自由之路</a>
          
        </div>
      

      
      
      

      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="CheBin">
            
              <p class="site-author-name" itemprop="name">CheBin</p>
              <div class="site-description motion-element" itemprop="description">绝知此事要躬行，不动手就是懒。一篇文章看10遍，而不是10篇文章看1遍。</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">453</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">15</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">46</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          

          
          


          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <!-- modify icon to fire by szw -->
                <i class="fa fa-history fa-" aria-hidden="true"></i>
                近期文章
              </div>
              <ul class="links-of-blogroll-list">
                
                
                  <li>
                    <a href="/2022/07/09/Explain详解（上）/" title="Explain详解（上）" target="_blank">Explain详解（上）</a>
                  </li>
                
                  <li>
                    <a href="/2022/07/09/Explain详解（下）/" title="Explain详解（下）" target="_blank">Explain详解（下）</a>
                  </li>
                
                  <li>
                    <a href="/2022/07/07/事务简介/" title="事务简介" target="_blank">事务简介</a>
                  </li>
                
                  <li>
                    <a href="/2022/07/06/MySQL的COUNT语句是怎么执行的/" title="MySQL的COUNT语句是怎么执行的" target="_blank">MySQL的COUNT语句是怎么执行的</a>
                  </li>
                
                  <li>
                    <a href="/2022/07/04/单表访问方法/" title="单表访问方法" target="_blank">单表访问方法</a>
                  </li>
                
              </ul>
            </div>
        

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#影响交易系统开发的偏好"><span class="nav-number">1.</span> <span class="nav-text">影响交易系统开发的偏好</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#表述偏好"><span class="nav-number">1.1.</span> <span class="nav-text">表述偏好</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#可靠性偏好"><span class="nav-number">1.2.</span> <span class="nav-text">可靠性偏好</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#彩票偏好"><span class="nav-number">1.3.</span> <span class="nav-text">彩票偏好</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#小数定律偏好"><span class="nav-number">1.4.</span> <span class="nav-text">小数定律偏好</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#保守主义偏好"><span class="nav-number">1.5.</span> <span class="nav-text">保守主义偏好</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#随机性偏好"><span class="nav-number">1.6.</span> <span class="nav-text">随机性偏好</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#理解需要偏好"><span class="nav-number">1.7.</span> <span class="nav-text">理解需要偏好</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#影响交易系统测试的偏好"><span class="nav-number">2.</span> <span class="nav-text">影响交易系统测试的偏好</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#自由度偏好"><span class="nav-number">2.1.</span> <span class="nav-text">自由度偏好</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#事后错误偏好"><span class="nav-number">2.2.</span> <span class="nav-text">事后错误偏好</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#缺乏自我保护不够偏好"><span class="nav-number">2.3.</span> <span class="nav-text">缺乏自我保护不够偏好</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#影响交易系统运行的偏好"><span class="nav-number">3.</span> <span class="nav-text">影响交易系统运行的偏好</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#赌徒谬论偏好"><span class="nav-number">3.1.</span> <span class="nav-text">赌徒谬论偏好</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#获利时保守与损失时冒险的偏好"><span class="nav-number">3.2.</span> <span class="nav-text">获利时保守与损失时冒险的偏好</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#当前交易或投资必须成功的偏好"><span class="nav-number">3.3.</span> <span class="nav-text">当前交易或投资必须成功的偏好</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#小结"><span class="nav-number">4.</span> <span class="nav-text">小结</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#影响交易系统开发的偏好-1"><span class="nav-number">4.1.</span> <span class="nav-text">影响交易系统开发的偏好</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#影响交易系统测试的偏好-1"><span class="nav-number">4.2.</span> <span class="nav-text">影响交易系统测试的偏好</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#影响交易系统运行的偏好-1"><span class="nav-number">4.3.</span> <span class="nav-text">影响交易系统运行的偏好</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2022</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CheBin</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">站点总字数：</span>
    
    <span title="站点总字数">4.5m</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    
    <span title="站点阅读时长">67:27</span>
  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a></div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.1"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.1"></script>



  
  <script src="/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  

  

  


  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  

  
  

  


  

  

  

  

  

  

  

  

  
<script>
  $('.highlight').each(function(i, e) {
    var $wrap = $('<div>').addClass('highlight-wrap');
    $(e).after($wrap);
    $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function(e) {
      var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
        return $(e).text();
      }).toArray().join('\n');
      var ta = document.createElement('textarea');
      var yPosition = window.pageYOffset || document.documentElement.scrollTop;
      ta.style.top = yPosition + 'px'; // Prevent page scroll
      ta.style.position = 'absolute';
      ta.style.opacity = '0';
      ta.readOnly = true;
      ta.value = code;
      document.body.appendChild(ta);
      ta.select();
      ta.setSelectionRange(0, code.length);
      ta.readOnly = false;
      var result = document.execCommand('copy');
      
        if (result) $(this).text('复制成功');
        else $(this).text('复制失败');
      
      ta.blur(); // For iOS
      $(this).blur();
    })).on('mouseleave', function(e) {
      var $b = $(this).find('.copy-btn');
      setTimeout(function() {
        $b.text('复制');
      }, 300);
    }).append(e);
  })
</script>


  

  

</body>
</html>
