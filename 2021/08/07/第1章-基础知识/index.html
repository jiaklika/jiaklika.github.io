<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2">





















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">
<meta name="keywords" content="Go语言核心编程">
<meta property="og:type" content="article">
<meta property="og:title" content="第1章 基础知识">
<meta property="og:url" content="http://yoursite.com/2021/08/07/第1章-基础知识/index.html">
<meta property="og:site_name" content="车斌的技术博客">
<meta property="og:description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/2021/08/07/第1章-基础知识/t-1-1.png">
<meta property="og:image" content="http://yoursite.com/2021/08/07/第1章-基础知识/t-1-2.png">
<meta property="og:image" content="http://yoursite.com/2021/08/07/第1章-基础知识/1.png">
<meta property="og:updated_time" content="2021-09-16T05:43:49.337Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第1章 基础知识">
<meta name="twitter:description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">
<meta name="twitter:image" content="http://yoursite.com/2021/08/07/第1章-基础知识/t-1-1.png">






  <link rel="canonical" href="http://yoursite.com/2021/08/07/第1章-基础知识/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>第1章 基础知识 | 车斌的技术博客</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">车斌的技术博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">放弃会成为一种习惯</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/08/07/第1章-基础知识/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CheBin">
      <meta itemprop="description" content="看视频才能学会，看文字学不会的">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="车斌的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">第1章 基础知识

              
            
          </h1>
        

        <div class="post-meta">

          

          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2021-08-07 10:04:40" itemprop="dateCreated datePublished" datetime="2021-08-07T10:04:40+08:00">2021-08-07</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2021-09-16 13:43:49" itemprop="dateModified" datetime="2021-09-16T13:43:49+08:00">2021-09-16</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Go/" itemprop="url" rel="index"><span itemprop="name">Go</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">18k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">17 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>思考并回答以下问题：</p>
<ul>
<li>总结一下，这章作者最主要想表达什么观点？</li>
</ul>
<a id="more"></a>
<p>本章介绍Go语言编程的基础知识。常听一些朋友抱怨：“看了某一门语言的编程书籍一百多页，还不清楚一个简单的程序是什么模样，看着后面的内容忘记了前面的内容”。本章不会罗列一个个知识点来介绍语法知识，而是从程序员的视角介绍Go的基础语法知识。先介绍Go源代码的整体构成和特点，然后从编译器词法产生tokens的视角来分析Go源程序的构成，最后介绍语法的基本知识。相信这种从整体到详细的论述视角能更好地帮助读者学习Go语言基础知识。</p>
<p>1.1节先对Go语言的语言特性做一个整体的概述，使读者对Go语言有一个基本的印象。1.2节通过一个简单的“hello world”程序介绍Go语言源程序的整体构成。1.3节从编译器编译源代码的角度介绍Go源程序中token的概念，并对每种token做一个简单的介绍，让读者对Go语言源程序的基本构成单元token有一个整体认识，通过1.2节和1.3节的介绍能让读者先对Go程序建立整体印象。1.4节开始对Go语言源程序重要构成元素变量和常量进行介绍；接着介绍Go语言的基本数据类型和复合数据类型，最后介绍Go语言的控制结构。通过本章的学习，读者能够对Go语言的基础语法支持有一个整体的了解，为深入学习其他语言特性奠定基础。</p>
<h1 id="语言简介"><a href="#语言简介" class="headerlink" title="语言简介"></a>语言简介</h1><p>已经有那么多种编程语言了，为什么还要发明新语言？为什么还要去学习新语言？相信不少人都有这样的疑问。答案很简单，虽然有那么多种语言，但每种语言都有其独特的应用领域，在某个领域使用某种语言能达到收益/投入的最大化。比如在嵌入式领域，汇编和C是首选在操作系统领域，C是首选；在系统级服务编程领域，C++是首选；在企业级应用程序和Web应用领域，Java是首选。就好比木工的工具箱中锤子可以有很多种，大厨的工具箱中刀子有很多种一样，某种语言就像某种锤子或者某种刀一样，有其特别应用的领域。</p>
<h2 id="Go语言的诞生背景"><a href="#Go语言的诞生背景" class="headerlink" title="Go语言的诞生背景"></a>Go语言的诞生背景</h2><p>Go语言的诞生主要基于如下原因：</p>
<p>（1）摩尔定律接近失效后多核服务器已经成为主流，当前的编程语言对并发的支持不是很好，不能很好地发挥多核CPU的威力。</p>
<p>（2）程序规模越来越大，编译速度越来越慢，如何快速地编译程序是程序员的迫切需求。</p>
<p>（3）现有的编程语言设计越来越复杂，由于历史的包袱，某些特性的实现不怎么优雅，程序员花费了更多的精力来应对编程语法细节而不是问题域。</p>
<p>Go语言就是为了解决当下编程语言对并发支持不友好、编译速度慢、编程复杂这三个问题而诞生的。</p>
<h2 id="语言特性"><a href="#语言特性" class="headerlink" title="语言特性"></a>语言特性</h2><p>编程语言有几百种，语法形式千差万别，将这些语法进行抽象概括，剔除表现形式的差异，就形成了一个个表达语义的语言特性，有些语言特性是某个语言独有的，但绝大部分语言特征是很多语言共有的。总的语言特性就几十种，下面归纳一下常用的高级语言的语言特性。</p>
<p><strong>语言组织</strong></p>
<p>所有的高级语言都使用源代码来表达程序，程序的语法格式千差万别，但表达这些语法的基本概念大同小异，主要包括：</p>
<ul>
<li>标识符和关键字；</li>
<li>变量和常量；</li>
<li>运算符；</li>
<li>表达式；</li>
<li>简单语句；</li>
<li>控制结构。</li>
</ul>
<p><strong>类型系统</strong></p>
<p>每种高级语言都有自己的类型系统，类型系统的特性主要表现在以下几个方面。</p>
<ul>
<li>动静特性：动态语言还是静态语言。</li>
<li>类型强弱：强类型还是弱类型。</li>
<li>基本数据类型：包括类型及其支持的运算和操作集合。</li>
<li>自定义数据类型：包括类型及其支持的运算和操作集合。</li>
</ul>
<p><strong>抽象特性</strong></p>
<ul>
<li>函数：是否支持函数、匿名函数、高阶函数、闭包等。</li>
<li>面向对象：是否支持面向对象。</li>
<li>多态：如何支持多态。</li>
<li>接口：是否支持接口，以及接口实现模式。</li>
</ul>
<p><strong>元编程特性</strong></p>
<ul>
<li>泛型：是否支持泛型。</li>
<li>反射：是否支持反射，反射的能力。</li>
</ul>
<p><strong>运行和跨平台语言特性</strong></p>
<ul>
<li>编译模式：是编译成可执行程序，还是编译成中间代码，还是解释器解释执行。 </li>
<li>运行模式：直接由OS加载运行，还是由虚拟机加载执行。</li>
<li>内存管理：是否支持垃圾回收。</li>
<li>并发支持：是否原生支持并发，还是库支持。</li>
<li>交叉编译：是否支持交叉编译。</li>
<li>跨平台支持：是否支持多个平台。</li>
</ul>
<p><strong>语言软实力特性</strong></p>
<ul>
<li>库：标准库和第三方库是否丰富、好用、高效。</li>
<li>框架：是否有非常出众的框架。</li>
<li>语言自身兼容性：语言规范是否经常变换，语言新版本向前兼容性。</li>
<li>语言影响力：是否有商业公司支持，社区的活跃性，是否是著名项目。</li>
</ul>
<h2 id="Go语言的特性"><a href="#Go语言的特性" class="headerlink" title="Go语言的特性"></a>Go语言的特性</h2><p>介绍了那么多通用的语言特性，下面通过对比来介绍Go语言的语言特性，如表1-1所示。</p>
<blockquote>
<p>表1-1 语言特性对比</p>
</blockquote>
<img src="/2021/08/07/第1章-基础知识/t-1-1.png">
<img src="/2021/08/07/第1章-基础知识/t-1-2.png">
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>如何学习新知识？从大脑的角度来说快速学习新知识的办法是将其与已经掌握的旧知识进行对比，大脑将新知识链接到旧知识里面，最终形成一个知识体系。单纯的知识是不能解决问题的，只有将知识转化为技能，技能才能真正地解决问题。那什么又是技能呢？所谓技能就是把已掌握的知识抽象成解决问题的认知模型，这些认知模型能够指导我们解决某个领域和相似领域的问题。</p>
<p>同理，编程语言的学习也可以归纳为两个过程：一是要尽量利用已经掌握的编程语言，将新语言和已掌握语言的语法进行对比，梳理出相同点和不同点，建立知识间的连接，从而快速掌握新语言的语法知识；二是在语言特性上对比新旧语言，新语言一般只是语法新，大多数语言的语言特性都大同小异，语言特性具有通用性，语言特性决定着语言的表现力和编程范式，把握新语言的语言特性也是快速学习新语言的一条捷径。希望这些经验能为读者接下来学习Go语言提供一个好的思路和方向。</p>
<h1 id="初识Go程序"><a href="#初识Go程序" class="headerlink" title="初识Go程序"></a>初识Go程序</h1><p><strong>第一个Go程序</strong></p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"Hello, world.你好，世界！\n"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>程序功能解读</strong></p>
<ul>
<li>第1行定义一个包，包名为main，main是可执行程序的包名，所有的Go源程序文件头部必须有一个包声明语句，Go通过包来管理命名空间。</li>
<li>第3行import引用一个外部包fmt，可以是标准库的包，也可以是第三方或自定义的包，fmt是标准输入/输出包。</li>
<li>第5行使用func关键字声明定义一个函数，函数名为main，main代表Go程序入口函数。</li>
<li>第6行调用fmt包里面的Printf函数，函数实参是一个字符串字面量，在标准输出里面打印一句话“Hello, world.你好，世界！”，\n是一个转义符，表示换行。</li>
</ul>
<p><strong>Go源代码的特征解读</strong></p>
<ul>
<li>源程序以.go为后缀。</li>
<li>源程序默认为UTF-8编码。</li>
<li>标识符区分大小写。</li>
<li>语句结尾的分号可以省略。</li>
<li>函数以func开头，函数体开头的“{”必须在函数头所在行尾部，不能单独起一行。</li>
<li>字符串字面量使用“”””（双引号）括起来。</li>
<li>调用包里面的方法通过点“.”访问符，比如示例中的fmt.Printf。</li>
<li>main函数所在的包名必须是main。</li>
</ul>
<p><strong>编译运行</strong></p>
<p>Go语言的编程环境的相关内容参考8.1节。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 编译</span><br><span class="line">go build hello.go</span><br><span class="line"></span><br><span class="line">// 运行</span><br><span class="line">./hello</span><br><span class="line">Hello, world.你好，世界！</span><br></pre></td></tr></table></figure>
<p>本节从一个简单的“Hello, world”程序出发，介绍Go语言源程序的基本结构和特征，使读者先对Go源程序有一个整体的印象，接下来会逐步对Go语言展开介绍。</p>
<h1 id="Go词法单元"><a href="#Go词法单元" class="headerlink" title="Go词法单元"></a>Go词法单元</h1><p>在介绍Go语言具体语法之前，先介绍一下现代高级语言的源程序内部的几个概念：token、关键字、标识符、操作符、分隔符和字面量。这些概念在很多编程书籍里面只是一提而过，但是笔者认为这些基本的概念是通用的，不是某种编程语言特有的，这种语言层面通用的概念非常重要，这些概念能够帮助程序员更好地掌握语言的语法结构。笔者尝试使用通俗的语言对其逐个介绍。</p>
<h2 id="token"><a href="#token" class="headerlink" title="token"></a>token</h2><p>token是构成源程序的基本不可再分割的单元。编译器编译源程序的第一步就是将源程序分割为一个个独立的token，这个过程就是词法分析。Go语言的token可以分为关键字、标识符、操作符、分隔符和字面常量等，分类如图1-1所示。</p>
<blockquote>
<p>图1-1 Token分类</p>
</blockquote>
<img src="/2021/08/07/第1章-基础知识/1.png">
<p>Go语言里面的token是怎么分割的呢？Go的token分隔符有两类：一类是操作符，还有一类自身没有特殊含义，仅用来分隔其他token，被称为纯分隔符。<br>。操作符操作符就是一个天然的分隔符，同时其自身也是一个token，语句如下所示。<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sum:=a+b</span><br></pre></td></tr></table></figure></p>
<p>“:=”和“+”既是分隔符，也是token，所以这个简单的语句被分割为5个token：“sum”“=”“a”“+”、“b”，Go语言操作符的相关详细内容会融合到后面各章中，这里读者有一个大体的印象即可。</p>
<p>。纯分隔符：其本身不具备任何语法含义，只作为其他token的分割功能。包括空格、制表符、换行符和回车符，多个相邻的空格或者制表符会被编译器看作分隔符处理，比如如下语句：<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span></span><br><span class="line">mair</span><br></pre></td></tr></table></figure></p>
<p>这是一个包声明的语句，package和main之间可以有任意多个空格或者制表符，Go编译器会将其作为一个分隔符处理，最后分离出来两个token： package和main。</p>
<p>分离token的分隔符已做了介绍，下面逐个介绍每一类token，在介绍每一类token之前，先来介绍“标识符”。大部分的编程书籍对标识符一提而过，标识符被认为理所当然的存在，但是笔者不这么认为，标识符是源代码中重要的概念，本节将花些笔墨来介绍标识符。</p>
<h2 id="标识符"><a href="#标识符" class="headerlink" title="标识符"></a>标识符</h2><p>编程语言的标识符用来标识变量、类型、常量等语法对象的符号名称，其在语法分析时作为一个token存在。编程语言的标识符总体上分为两类：一类是语言设计者预留的标识符，一类是编程者可以自定义的标识符。前者一般由语言设计者确定，包括语言的预声明标识符及用于后续语言扩展的保留字；后者是用户在编程过程中自行定义的变量名、常量名、函数名等一切符合语言规范的标识符。有一点需要注意，用户自定义的标识符不应该使用语言设计者的预留标识符，这可能导致歧义，并严重影响代码的可读性。</p>
<p>Go的标识符构成规则是：开头一个字符必须是字母或下画线，后面跟任意多个字符、数字或下画线，并且区分大小写，Unicode字符也可以作为标识符的构成，但是一般不推荐这么使用。我们在定义新的标识符时要避开Go语言预声明标识符，以免引起混乱。</p>
<p>Go语言预声明的标识符包括关键字、内置数据类型标识符、常量值标识符、内置函数和空白标识符。在写Go源程序的过程中，用户自定义标识符用在包名、函数名、自定义类型名、变量名和常量名等上，后续的章节会详细介绍。</p>
<p>下面逐个介绍Go语言的预声明标识符。</p>
<p>关键字（keywords）</p>
<p>编程语言里面的关键字是指语言设计者保留的有特定语法含义的标识符，这些关键字有自己独特的用途和语法含义，它们一般用来控制程序结构，每个关键字都代表不同语义的语法糖。Go语言是一门极简的语言，只有如下25个关键字：<br>break<br>case chan const<br>continue<br>default<br>defer<br>else<br>fallthrough for<br>func<br>go<br>goto<br>if<br>import<br>interface map<br>package range<br>return<br>select struct switch<br>type<br>var<br>这25个关键字按照功能又可以分为三个部分，具体如下。</p>
<p>引导程序整体结构的8个关键字</p>
<p>声明复合数据结构的4个关键字</p>
<p>struct<br>interface map<br>chan<br>//定义结构类型关键字//定义接口类型关键字<br>//声明或创建map类型关键字//声明或创建通道类型关键字</p>
<p>这4个关键字会在自定义数据类型里面介绍。</p>
<p>。控制程序结构的13个关键字<br>if else<br>//if else语句关键字<br>for range break continue<br>//for循环使用的关键字<br>switch select type case default fallthrough//switch和select语句使用的关键字goto<br>//goto跳转语句关键字<br>这13个关键字会在1.7节控制结构中介绍。</p>
<p>关键字是一种预声明标识符，编程者不应该再声明和关键字相同的标识符。读者对Go关键字先有一个整体的印象，在学习完后续章节后，再来整体地看一下这些关键字，相信会有一种掌握全局的感觉。</p>
<p>内置数据类型标识符（20个）</p>
<p>丰富的内置类型支持是高级语言的基本特性，基本类型也是构造用户自定义类型的基础。为了标识每种内置数据类型，Go定义了一套预声明标识符，这些标识符用在变量或常量声明时。Go语言内置了20个预声明数据类型标识符。</p>
<p>Go是一种强类型静态编译型语言，在定义变量和常量时需要显式地指出数据类型，当然Go也支持自动类型推导，在声明初始化内置类型变量时，Go可以自动地进行类型推导。但是在定义新类型或函数时，必须显式地带上类型标识符。读者先对Go内置的基本类型有一个整体了解即可，在后续章节中还会有详细的介绍。</p>
<p>内置函数（15个）</p>
<p>make new len cap append copy delete panic recover close complex real image Print Printin</p>
<p>内置函数也是高级语言的一种语法糖，由于其是语言内置的，不需要用import引入，内置函数具有全局可见性。注意到其都是以小写字母开头的，但是并不影响其全局可用性。后续的章节会详细介绍每一个内置函数。</p>
<p>常量值标识符（4个）<br>true false //true和false表示bool类型的两常量值：真和假iota<br>//用在连续的枚举类型的声明中<br>nil<br>//指针/引用型的变量的默认值就是nil<br>Go的常量值标识符代表的是一个常量值，这个常量值表达特殊的含义，不好使用常量字面量直接表述时，就使用一个预先声明的标识符代替。<br>空白标识符（1个）<br>空白标识符有特殊的含义，用来声明一个匿名的变量，该变量在赋值表达式的左端，空白标识符引用通常被用作占位，比如忽略函数多个返回值中的一个和强制编译器做类型检查（在接口章节中会有介绍）。</p>
<p>标识符小结</p>
<p>Go语言共有65个预声明标识符，包括25个关键字（keywords）和40个其他预声明标识符。40个其他预声明标识符包括20个内置数据类型标识符、4个常量值标识符、1个空白标识符、15个内置函数，如图1-2所示。</p>
<h2 id="操作符（operators）和分隔符（delimiters）"><a href="#操作符（operators）和分隔符（delimiters）" class="headerlink" title="操作符（operators）和分隔符（delimiters）"></a>操作符（operators）和分隔符（delimiters）</h2><p>操作符就是语言所使用的符号集合，包括运算符、显式的分隔符，以及其他语法辅助符号。操作符不但自身是一个token，具备语法含义，同时其自身也是分隔其他token的分隔符。另外还有一类分隔符本身没有什么含义，仅仅起到分隔token的功能，这里纯粹的分隔符有4个：空格、制表符、回车和换行。<br>Go语言一共使用了47个操作符：</p>
<p>分隔符可以细分为如下几类。<br>。算术运算符（5个）<br>算术计算顺序是按照优先级从左到右进行的，当然也可以使用括号来改变操作数的结合顺序。<br>-★/号<br>。位运算符（6个）<br>位运算符用于整数的位运算操作。<br>&amp;|^&amp;^&gt;&gt;&lt;&lt;<br>。赋值和赋值复核运算符（13个）<br>/==&amp;= |=A=&amp;^=&gt;&gt;=<br>比较运算符（6个）</p>
<blockquote>
<blockquote>
<p>=&lt;&lt;=<br>括号（6个）<br>(){}[]<br>逻辑运算符（3个）</p>
</blockquote>
</blockquote>
<p>&amp;&amp;|!<br>。自增自减操作符（2个） 十十<br>注意：Go语言里面自增、自减操作符是语句而不是表达式。其他运算符（6个）<br>1.3.4字面常量<br>编程语言源程序中表示固定值的符号叫作字面常量，简称字面量。一般使用裸字符序列来表示不同类型的值。字面量可以被编程语言编译器直接转换为某个类型的值。Go的字面量可以出现在两个地方：一是用于常量和变量的初始化，二是用在表达式里或作为函数调用实参。变量初始化语句中如果没有显式地指定变量类型，则Go编译器会结合字面量的值自动进行类型推断。Go中的字面量只能表达基本类型的值，Go不支持用户定义的字面量。<br>字面量有如下几类。<br>整型字面量（Integerliterals）<br>整型字面量使用特定字符序列来表示具体的整型数值（具体的字符序列构成规则见官方的Go语言规范），常用于整型变量或常量的初始化。示例如下：<br>42<br>0600<br>0xBadFace<br>170141183460469231731687303715884105727<br>。浮点型字面量（Floating-point literals）<br>浮点型字面量使用特定字符序列来表示一个浮点数值（具体的字符序列构成规则见Go语言规范）。它支持两种格式：一种是标准的数学记录法，比如0.1；另一种是科学计数法的表示，比如1E6。示例如下：</p>
<p>复数类型字面量（Imaginary literals）<br>复数类型字面量使用特定的字符序列来表示复数类型的常量值（具体的字符序列构成规则见Go语言规范）。示例如下：<br>0i<br>011i//-=11i 0.i<br>2.71828i<br>1.e+0i<br>6.67428e-11i 1E6i<br>.25i<br>.12345E+5i<br>，字符型字面量（Runeliterals）<br>Go的源码采用的是UTF-8的编码方式，UTF-8的字符占用的字节数可以有1~4个字节，Rune字符常量也有多种表现形式，但是使用“”（单引号）将其括住。示例如下：<br>‘a’<br>‘a ‘<br>‘本1<br>‘\t’<br>‘\000’<br>‘\007’<br>‘\377<br>‘\x07’<br>‘\xff’<br>‘\u12e4’<br>‘\U00101234’<br>。字符串字面量（Stringliterals）<br>字符串字面量的基本表现形式就是使用“””将字符序列包括在内，双引号里面可以是</p>
<p>UTF-8的字符字面量，也可以是其编码值。<br>I\n”<br>\1I1<br>“Hello, world!\n” “中国人”<br>// same as‘“<br>1.3.5<br>总结<br>本节对Go语言的所有类型的token（关键字、标识符、操作符、分隔符、常量、字面量）和分隔符梳理了一遍。这些token帮助读者对Go源程序的构成有了一个全面的认识。同时，细心的读者应该能够发现，不同类型的token的命名不会冲突。换句话说，一个token不会出现既被识别为“标识符”，又被识别为“字面量”的歧义，这也是语言设计者必须保证的，保证每个token被无歧义地识别。了解整个token的知识，阅读源码也很容易，依据不同类型的token构成规则识别token的类型，现在再来看一下hello.go的源程序，从token的构成的角度分析源程序。<br>1 package main<br>2<br>3 import “fmt”<br>4<br>5 func main(){<br>6fmt.Printf（”Hello，world.你好，世界！\n”） 7}<br>根据前面讲述的分隔符和标识符的概念，很容易将源代码拆分为如下的token。。关键字<br>package import func<br>，标识符<br>main fmt Printf<br>，字面量<br>“fmt” “Hello，world.你好，世界！\n”两个，操作符：<br>(){}</p>
<p>注意：本书不是介绍编译原理的书籍，却花很大一段篇幅介绍token的概念，原因是token的概念在实际写程序的过程中很有用，它能够帮程序员从一个通用、抽象的角度看待高级编程语言源代码，这些知识不单单在学习Go语言时有用，在学习其他高级语言时一样有用。<br>现在总结Go的源程序基本构成：<br>（1）关键字引导程序的基本结构。<br>（2）内置类型标识符辅助声明变量和常量。<br>（3）字面量辅助变量和常量的初始化。<br>（4）分隔符帮助Go编译器识别各个token。<br>（5）操作符和变量、关键字一起构成丰富的语法单元。<br>通过对上面概念的学习，把Go源程序的每个token梳理了一遍，读者对Go源程序的基本结构也有了了解，在写程序时，一个基本的Go源程序框架就浮现出来了：<br>package XXXX<br>import(<br>“xxxx” “xxxx”<br>)<br>func xxx(){<br>1<br>随着后续章节的介绍，这个源程序的框架会逐步完善，从程序整体框架到具体语法知识的学习模式，可以帮助学习者建立整体和局部的概念，避免学习过程中“只见树木，不见森林”。<br>1.4变量和常量<br>高级语言通过一个标识符来绑定一块特定的内存，后续对特定的内存的操作都可以使用该标识符来代替。这类绑定某个存储单元的标识符又可以分为两类，一类称之为“变量”，一类称之为“常量”。顾名思义，变量表示指向的内存可以被修改，常量表示指向的内存不能被修改。<br>把对地址的操作和引用变为对变量的操作是编程领域的巨大进步。它一方面简化了程序的</p>
<p>编写，记住标识符比记住某个地址更容易，另一方面极大地提升了程序的可读性。<br>1.4.1变量<br>变量：使用一个名称来绑定一块内存地址，该内存地址中存放的数据类型由定义变量时指定的类型决定，该内存地址里面存放的内容可以改变<br>Go的基本类型变量声明有两种（复核类型变量的初始化比较特殊，后续章节会详细介绍）。 1.显式的完整声明<br>var varName dataType [ = value]<br>说明<br>。关键字var用于变量声明。<br>varName是变量名标识符。<br>dataType是1.3节介绍的基本类型。<br>value是变量的初始值，初始值可以是字面量，也可以是其他变量名，还可以是一个表达式；如果不指定初始值，则Go默认将该变量初始化为类型的零值。<br>Go的变量声明后就会立即为其分配空间。<br>vara int- 1 var a int = 2*3 var a int =b<br>2.短类型声明<br>varName := value<br>：=声明只能出现在函数内（包括在方法内）。 ，此时Go编译器自动进行数据类型推断。<br>Go支持多个类型变量同时声明并赋值。例如：<br>a ,b := 1,”hello”<br>变量具有如下几个属性。<br>，变量名<br>Go中使用1.3节介绍的自定义标识符来声明一个变量，在1.3节中讲解了标识符的相关观</p>
<p>念和命名规则。<br>。变量值<br>变量实际指向的是地址里存放的值，变量的值具体怎么解析是由变量的类型来决定的。在初始化变量值时，我们可以使用字面量，也可以使用其他的变量名。<br>，变量存储和生存期<br>Go语言提供自动内存管理，通常程序员不需要特别关注变量的生存期和存放位置。编译器使用栈逃逸技术能够自动为变量分配空间：可能在栈上，也可能在堆上。<br>，类型信息<br>类型决定了该变量存储的值怎么解析，以及支持哪些操作和运算，不同类型的变量支持的操作和运算集是不一样的。<br>，可见性和作用域<br>Go内部使用统一的命名空间对变量进行管理，每个变量都有一个唯一的名字，包名是这个名字的前缀。8.2节对命名空间和作用域有详细的介绍。<br>1.4.2<br>常量<br>常量使用一个名称来绑定一块内存地址，该内存地址中存放的数据类型由定义常量时指定的类型决定，而且该内存地址里面存放的内容不可以改变。Go中常量分为布尔型、字符串型和数值型常量。常量存储在程序的只读段里（.rodata section）。<br>预声明标识符iota用在常量声明中，其初始值为0。一组多个常量同时声明时其值逐行增加，iota可以看作自增的枚举变量，专门用来初始化常量。</p>
<h1 id="基本数据类型"><a href="#基本数据类型" class="headerlink" title="基本数据类型"></a>基本数据类型</h1><p>Go是一种强类型的静态编译语言，类型是高级语言的基础，有了类型，高级语言才能对不同类型抽象出不同的运算，编程者才能在更高的抽象层次上操纵数据，而不用关注具体存储和运算细节。<br>Go语言内置七类基本数据类型（20个具体子类型）。<br>布尔类型：bool<br>整型：byteintint8int16init32 int64 uint uint8 uint16 uint32 uint64 uintptr浮点型：float32 float64<br>复数：complex64complex128<br>字符：rune<br>字符串：string<br>20<br>|Go语言核心编程<br>错误类型：error</p>
<h2 id="布尔类型"><a href="#布尔类型" class="headerlink" title="布尔类型"></a>布尔类型</h2><p>布尔类型关键字是bool，布尔类型只有两个值：true和fasle，true和false是Go内置的两个预声明标识符。<br>var ok bool ok = true<br>或<br>ok := false<br>布尔型数据和整型数据不能进行相互转换。<br>var a bool<br>a = 1 //error1是整型字面量<br>比较表达式和逻辑表达式的结果都是布尔类型数据。var b bool = (x&gt;y)&amp;&amp; (x&gt;0)<br>if和for语句的条件部分一定是布尔类型的值或表达式。</p>
<p>声明的布尔型变量如不指定初始化值，则默认为false。var b bool // b is false<br>第1章基础知识|21</p>
<h2 id="整型"><a href="#整型" class="headerlink" title="整型"></a>整型</h2><p>Go语言内置了12种整数类型，分别是byte、int、int8、intl6、init32、int64、uint、uint8.uint16、uint32、uint64、uintptr。其中byte是uint8的别名，不同类型的整型必须进行强制类型转换。<br>var a int = 1<br>var b int32=2<br>b = a // error<br>整型支持算术运算和位操作，算术表达式和位操作表达式的结果还是整型。<br>var a int = (l+2)*3 var b int = 1000&gt;&gt;2</p>
<h2 id="浮点型"><a href="#浮点型" class="headerlink" title="浮点型"></a>浮点型</h2><p>浮点型用于表示包含小数点的数据，Go语言内置两种浮点数类型，分别是float32和float64。浮点数有两个注意事项：<br>（1）浮点数字面量被自动类型推断为float64类型。<br>varb := 10.00<br>（2）计算机很难进行浮点数的精确表示和存储，因此两个浮点数之间不应该使用==或！= 进行比较操作，高精度科学计算应该使用math标准库。</p>
<h2 id="复数类型"><a href="#复数类型" class="headerlink" title="复数类型"></a>复数类型</h2><p>Go语言内置的复数类型有两种，分别是complex64和complex128，复数在计算机里面使用两个浮点数表示，一个表示实部，一个表示虚部。complex64是由两个float32构成的，complex128是由两个float64构成的。复数的字面量表示和数学表示法一样。</p>
<h2 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h2><p>Go语言将字符串作为一种原生的基本数据类型，字符串的初始化可以使用字符串字面量。 例如：<br>var a = “hello, world”<br>（1）字符串是常量，可以通过类似数组的索引访问其字节单元，但是不能修改某个字节的值。例如：<br>var a = “hello, world” b:=a[0]<br>a[1]=’a’ //error<br>（2）字符串转换为切片【】byte（s）要慎用，尤其是当数据量较大时（每转换一次都需复制内容）。例如：<br>a := “hello, world!”<br>b :=[]byte(a)<br>（3）字符串尾部不包含NULL字符，这一点和C/C++不一样。<br>（4）字符串类型底层实现是一个二元的数据结构，一个是指针指向字节数组的起点，另一个是长度。例如：<br>// runtime/string.go<br>209 type stringStruct struct{ 210<br>str unsafe. Pointer<br>211<br>lenint<br>212}<br>//指向底层字节数组的指针//字节数组长度<br>（5）基于字符串创建的切片和原字符串指向相同的底层字符数组，一样不能修改，对字符串的切片操作返回的子串仍然是string，而非slice。例如：<br>a := “hello,world!”</p>
<p>a:=a1:4<br>（6）字符串和切片的转换：字符串可以转换为字节数组，也可以转换为Unicode的字数组。 例如：<br>a ：= “hello，世界！” b :=[]byte(a)<br>C:=[]rune(a)<br>（7）字符串的运算。例如：<br>a := “hello” b:m “world”<br>c ;=a+b len(a)<br>//字符串的拼接<br>//内置的len函数获取字符串长度<br>d：=”hello，世界！”<br>for i：=0；i《len（d）；i++{//遍历字节数组fmt. Println(d[i])<br>}<br>for i, v := range d{<br>fmt. Println(i,v) ]<br>//遍历rune数组</p>
<h2 id="rune类型"><a href="#rune类型" class="headerlink" title="rune类型"></a>rune类型</h2><p>Go内置两种字符类型：一种是byte的字节类类型（byte是uint的别名），另一种是表示Unicode编码的字符rune。rune在Go内部是int32类型的别名，占用4个字节。Go语言默认的字符编码就是UTF-8类型的，如果需要特殊的编码转换，则使用Unicode/UTF-8标准包。</p>
<h1 id="复合数据类型"><a href="#复合数据类型" class="headerlink" title="复合数据类型"></a>复合数据类型</h1><p>顾名思义，复合数据类型就是由其他类型组合而成的类型。Go语言基本的复合数据类型有指针、数组、切片、字典（map）、通道、结构和接口，它们的字面量格式如下：<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">* pointerType          <span class="comment">// 指针类型使用*后面跟其指向的类型名</span></span><br><span class="line">[n] elementType        <span class="comment">// 数组类型使用[n]后面跟数组元素类型来表示，n表示该数组的长度</span></span><br><span class="line">[] elementType         <span class="comment">// 切片类型使用[]后面跟切片元素类型来表示</span></span><br><span class="line"><span class="keyword">map</span> [keyType]valueType <span class="comment">// map类型使用map[键类型]值类型来表示</span></span><br><span class="line"><span class="keyword">chan</span> valueType         <span class="comment">// 通道使用chan后面跟通道元素类型来表示</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> &#123; <span class="comment">// 结构类型使用struct&#123;&#125;将各个结构字段扩起来表示</span></span><br><span class="line">    field fieldType</span><br><span class="line">    field fieldType</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> &#123; <span class="comment">// 接口类型使用interface&#123;&#125;将各个方法括起来表示</span></span><br><span class="line">    method1 (inputParams)(returnParams)</span><br><span class="line">    method2 (inputParams)(returnParams)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>本节讨论的复合类型属于字面量类型，有关字面量类型的相关知识在第3章类型系统中会详细介绍。</p>
<h2 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h2><p>Go语言支持指针，指针的声明类型为*T，Go同样支持多级指针**T。通过在变量名前加&amp;来获取变量的地址。指针的特点如下。<br>（1）在赋值语句中，*T出现在“=”左边表示指针声明，*T出现在“=”右边表示取指针指向的值（varName为变量名）。示例如下：<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">11</span></span><br><span class="line">p:=&amp;a <span class="comment">//*p和a的值都是11</span></span><br></pre></td></tr></table></figure></p>
<p>如：<br>（2）结构体指针访问结构体字段仍然使用“”点操作符，Go语言没有“》”操作符。例</p>
<p>（3）Go不支持指针的运算。<br>Go由于支持垃圾回收，如果支持指针运算，则会给垃圾回收的实现带来很多不便，在C 和C++里面指针运算很容易出现问题，因此Go直接在语言层面禁止指针运算。例如<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a:= <span class="number">1234</span></span><br><span class="line">p:=&amp;a</span><br><span class="line">p++<span class="comment">//不允许，报non-numeric type *int错误</span></span><br></pre></td></tr></table></figure></p>
<p>（4）函数中允许返回局部变量的地址。<br>Go编译器使用“栈逃逸”机制将这种局部变量的空间分配在堆上。例如：<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sum</span> <span class="params">(a ,b <span class="keyword">int</span>)</span><span class="title">nt</span></span>&#123;</span><br><span class="line">sum :=a+b</span><br><span class="line"><span class="keyword">return</span> &amp;sum</span><br><span class="line"><span class="comment">//允许，sum会分配在heap上</span></span><br></pre></td></tr></table></figure></p>
<h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><p>数组的类型名是【n】elemetType，其中n是数组长度，elementType是数组元素类型。比如一个包含2个int类型元素的数组类型可表示为【2】int。数组一般在创建时通过字面量初始化，单独声明一个数组类型变量而不进行初始化是没有意义的。</p>
<p>数组的特点<br>（1）数组创建完长度就固定了，不可以再追加元素。<br>（2）数组是值类型的，数组赋值或作为函数参数都是值拷贝。<br>（3）数组长度是数组类型的组成部分，【10】int和【20】int表示不同的类型。 （4）可以根据数组创建切片（见1.6.3节切片）。<br>数组相关操作<br>（1）数组元素访问。示例如下：<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a:=[...]<span class="keyword">int</span>&#123;<span class="number">1</span>，<span class="number">2</span>，<span class="number">3</span>&#125; b:=a[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i, v := <span class="keyword">range</span> a &#123;</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>
<p>（2）数组长度。示例如下：<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a:=[...]<span class="keyword">int</span>&#123;<span class="number">1</span>，<span class="number">2</span>，<span class="number">3</span>&#125; alengh :=<span class="built_in">len</span>(a)</span><br><span class="line"><span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;alengh;i++&#123; &#125;</span><br><span class="line"><span class="number">1.6</span><span class="number">.3</span></span><br></pre></td></tr></table></figure></p>
<h2 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h2><p>Go语言的数组的定长性和值拷贝限制了其使用场景，Go提供了另一种数据类型slice（中文为切片），这是一种变长数组，其数据结构中有指向数组的指针，所以是一种引用类型。例如：</p>
<p>15}<br>Go为切片维护三个元素一一指向底层数组的指针、切片的元素数量和底层数组的容量。具体结构如图1-3所示。</p>
<blockquote>
<p>图1-3 切片的结构</p>
</blockquote>
<p>（1）切片的创建。<br>。由数组创建<br>创建语法如下：array【b：e】，其中，array表示数组名；b表示开始索引，可以不指定，默认是0；e表示结束索引，可以不指定，默认是len（array）。array【b：e】表示创建一个包含e-b个元素的切片，第一个元素是array【b】，最后一个元素是array【e-1】。例如：<br>var array = 【…】int{0，1，2，3，4，5，6}//创建有7个int型元素的数组s1 := array[0:4]<br>s2 := array[:4]<br>s3 := array[2:]<br>fmt. Printf(“&amp;v\n”, s1)// [01 23]<br>fmt. Printf(“v\n”, s2)//[0123]<br>fmt. Printf(“&amp;v\n”, s3)// [23 4 5 6]<br>，通过内置函数make创建切片<br>注意由make创建的切片各元素被默认初始化为切片元素类型的零值。例如：<br>//len=10,cap=10<br>a := make([]int，10)<br>//len=10,cap=15<br>b := make([]int，10，15)</p>
<p>这里要注意：直接声明切片类型变量是没有意义的。例如：<br>var a []int<br>fmt.Printf（”v\n”，a）//结果为【】<br>此时切片a的底层的数据结构如图1-4所示。<br>array=nil<br>len=0<br>cap=0<br>图1-4切片a的底层的数据结构<br>（2）切片支持的操作。<br>。内置函数1en（）返回切片长度。<br>。内置函数cap（返回切片底层数组容量。<br>，内置函数append（）对切片追加元素。<br>。内置函数copy（）用于复制一个切片。<br>示例如下：</p>
<p>（3）字符串和切片的相关转换。例如：<br>str ：=”hello，世界！”<br>//通过字符串字面量初始化一个字符串str<br>a := []byte(str)<br>//将字符串转换为【】byte类型切片<br>b:=[]rune(str)<br>//将字符串转换为【】rune类型切片</p>
<h2 id="map"><a href="#map" class="headerlink" title="map"></a>map</h2><p>Go语言内置的字典类型叫map。map的类型格式是：map【K】T，其中K可以是任意可以进行比较的类型，T是值类型。map也是一种引用类型。<br>（1）map的创建。<br>。使用字面量创建。例如：<br>ma := map[string]int{“a”:1,”b”:2}<br>fmt. Println (ma[“a”])<br>fmt. Println(ma[“b”])<br>使用内置的make函数创建。例如：</p>
<p>（2） map支持的操作。<br>.map的单个键值访问格式为mapName【key】，更新某个key的值时mapName【key】放到等号左边，访问某个key的值时mapName【key】放在等号的右边。<br>，可以使用range遍历一个map类型变量，但是不保证每次迭代元素的顺序。<br>。删除map中的某个键值，使用如下语法：delete（mapName，key）。delete是内置函数，用来删除map中的某个键值对。<br>。可以使用内置的len（）函数返回map中的键值对数量。例如：<br>mp := make(map[int]string)<br>mp [1] = “tom”<br>mp [1] = “pony”<br>mp [2] = “jaky”<br>mp [3] = “andes”<br>delete(mp，3)<br>fmt. Println(mp[1])<br>fmt.Println（len（mp））//len函数返回map中的键值对的数量<br>for k，v ：=range mp{//range支持遍历mp，但不保证每次遍历次序是一样的fmt . Println (“key=”, k, “value=”, v)<br>]<br>注意<br>Go内置的map不是并发安全的，并发安全的map可以使用标准包sync中的map。。不要直接修改map value内某个元素的值，如果想修改map的某个键值，则必须整体赋值。例如：</p>
<h2 id="struct"><a href="#struct" class="headerlink" title="struct"></a>struct</h2><p>Go中的struct类型和C类似，中文翻译为结构，由多个不同类型元素组合而成。这里面有两层含义：第一，struct结构中的类型可以是任意类型；第二，struct的存储空间是连续的，其字段按照声明时的顺序存放（注意字段之间有对齐要求）。<br>struct有两种形式：一种是struct类型字面量，另一种是使用type声明的自定义struct类型。 （1） struct类型字面量。<br>struct类型字面量的声明格式如下：<br>struct{<br>FeildName FeildType FeildName FeildType FeildName FeildType<br>（2）自定义struct类型。<br>自定义struct类型声明格式如下：<br>type TypeName struct {<br>FeildName FeildType FeildName FeildType FeildName FeildType<br>实际使用struct字面量的场景不多，更多的时候是通过type自定义一个新的类型来实现的。type是自定义类型的关键字，不但支持struct类型的创建，还支持任意其他子定义类型的创建。</p>
<p>在第3章类型系统中会有详细的介绍。<br>（3） struct类型变量的初始化。示例如下：<br><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">Name <span class="keyword">string</span> Ageint</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</span><br><span class="line">*Person</span><br><span class="line">Numberint</span><br><span class="line">]</span><br><span class="line"><span class="comment">//按照类型声明顺序，逐个赋值</span></span><br><span class="line"><span class="comment">//不推荐这种初始化方式，一旦struct增加字段，则整个初始化语句会报错a := Person&#123;"Tom", 21&#125;</span></span><br><span class="line"><span class="comment">//推荐这种使用Feild名字的初始化方式，没有指定的字段则默认初始化为类型的零值p:=&amp;Person&#123;</span></span><br><span class="line">Name: <span class="string">"tata"</span>,</span><br><span class="line">Age:<span class="number">12</span>，</span><br><span class="line">&#125;</span><br><span class="line">s:= Student&#123;</span><br><span class="line">Person:Pi Number:<span class="number">110</span>，</span><br></pre></td></tr></table></figure></p>
<p>本节只简单介绍结构的基本概念和初始化方式，关于自定义数据类型及其方法在第3章类型系统中有详细介绍。</p>
<h2 id="其他复合类型"><a href="#其他复合类型" class="headerlink" title="其他复合类型"></a>其他复合类型</h2><p>接口（Interface）在第4章中介绍，通道（chan）在第5章中介绍。</p>
<h1 id="控制结构"><a href="#控制结构" class="headerlink" title="控制结构"></a>控制结构</h1><p>现代计算机存储结构无论“普林斯顿结构”，还是“哈佛结构”，程序指令都是线性地存放在存储器上。程序执行从本质上来说就是两种模式：顺序和跳转。</p>
<p>顺序就是按照程序指令在存储器上的存放顺序逐条执行。<br>。跳转就是遇到跳转指令就跳转到某处继续线性执行。<br>Go是一门高级语言，其源程序虽然经过了高度的抽象并封装了很多语法糖，但还是跳不出这个模式（这里暂时不考虑goroutine引入并发后的执行视图变化）。<br>顺序在Go里面体现在从main函数开始逐条向下执行，就像我们的程序源代码顺序一样；跳转在Go里面体现为多个语法糖，包括goto语句和函数调用、分支（if、switch、select）、循环（for）等。跳转分为两种：一种是无条件跳转，比如函数调用和goto语句；一种是有条件的跳转，比如分支和循环。<br>顺序语句很简单，就是我们天然写程序的从前往后的顺序，本节主要介绍Go语言的控制结构。<br>备注：<br>Go的源代码的顺序并不一定是编译后最终可执行程序的指令顺序，这里面涉及语言的运行时和包的加载过程。上面论述的主要目的是使读者从宏观上整体理解程序的执行过程，建立一个从源代码到执行体的大体映射概念，这个概念不那么精准，但对我们理解源程序到目标程序的构建非常有帮助。</p>
<h2 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a>if语句</h2><p>特点<br>.if后面的条件判断子句不需要用小括号括起来。<br>{必须放在行尾，和if或ifelse放在一行。<br>if后面可以带一个简单的初始化语句，并以分号分割，该简单语句声明的变量的作用域是整个if语句块，包括后面的else if和else分支。<br>Go语言没有条件运算符（a》b？a：b），这也符合Go的设计哲学，只提供一种方法做事情。<br>，if分支语句遇到return后直接返回，遇到break则跳过break下方的if语句块。<br>简单示例<br>if x&lt;=y{<br>return y }else{<br>returnx</p>
<p>一个完整的if else语句示例：<br>ifx：=f（）；x《y{//初始化语句中的声明变量x returnx<br>}else if x》z{//x在elseif里面一样可以被访问returnz<br>}else{<br>return y<br>最佳实践<br>。尽量减少条件语句的复杂度，如果条件语句太多、太复杂，则建议放到函数里面封装起来。<br>。尽量减少if语句的嵌套层次，通过重构让代码变得扁平，便于阅读。<br>下面这段代码：<br>if err,file := os.Open(“xxxx”;err == nil{ defer file.close()<br>//do something<br>}else{<br>return nil, err<br>1<br>改写后的代码：<br>err,file := os.Open(“xxxx”) if err!= nil{<br>return nil, err<br>]<br>defer file.Close()<br>//do something</p>
<h2 id="switch语句"><a href="#switch语句" class="headerlink" title="switch语句"></a>switch语句</h2><p>switch语句会根据传入的参数检测并执行符合条件的分支。 switch的语法特点如下：</p>
<p>switch和if语句一样，switch后面可以带一个可选的简单的初始化语句。<br>switch后面的表达式也是可选的，如果没有表达式，则case子句是一个布尔表达式，而不是一个值，此时就相当于多重ifelse语句。<br>.switch条件表达式的值不像C语言那样必须限制为整数，可以是任意支持相等比较运算的类型变量。<br>通过fallthough语句来强制执行下一个case子句（不再判断下一个case子句的条件是否满足）。<br>switch支持default语句，当所有的case分支都不符合时，执行default语句，并且default 语句可以放到任意位置，并不影响switch的判断逻辑。<br>switch和.（type）结合可以进行类型的查询，这个放到4.2节介绍。</p>
<p>imt.printf(‘graae=ac\n, graae) //graae-B<br>select是一种类似switch语法结构的分支语句，select放到第5.1节介绍。</p>
<h2 id="for语句"><a href="#for语句" class="headerlink" title="for语句"></a>for语句</h2><p>Go语言仅支持一种循环语句，即for语句，同样遵循Go的设计哲学，只提供一种方法做事情，把事情做好。<br>Go对应C循环的三种场景如下。<br>。类似C里面的for循环语句<br>for init; condition; post { }<br>。类似C里面的while循环语句<br>for condition {}<br>。类似C里面的while（1l）死循环语句<br>for{}<br>for还有一种用法，是对数组、切片、字符串、map和通道的访问，语法格式如下： 1/问</p>
<h2 id="标签和跳转"><a href="#标签和跳转" class="headerlink" title="标签和跳转"></a>标签和跳转</h2><p>标签<br>Go语言使用标签（Lable）来标识一个语句的位置，用于goto、break、 continue语句的跳转，标签的语法是：<br>Lable: Statement<br>标签的具体作用和使用见下面的goto、break、 continue.<br>goto<br>goto语句用于函数的内部的跳转，需要配合标签一起使用，具体的格式如下：<br>goto Lable<br>goto Lable的语义是跳转到标签名后的语句处执行，goto语句有以下几个特点： goto语句只能在函数内跳转。<br>goto语句不能跳过内部变量声明语句，这些变量在goto语句的标签语句处又是可见的。 例如：<br>gotoL//BAD，跳过v：=3这条语句是不允许的<br>V:=3<br>L:<br>goto语句只能跳到同级作用域或者上层作用域内，不能跳到内部作用域内。例如：</p>
<p>break<br>break用于函数内跳出for、switch、select语句的执行，有两种使用格式：<br>。单独使用，用于跳出break当前所在的for、switch、select语句的执行。<br>。和标签一起使用，用于跳出标签所标识的for、switch、select语句的执行，可用于跳出多重循环，但标签和break必须在同一个函数内。例如：<br>L1:<br>for i := 0;;i++{<br>for j :=0;;j++{<br>ifi &gt;= 5{<br>//跳出L1标签所在的for循环<br>break L1<br>}<br>if j&gt; 10{<br>//默认仅跳出离break最近的内层循环break<br>}<br>continue<br>continue用于跳出for循环的本次迭代，跳到for循环的下一次迭代的post语句处执行，也有两种使用格式：<br>。单独使用，用于跳出continue当前所在的for循环的本次迭代。<br>。和标签一起使用，用于跳出标签所标识的for语句的本次迭代，但标签和continue必须在同一个函数内。例如：</p>
<p>return和函数调用<br>return语句也能引发控制流程的跳转，用于函数和方法的退出。函数和方法的调用也能引发程序控制流的跳转，这些在后续章节中会详细介绍。</p>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Go语言核心编程/" rel="tag"># Go语言核心编程</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2021/07/18/第4章-复合数据类型/" rel="next" title="第4章 复合数据类型">
                <i class="fa fa-chevron-left"></i> 第4章 复合数据类型
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2021/08/10/第2章-函数/" rel="prev" title="第2章 函数">
                第2章 函数 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="CheBin">
            
              <p class="site-author-name" itemprop="name">CheBin</p>
              <div class="site-description motion-element" itemprop="description">看视频才能学会，看文字学不会的</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">1140</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">27</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">79</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          

          
          


          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <!-- modify icon to fire by szw -->
                <i class="fa fa-history fa-" aria-hidden="true"></i>
                近期文章
              </div>
              <ul class="links-of-blogroll-list">
                
                
                  <li>
                    <a href="/2023/07/19/zero-admin-3/" title="zero-admin-3" target="_blank">zero-admin-3</a>
                  </li>
                
                  <li>
                    <a href="/2023/07/19/zero-admin-2/" title="zero-admin-2" target="_blank">zero-admin-2</a>
                  </li>
                
                  <li>
                    <a href="/2023/07/19/zero-admin-1/" title="zero-admin-1" target="_blank">zero-admin-1</a>
                  </li>
                
                  <li>
                    <a href="/2023/07/19/Day7-服务发现与注册中心/" title="Day7 服务发现与注册中心" target="_blank">Day7 服务发现与注册中心</a>
                  </li>
                
                  <li>
                    <a href="/2023/07/19/Day6-负载均衡/" title="Day6 负载均衡" target="_blank">Day6 负载均衡</a>
                  </li>
                
              </ul>
            </div>
        

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#语言简介"><span class="nav-number">1.</span> <span class="nav-text">语言简介</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Go语言的诞生背景"><span class="nav-number">1.1.</span> <span class="nav-text">Go语言的诞生背景</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#语言特性"><span class="nav-number">1.2.</span> <span class="nav-text">语言特性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Go语言的特性"><span class="nav-number">1.3.</span> <span class="nav-text">Go语言的特性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结"><span class="nav-number">1.4.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#初识Go程序"><span class="nav-number">2.</span> <span class="nav-text">初识Go程序</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Go词法单元"><span class="nav-number">3.</span> <span class="nav-text">Go词法单元</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#token"><span class="nav-number">3.1.</span> <span class="nav-text">token</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#标识符"><span class="nav-number">3.2.</span> <span class="nav-text">标识符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#操作符（operators）和分隔符（delimiters）"><span class="nav-number">3.3.</span> <span class="nav-text">操作符（operators）和分隔符（delimiters）</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#基本数据类型"><span class="nav-number">4.</span> <span class="nav-text">基本数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#布尔类型"><span class="nav-number">4.1.</span> <span class="nav-text">布尔类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#整型"><span class="nav-number">4.2.</span> <span class="nav-text">整型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#浮点型"><span class="nav-number">4.3.</span> <span class="nav-text">浮点型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#复数类型"><span class="nav-number">4.4.</span> <span class="nav-text">复数类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#字符串"><span class="nav-number">4.5.</span> <span class="nav-text">字符串</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rune类型"><span class="nav-number">4.6.</span> <span class="nav-text">rune类型</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#复合数据类型"><span class="nav-number">5.</span> <span class="nav-text">复合数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#指针"><span class="nav-number">5.1.</span> <span class="nav-text">指针</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数组"><span class="nav-number">5.2.</span> <span class="nav-text">数组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#切片"><span class="nav-number">5.3.</span> <span class="nav-text">切片</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#map"><span class="nav-number">5.4.</span> <span class="nav-text">map</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#struct"><span class="nav-number">5.5.</span> <span class="nav-text">struct</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#其他复合类型"><span class="nav-number">5.6.</span> <span class="nav-text">其他复合类型</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#控制结构"><span class="nav-number">6.</span> <span class="nav-text">控制结构</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#if语句"><span class="nav-number">6.1.</span> <span class="nav-text">if语句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#switch语句"><span class="nav-number">6.2.</span> <span class="nav-text">switch语句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#for语句"><span class="nav-number">6.3.</span> <span class="nav-text">for语句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#标签和跳转"><span class="nav-number">6.4.</span> <span class="nav-text">标签和跳转</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2023</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CheBin</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">站点总字数：</span>
    
    <span title="站点总字数">8.9m</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    
    <span title="站点阅读时长">135:21</span>
  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a></div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.1"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.1"></script>



  
  <script src="/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  

  

  


  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  

  
  

  


  

  

  

  

  

  

  

  

  
<script>
  $('.highlight').each(function(i, e) {
    var $wrap = $('<div>').addClass('highlight-wrap');
    $(e).after($wrap);
    $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function(e) {
      var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
        return $(e).text();
      }).toArray().join('\n');
      var ta = document.createElement('textarea');
      var yPosition = window.pageYOffset || document.documentElement.scrollTop;
      ta.style.top = yPosition + 'px'; // Prevent page scroll
      ta.style.position = 'absolute';
      ta.style.opacity = '0';
      ta.readOnly = true;
      ta.value = code;
      document.body.appendChild(ta);
      ta.select();
      ta.setSelectionRange(0, code.length);
      ta.readOnly = false;
      var result = document.execCommand('copy');
      
        if (result) $(this).text('复制成功');
        else $(this).text('复制失败');
      
      ta.blur(); // For iOS
      $(this).blur();
    })).on('mouseleave', function(e) {
      var $b = $(this).find('.copy-btn');
      setTimeout(function() {
        $b.text('复制');
      }, 300);
    }).append(e);
  })
</script>


  

  

</body>
</html>
