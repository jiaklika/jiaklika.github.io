<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2">





















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">
<meta name="keywords" content="通向财务自由之路">
<meta property="og:type" content="article">
<meta property="og:title" content="第14章 确定头寸规模：实现目标的关键">
<meta property="og:url" content="http://yoursite.com/2021/08/02/第14章-确定头寸规模：实现目标的关键/index.html">
<meta property="og:site_name" content="车斌的技术博客">
<meta property="og:description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2021-11-05T07:47:46.737Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第14章 确定头寸规模：实现目标的关键">
<meta name="twitter:description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">






  <link rel="canonical" href="http://yoursite.com/2021/08/02/第14章-确定头寸规模：实现目标的关键/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>第14章 确定头寸规模：实现目标的关键 | 车斌的技术博客</title><meta name="robots" content="noindex">
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">车斌的技术博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">专注</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/08/02/第14章-确定头寸规模：实现目标的关键/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CheBin">
      <meta itemprop="description" content="先得寸，再进尺">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="车斌的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">第14章 确定头寸规模：实现目标的关键

              
            
          </h1>
        

        <div class="post-meta">

          

          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2021-08-02 09:42:56" itemprop="dateCreated datePublished" datetime="2021-08-02T09:42:56+08:00">2021-08-02</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2021-11-05 15:47:46" itemprop="dateModified" datetime="2021-11-05T15:47:46+08:00">2021-11-05</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/期货/" itemprop="url" rel="index"><span itemprop="name">期货</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">21k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">19 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>思考并回答以下问题：</p>
<ul>
<li>总结一下，这章作者最主要想表达什么观点？</li>
</ul>
<a id="more"></a>
<p>当我获得30%的利润时，我拿走1/3；当我获得50%的利润时，我拿走另外一个1/3，反过来，我将拿走所有剩下的利润。——引自一次股票交易研讨会上有关资产管理的演讲</p>
<p>系统开发最为重要的方面，除了心理因素以外，就是在给定的头寸投资多少。然而，绝大多数讨论交易或系统开发的书籍都完全忽视了这一问题，即使确实谈到了这一话题，也通常将其称之为资产管理或资产配置。然而大多数情况下，这两个术语在使用的时候，往往是指别的，而不是“多少”的问题。这就等于告诉我们，大多数“专家”真的不明白在市场中取得成功要具备的最为重要的方面。</p>
<p>看一下本章开始时的引言。在一次培训经纪人的股票交易研讨会上，这位教练作了题为“资产管理”的演讲，他告诉我这段话就是他进行资产管理的原则。然而，在我看来，他所说的和资产管理没有任何关系，这些都是有关市场退出的问题（像在市场退出一章所分析的，它甚至都不是一个好的退出法则，因为你在一个完全的头寸上承担亏损，而只在一部分头寸上获取最高利润。）。后来，在研讨会结束之后，我去问他，他所说的资产管理是什么意思。他的回答是：“你提的问题很好，我认为资产管理指的就是一个人如何做出交易决策。”资产组合经理往往谈到“资产配置”对他们的成功是非常重要的。现在你可以想一想资产配置这个词的意思。它对你意味着什么？你可能会认为，它指的就是如何将资产在各种资产类别中进行选择。对大多数资产组合经理来说，就是这意思，因为按照章程的要求，它必须进行充分投资（至少是95%）。因此，他们认为资产配置就是进行资产分类选择的决策。这是你的理解吗？</p>
<p>布林森和他的同事们将资产配置定义为一个人将其资本的多少投资于股票、债券或现金。当这样定义资产配置时，他们发现是资产配置而不是买什么的决策，导致了10年期间82个养老金计划的业绩表现相差91.5%。因此，资产组合经理和学术界开始强调资产配置的重要性。尽管布林森和他的同事们发现股票选择和其他类型的决策对业绩并不是很重要，但是彩票倾向依然造成很多人继续认为资产配置就意味着挑选正确的资产类别。然而，重要的是“多少”的决策，而不是投资选择的决策。</p>
<p>再次强调，以下任何一个方面在有关资产管理或资产配置中都是不重要的：</p>
<ul>
<li>系统中告诉你在给定的交易中你将亏损多少的部分；</li>
<li>如何退出一笔盈利的交易；</li>
<li>投资多元化；</li>
<li>风险控制；</li>
<li>风险回避；</li>
<li>系统中告诉你投资什么的环节。</li>
</ul>
<p>相反，有关资产管理或资产配置重要的是，在整个交易过程中，你的交易系统中用以回答“多少”这个问题的那一部分。“多少”的问题从本质上意味着在整个交易过程中，在给定的时间你应该持有多大的头寸。此外，它还是决定你作为交易商，能否实现目标的关键因素。为了避免任何混淆，我在本书自始至终一直称之为“头寸规模确定”。</p>
<p>在回答“多少”这个问题的过程中，你可能必须考虑上面提到的一些问题，但这些问题都不是你进行头寸规模确定的法则。对有些人来说，诸如风险控制这样的因素，看起来也许比确定多少的问题还要重要（进行头寸规模确定最好的方法之一是利用百分比风险法则，比如在给定的头寸承担总资本1%的风险，这样头寸规模确定就确实控制了全部的风险。不过，你可以使用和风险没有什么关系的法则来进行头寸规模确定。），但是“多少”的问题导致了各种职业交易商在业绩表现方面的大部分区别。</p>
<p>1997年，我代表道·琼斯在遍及亚洲的主要城市向数以百计的职业交易商做头寸规模确定和心理因素的演讲。我表演了一个游戏来解释头寸规模确定的重要性，就是把玻璃球从一个袋子里随机取出再放回的取球游戏，这里的玻璃球代表一个交易系统的R乘数。其中，有7个玻璃球代表亏损1R的交易，1个玻璃球代表亏损5R的交易，2个玻璃球代表盈利10R的交易。这个游戏尽管在80%的时间里是亏损的，但是它的期望收益是0.8R。我给每位观众10万美元的游戏资本，并告诉他们，在40次交易中可以在每次取玻璃球时去承担他们认为合适的风险。换句话说就是，他们得到的都是相同的交易，从袋子中随机取出的是相同的玻璃球。然而，在游戏结束时，每位观众手中最后的资本是不同的，这些资本小到破产大到100万美元以上（在40笔交易中实现了10倍的增值）。这就证实了布林森和他的同事们的观察结果，即“多少”这一因素造成了90%以上的业绩差异，因为在这个游戏中只涉及“多少”和参加者的个人心理因素。而且我对这些结果重复了几百次。</p>
<p>我的演示通常能让观众信服，确定头寸规模是很重要的。然而，当我向亚洲的交易商建议，有效地进行头寸规模确定的合理的方法是将头寸大小建立在他们的资本基础之上时，我发现这些职业交易商中没有一位知道自己在交易多少钱。他们只是在交易“公司的”钱，不知道它有多少。因此，我问他们， “那么，你要亏多少钱才会丢掉工作呢？”将头寸规模确定建立在会导致丢掉工作的亏损金额之上也是一个合理的方法，但是我发现，在这些职业交易商观众中，只有大约10%的人知道他们要亏损多少钱就会丢掉工作。这就意味着，数以千计的职业交易商没有任何方法来进行头寸规模确定，然而，他们每个人也许都在交易着数百万美元的资金，而且我在一个城市接着一个城市，一次演讲接着一次演讲之后观察到的结果都是一样的。</p>
<p>大概在3年前，我在世界各地为那些套期保值基金经理和资产组合经理做类化的演讲。我发现他们大多数，至少是那些资产组合经理，或者原先是资产组合经理后来进入了套期保值基金的那些人，以前没有接受过有关头寸规模确定的培训。事际上，他们很多人认为确定头寸规模不是一个重要的因素，因为他们认为在市场中至少要达到90%的投资率。</p>
<p>如果你想在市场中获得成功，确定头寸规模和你的个人心理是必须掌握的两个关键的因素，然而，还是让我来强调一下华尔街、主街或学术界对这一点强调得是多么不够。</p>
<ul>
<li>如果你被培训为任何一家大的经纪公司的经纪人，你将不会得到有关头寸规模确定或者进行市场交易的心理方面的任何培训。你的主要培训是有关股票交易所的规章制度，公司可以提供的产品类别以及如何把这些产品类别卖给顾客或者潜在的顾客。例如，你必须通过系列考试，以取得执业经纪人资格，但是考试的内容没有一点和头寸规模确定或者交易的心理有关。</li>
<li>如果成为了注册金融策划师（CFP），你还是不会接受任何有关个人心理或者头寸规模确定方面的培训。</li>
</ul>
<p>要注意的是，最后两种交易商是被公众视为市场中的专家的人，这些人正是人们寻求建议的渠道，因此，你还能向谁寻求建议呢？</p>
<ul>
<li>如果从一所名牌大学里获得有关市场运作专业的MBA，你不会受到有关头寸规模确定方面的培训，只会接触到有关交易心理的很少的培训。</li>
<li>如果从一所名牌大学获得金融专业的博士，你还是不会受到头寸规模确定方面的任何培训。你可能会受到一些行为金融方面的培训，但是就是这一点，也和你的个人心理因素对交易结果的影响没有多大关系。</li>
<li>如果成为了一名注册金融分析师（CFA），你也不会受到任何有关头寸规模确定或者你的个人心理因素对交易业绩影响方面的培训。大多数分析师甚至不知道如何进行市场交易，因为培训旨在帮助他们搞明白一个公司在将来是否会做得很好。</li>
<li>如果你被培训为一家银行或一家大公司的职业交易商，结果是一样的。是的，你可以猜得出来：你不会受到有关头寸规模确定方面的任何培训，也很少得到有关个人心理对你在市场中的成功的影响方面的建议。实际上，正像我前面提到的一样，大多数交易商甚至不知道他们赔掉多少钱才会失去工作。</li>
</ul>
<p>因此，大多数有关投资的书籍以及从媒体中看到的几乎所有有关成功投资的报道都忽视头寸规模确定和个人心理的关键话题就不足为怪了。</p>
<p>你已经知道了头寸规模确定如何造成职业交易商业绩方面的主要差异了，但是假如你还是不相信，那么让我来对头寸规模确定进行逻辑分析。还记得第7章所描述的打雪仗的模型吗？从这个比喻中我们知道头寸规模确定模型包括两个因素：初始保护的大小（雪墙的大小或者说初始资本）和一次向雪墙扔过来的雪球的数量（一次拥有多少头寸）。</p>
<p>图14-1解释了在确定可获得的总金额时，头寸规模确定如何成为你必须考虑的另外一步。回顾一下，图13-2描述了把机会因素加入期望收益的一个三维的箱体。图14-1表明头寸规模确定必须作为第四维因素加进去——市场中同时存在的多个头寸这一维。画出四维的图形相当困难，因此图14-1只是通过向你展示在一个时间点上会有很多三维的箱体影响你的头寸来解释头寸规模确定的效果。期望收益带来的是一个二维的正方形，机会因素带来的是一个三维的立方体或是箱体，而头寸规模确定带来的是很多箱体一起涌向你。这就是头寸规模确定的重要性。</p>
<blockquote>
<p>图14-1 头寸规模确定具有在同一时间将很多同时发生的三维箱体加总的影响</p>
</blockquote>

<p>如果你还不相信头寸规模确定的重要性，让我们再来看看其对一个人的交易业绩重要性的解释。还记得第2章介绍的拉尔夫·文斯的研究吗？在他的研究中，40位博士玩一个期望收益为正的头寸规模确定的游戏，其中95%的人赔了钱。为什么？原因在于他们的心理以及低水平的头寸规模确定。</p>
<p>假如你一共有1000美元，以承担100美元的风险来开始这个游戏。实际上，你连续做了三次这一游戏，结果三次都输了——在这样的游戏里，这是非常可能的。现在你就剩下700美元了，你就想：我已经连续输了三次，因此，现在真到我该赢的时候了。这就是赔徒的谬论；你赢的机会依然只有60%。不过，你还是决定下300美元的赌注，因为你非常确信你会顧。然而，你又输了，只剩下400美元。现在，你在这个游戏中赚钱的机会已经很小了，因为即使是达到盈亏平衡，你都必须赚到150%。尽管在一个赢的概率为60%的游戏中，连续4次都输掉的可能性是很小的，只有0.0256，但是，在100次的试验中，它还是几乎确定无疑地至少要发生一次。</p>
<p>还有一种玩法会使得这些博士最后破产。假如他们一开始就下250美元的赌注，连续输掉了三次，共计750美元，现在就只有250美元了。现在，他们仅仅是为了恢复盈亏平衡，就必须实现300%的盈利，也许还没做到这一点就破产了。</p>
<p>在以上两种情形下，在这个很简单的游戏中之所以没能赚到钱，是因为他们冒了太大的风险。之所以会过度冒险，源于心理的原因—贪婪、不理解概率的概念以及在有些情况下甚至是失败的渴望。不过，从数学的角度来说，亏损之所以发生，是因为他们冒了太大的风险。例如，如果10个黑雪球加起来比雪墙还大，它们同时向雪墙扔来，那么雪墙就会坍塌。无论白雪球相对于黑雪球的比例占多大优势-10个加起来比雪墙还大的黑雪球将会毁掉雪墙。</p>
<p>你的资本的大小就相当于打雪仗比喻中雪墙的大小。比较普遍的现象是，一般人都拿着太少的资金就进入了最具有投机性的市场。5万美元以下的账户是很小的，但是一般的账户只有1000～10000美元之间。结果，很多人因为账户金额太小而在头寸规模确定方面表现较差。就因为太小的账户规模，其失败的数学概率是非常高的。</p>
<p>见表14-1，注意，在各种规模的亏损之后，你的账户要恢复多少才能实现盈亏平衡。例如，亏损20%只需要一个稍微大一点的收益（不会大于25%）就可以恢复平衡，但是亏损40%需要66.7%的收益才能恢复平衡，而亏损50%则需要100%的收益，而亏损50%以上则需要巨大的、完全不可能的收益才能恢复平衡。因此，在冒了太大的风险输了以后，你恢复盈亏平衡的可能性是非常小的。</p>
<blockquote>
<p>表14-1 亏损后的恢复</p>
</blockquote>

<h1 id="基本的头寸规模确定策略"><a href="#基本的头寸规模确定策略" class="headerlink" title="基本的头寸规模确定策略"></a><span style="color:#339AFF;">基本的头寸规模确定策略</span></h1><p>职业赌徒很长时间以来声称有两种基本的头寸规模确定策略-输后加倍下注和赢后加倍下注。输后加倍下注的策略是指在亏损之后（连续输掉期间）增加赌注规模的策略。而赢后加倍下注的赌法则相反，是在连续赢的期间或在资本增加时，增加赌注规模的策略。</p>
<p>如果你玩过轮盘赌或者掷骰子赌博游戏，肯定采用过纯粹形式的输后加倍下注的策略，即在你输了以后把赌注翻一倍。比如，如果输了1美元，你就赌2美元；如果输了这2美元，那么就再赌4美元；如果输了这4美元，就再赌8美元。当你最后赢了时（最终你总会赢的），你所得到的就会远远大于最初所下的赔注。</p>
<p>卡西诺赌场当然喜欢玩这种输后加倍下注的策略。首先，任何机会游戏都会出现连续输的可能，而在赢的概率小于50%时，出现连续输的可能就非常大。假如你连续输了10次。开始下的赌注为1美元，那么在连续输了10次之后，一共就输掉2047美元。为了赢回最初的1美元，你现在要下赌注2048美元。因此，到此时赢与输的比例——小于50：50的赌博中——只有1：4095了。为了实现1美元的利润，你要冒4000美元以上的风险。然而，更糟的是，因为有些人可能没有资金问题，所以卡西诺赌场就有了赌注的限制。在一个赌桌上，如果允许最小的赌注为1美元，你下的赌注就不能超过100美元。因此，输后加倍下注的策略一般就行不通了——无论是在卡西诺赌场上还是在市场上。</p>
<p>在连续输掉期间，如果你的风险还在继续增大，最终将会有一大笔亏损会令你走向破产的境地。即使你的资金是没有限制的，最终也会遭受人类心理上无法承受的一种回报——风险的策略。</p>
<p>而在连续获胜时要求承担更大风险的赢后加倍下注的策略则是行得通的-无论是在赌场还是在投资领域。精明的赌徒在获胜时，懂得在一定的限度内增加赌注，对交易或投资来说是同样的道理。有效的头寸规模确定要求你在赚钱时增加头寸。对赌博是这样，对交易和投资也是同样的道理。</p>
<p>头寸规模确定告诉你，在给定账户规模时，你要增加多少个单位（股票或期货合约）的投资。例如，头寸规模确定的决策可能是，你在任何头寸上没有足够的钱来增加投资，因为你的分配方案对账户来说太大了。它让你通过结合资产组合来确定你在给定的交易上将分配多少个单位的方式来确定你的回报及风险的特点。它还有助于你把资产组合中的各交易要素等同起来。最后，某些头寸规模确定模型还将所有市场1R的风险等同起来。</p>
<p>有些人认为他们有“资产管理止损”，所以在头寸规模确定方面做了非常充分的工作。这样的止损就是，在亏损了一个预定的限额如1000美元时，你就会退出头寸。然而，这样的止损并没有告诉你“多少”的问题，因此它实际上和头寸规模确定毫无关系。通过确定在被截住时所亏损的金额来控制风险和通过一个用来确定你在每一个头寸上应持有多少或者你是否还有能力持有一个头寸的头寸规模确定模型来控制风险是不同的。</p>
<p>你可以采用的头寸规模确定策略有很多。在本章接下来的部分，你可以了解到效果很好的各种不同的头寸规模确定策略。其中有一些可能会比其他一些更适合你的交易或投资风格。有些在股票账户上运作效果极好，而有些是为期货账户设计的。它们都是赢后加倍下注的策略，因为它们都是建立在资本的基础上的。之所以是赢后加倍下注的策略，是因为它们用来确定“多少”的法则在你的账户规模扩大时，你的头寸规模也在增加。但是要记住的是，很多在银行和各个公司工作的职业交易商甚至不知道他们要赔掉多少钱就有丢掉工作的危险，更不用说知道他们在交易多少资金了。</p>
<p>关于头寸规模确定的内容有些复杂。不过，我还是避免使用比较难的数学表达，对每一个策略都给出比较清楚的例子。因此，你只需要认真阅读这些内容，反复阅读直到你彻底理解为止。</p>
<h1 id="采用的系统"><a href="#采用的系统" class="headerlink" title="采用的系统"></a><span style="color:#339AFF;">采用的系统</span></h1><p>在展示所有这些策略的结果时，我决定采用一个单一的交易系统：在相同的时间里，交易相同的商品。这个系统是一个55天的管道突破系统，也就是说，在市场出现一个55天的历史新高时，就按照停价指令进入市场做多，而在市场出现一个55天历史新低时就进入市场做空。对于初始风险和获取利润来说，都是使用一个市场另一方向的21天的跟踪停价。</p>
<p>为了解释清楚，假如原油的价格打破了一个55天的新高，你就做多，直到市场出现一个21天的新低之前，你一直保留头寸。如果21天的新低出现得很快，那么你可能就会被截住，结果亏损1R，然而，如果价格上涨100天，结果又回落打破21天的最低点，那么你可能就会获得一笔可观的利润。反过来，如果市场出现了一个55天的最低点，你就做空，当市场出现一个21天的新高时，你就退出头寸。</p>
<p>每天都对这一20天的管道突破停价重新进行计算，而且也要总是向着对你有利的方向移动，以便降低风险或者增加利润。如果有充足的资金进行交易，这样的突破系统可以实现超过平均水平的利润。</p>
<p>对这一系统的检验是以100万美元的启动资本和10年期间包括一揽子10种商品进行的。本章所给出的所有期货数据都是基于对相同的时间里相同的商品进行检验的同样的55/21天的突破系统。表中的唯一不同在于所使用的头寸规模确定模型。然而，所选择的每一个系统和每一组数据对不同的模型都可能产生不同的结果。为了讨论分析的目的，我选择了这一系统，因为为了解释模型之间的差别，该系统比较容易程序化而且可以方便使用。</p>
<h1 id="模型1：每一固定金额资金交易一个单位"><a href="#模型1：每一固定金额资金交易一个单位" class="headerlink" title="模型1：每一固定金额资金交易一个单位"></a><span style="color:#339AFF;">模型1：每一固定金额资金交易一个单位</span></h1><p>从本质上来说，这个方法是通过确定对账户中的每X美元的资金应该进行一个单位的交易的方式来回答“多少”这一问题的。例如，对总资本的每5万美元你可以交易一个单位（如100股股票或者一手合约）。</p>
<p>在着手交易或投资时，你也许因为本章前面所提及的一些原因而从未听说过有关头寸规模确定的观点。因此，像“我只能交易得起1个单位”这样的想法对你来说就是最富有逻辑性的想法了。如果你了解一些有关头寸规模确定的观点，你的知识也许是从某一本书上获得的，而书的作者对这一问题并没有很好地理解。大多数讨论资金管理或者资产配置的书都不是关于头寸规模确定的，相反，它们告诉你的是关于多元化或者让你的交易收益最大化的问题。有关系统开发或者技术分析的书甚至还没有开始恰当地讨论头寸规模确定的问题。结果，大多数交易商和投资者都根本无处学习其职业中最为重要的方面。</p>
<p>因此，带着这样的困惑，你开立了一个20000美元的账户，并且决定对得到交易信号的任何工具进行一手合约的交易（一个股票投资者可能就交易100股股票）。接着，如果你比较幸运，账户涨到了40000美元，你决定将交易量提高到2手合约（或200股股票）。注意，为了加大头寸，账户不得不翻一倍，因此，大多数确实进行某种形式的头寸规模确定的交易商都使用这一模型。它比较简单，而且直接告诉你多少。</p>
<p>这个方法有一个“优点”就是，你永远不会因为一笔交易过于冒险而拒绝它。举一个例子，它是我所认识的两位交易商的经历。其中有一位每5万美元的资本交易一手合约，另一位利用模型3，即百分比风险模型，他承担的风险还是比较大的，相当于资本的3%，但是如果一个头寸会承担超过其账户3%的风险，他就不会建立这一头寸。每一位交易商都根据各自的趋势跟踪系统发现了一次交易日元的机会。不论是什么都进行一手合约交易的那位交易商做了这笔交易。随后日元发生了刷烈的波动，因此该交易商能够获得他所经历的在一个月里最大的一次收益——20%的月收益。</p>
<p>相比之下，第二位交易商没能做成这笔交易。他的账户规模是100 000美元，但是如果交易对它是不利的，所涉及的风险就会超过他所设的3%的最高限，结果他没有做这笔交易，因此他在这个月里没有获利。</p>
<p>当然，总是进入交易的因素也会反过来起作用。如果日元交易的走势是不利的，第一位交易商就会承担巨额的（20%或者更多）亏损，而第二位交易商则可以避免。</p>
<p>表14-2给出了这一系统在利用第一个头寸模型时的结果。注意该系统在每20000美元的资本交易一笔合约时就失效了。在30000美元时，不得不忍受亏损80%，而如果想要避免亏损50%，你就必须有至少70 000美元的资本。如果你的目标就是要避免大额亏损，而且决定如果亏损大于20%就终止交易，结果会怎样呢？你对表中所显示的所有金额都会停止交易，并都以亏损告终。因此，它看起来不像是一个很好的模型，但是要真正评估这个头寸规模确定模型，还得将它与利用其他模型所得出的表进行比较（见表14-4和表14-6）（在这个55/21天的系统中所给出的数据向你展示的是10年的数据，因此看起来应该是相当可靠的。然而，该系统给你的是一系列的R乘数，即使你认为该系统所产生的交易样本充分代表了该系统的效果，它也只是代表了这一数据的重复。表示相同的R乘数的顺序有很多，其结果各不相同。再说，这一系统中也许有很多R乘数很大的亏损，只是你还没有看到。因此，我只能从本章所展示的各表中给出的数据得出非常粗略的结论。）。</p>
<blockquote>
<p>表14-2 每X美元的资本交易1手合约的55/21天的突破系统（启动资本为100万美元）</p>
</blockquote>

<p>尽管每一固定资金交易一个单位的头寸规模确定模型具有让你总是可以建立头寸的优点，但是我认为它是有局限的，因为不是所有的投资都是一样的，对小额资金你无法快速增加你的交易规模，而且你总是会建立头寸，即使当风险过高时。这种头寸规模确定方式是危险的！最后一点是，每一固定金额交易一个单位的模型对于小额账户来说，等于是最小的头寸规模确定。让我们来解释这些原因。</p>
<p>不是所有的投资都是一样的，而模型1却把它们看成是一样的。假如你是一位期货交易商，决定利用5万美元交易20种不同的商品。你基本的头寸规模确定策略就是，对这一资产组合中的任何一种商品在得到交易信号时就交易一手合约。假如你得到了债券和玉米的信号，因此，头寸规模确定策略告诉你，可以买一手玉米合约和一手债券合约。假如国库券的价格是112美元，而玉米的价格是3美元。</p>
<p>对于价格为112美元的国库券期货合约，你控制着相当于11.2万美元的产品。另外，此时每日的波动范围（波动幅度）大约是0.775，因此，如果市场在一个方向上的移动幅度达到每日波动范围的3倍，你就会赚到或者赔掉2 325美元。相比之下，对于玉米合约，你控制着相当于1.5万美元左右的产品，如果它向着对你有利或者不利的方向移动达到每日波动范围的3倍，你的收益或亏损大约只有550美元。因此，你的资产组合会发生什么，80%左右将取决于债券，而只有20%左右取决于玉米。显然，这一头寸规模确定模型和总的风险无关。</p>
<p>有人可能会争辩说，在过去，玉米波动性曾经很大，也很昂贵，这种情形还会再现的。但是你需要根据市场现在的情况来将你的机会多样化，现在，根据上面给出的数据，一份玉米合约对你账户的影响只相当于一份债券合约的大约20%。</p>
<p>模型1让你无法快速增加交易量。赢后加倍下注策略的目的就是在赢时增加赌注。当每5万美元进行一手合约的交易时，如果你只有5万美元，那么就必须首先将资本翻一番才能增加你的合约规模。因此，在遇上一连串的盈利交易时，它不是一个增加交易量的非常有效的方法。实际上，对于一个5万美元的账户而言，它几乎就没有头寸规模确定可言。</p>
<p>部分解决方案要求最小账户规模达到100万美元。如果账户金额达到了这一规模，那么从20手合约（每5万美元一手合约）升到21手，你的账户只需要增加5%就可以了。</p>
<p>在模型1中，你总是要建立头寸，即使在风险很高时也是如此。每X美元交易一个单位的模型使得你对任何标的都进行一个单位的交易。例如，你可能买一手标准普尔合约，利用1.5万美元的账户资金控制着价值12.5美元的股票（一手标准善尔合约每个点的价值为250美元，因此，如果标准普尔500指数的价值为1000点，那么合约价值就为25万美元。这个例子还假定经纪人允许你以如此小的账户交易该合约。）。假如标准普尔每日的波动幅度为10个点，而你采用一个3倍于每日波动幅度的停价，即30个点，潜在的亏损是7500美元，或者说是你的资本的一半。这仅针对一个头寸来讲风险是巨大的，但是你在采用每美元交易一个单位的头寸规模确定模型时就有可能承担这样的风险。</p>
<p>采用头寸规模确定策略的一个原因就是使得资产组合中各组成要素具有相同的机会和相同的风险。.你需要资产组合中各组成要素带来的赚钱的机会是相等的，否则，你为什么要交易那些不可能带来很多利润的部分呢？此外，你也需要在资产组合各组成要素之间平等地分散风险。</p>
<p>当然，假定资产组合各要素在进入每一笔交易时具有相等的机会和风险，它们获利的可能性是一样的。你可能会有某些办法来确定某些交易将比其他一些更有利可图。如果是这样，你就需要一个头寸规模确定计划来加大成功概率更高的交易的规模——也许是一个随意决定的头寸规模确定计划。不过，在本章接下来的部分，我将假定资产组合中所有的交易从一开始就具有相等的成功机会。这正是你为什么选择它的原因。</p>
<p>每一固定金额的资金交易一个单位的模型，在我看来，没有让你的机会或风险均等，但是大多数好的头寸规模确定方法确实能让资产组合各要素的机会或风险均等化。这些模型包括模型2——令资产组合各组成要素的价值相等；模型3——令资产组合各组成要素的风险相等（当为了保存资本而退出一个头寸时，你会亏损多少）和模型4——令资产组合各组成要素的波动幅度相等。模型3还具有1R对每个市场的意义相同的价值，尽管事实上你可以针对不同的头寸设定不同的风险水平。</p>
<h1 id="模型2：股票交易的等价值交易单位"><a href="#模型2：股票交易的等价值交易单位" class="headerlink" title="模型2：股票交易的等价值交易单位"></a><span style="color:#339AFF;">模型2：股票交易的等价值交易单位</span></h1><p>等价值交易单位模型通常用于股票或者其他没有杠杆功能或只有很小的杠杆效果的工具。该模型通过把资本分为5～10等份来确定“多少”的问题，每一等份就是告诉你可以买进多少产品。例如，对于50000美元的资金，可以把它分成5等份每份为10000美元。因此，你可以买进价值10000美元的投资产品A，买进价值10000美元的投资产品B，买进价值10000美元的投资产品C，等等。你也可以买进100股价格为每股100美元的股票，200股价格为每股50美元的股票，500股价格为每股20美元的股票，1000股价格为每股10美元的股票和1428股价格为每股7美元的股票。该策略涉及的头寸规模确定模型就是确定你将资产组合中的多少分配给在任何给定的时间都可以兑换成现金的部分。表14-3描述了这5种股票在其投资总额都为10000美元时可以分别买进多少股。</p>
<blockquote>
<p>表14-3 在等价值交易模型中的资金分配（每单位1万美元）</p>
</blockquote>

<p>注意这个头寸规模确定步骤有些不便之处。例如，股票的价格可能不一定正好能被10000美元整除——更不用说被100股为单位整除了。表中所示的股票E，就只能买进1 428股，总金额加起来还是不到10000美元。其实，在这个例子中，你可能想取整到最接近的100股为单位的倍数而买进1400股。</p>
<p>对于期货来说，等值单位模型可能被用来确定你想对每手合约控制多少价值。例如，对于50000美元的账户金额，你可能决定想控制每一种期货合约达250000美元。假如你随意地决定将其分成5个单位，每个单位为50000美元。</p>
<p>如果一份债券合约价值为112000美元，在该头寸规模确定标准下就无法买进任何债券，因为你将控制超过一个单位的投资产品，但是，你可以买进玉米，玉米是以5000蒲式耳为交易单位的，在每蒲式耳玉米的价格为3美元时，一手玉米合约的价值大约为15000美元。所以，50000美元的资金可以让你买进3手玉米合约，或者说价值45000美元。黄金在纽约是以每手合约100盎司为单位进行交易的，在每盎司的价格为490美元时，一手合约的价值就为49000美元。因此，在这个模型下你也可以交易一手黄金合约。</p>
<p>等值单位方法使得你赋予资产组合中各投资产品大致相等的权重。它还有一个好处，就是可以准确地知道你使用了多大的杠杆作用。例如，如果你在50000美元的账户上建立了五个头寸，每个价值50000美元，你就知道你投资了价值大约为250000美元的产品。此外，你还明白自己利用了5：1的杠杆功能，因为你用50000美元的资金控制着250000美元的投资。</p>
<p>在使用这一方法时，你必须决定打算使用多大的杠杆功能，然后再把它分成等份。这是非常有价值的信息，因此我建议所有的交易商都要记录其控制着的总的产品价值和杠杆比例。这些信息真的可以令人茅塞顿开。然而，杠杆作用并不必然等于移动的波动幅度或风险，因此这里要注意</p>
<p>等值单位方法也有一个缺点，因为在赚钱时，这个方法只能让你非常缓慢地增加“多少”。在账户金额较小的大多数情形下，为了增加1个单位的交易量，资本需要翻一番。因此，对小账户来说，实际上还是等于没有头寸规模确定。</p>
<p>有些职业股票交易商不仅利用等值模型来控制其初始头寸规模，还在整个交易过程中利用某种形式的等值模型，也就是说，他们主张应该定期对资产组合进行再平衡，以便所有的头寸继续保持均等的平衡。这就意味着你应该廉价出售盈利的产品（至少要达到再平衡你的股票的水平）以及增加亏损的产品。在我看来，这是在利用头寸规模确定以确保你不去遵守交易的黄金法则。从根本上来说，你是在利用该策略定期地削减盈利的交易，增加亏损的交易。本书前面评估的一些业务通讯采用的就是这种形式的头寸规模确定。此外，没有接受过头寸规模确定培训的很多共同基金资产组合经理也使用这一方法。</p>
<h1 id="模型3：百分比风险模型"><a href="#模型3：百分比风险模型" class="headerlink" title="模型3：百分比风险模型"></a><span style="color:#339AFF;">模型3：百分比风险模型</span></h1><p>当建立一个头寸时，为了保存资本，知道将在什么水平退出该头寸是至关重要的，这就是你的风险。这是你最坏情形下的亏损——除了价格差异和一个对你不利的失控的市场之外的情形。这就是我在本书自始至终称之为1R风险的概念。</p>
<p>最常见的头寸规模确定系统之一就涉及将头寸规模作为这一风险的函数来进行控制。来看一个该头寸规模确定模型如何发挥作用的例子。假如你想以每盎司380美元的价格买进黄金，系统建议，如果黄金的价格降到370美元时，你就需要退出头寸。因此，你最坏情形下每手黄金合约的风险就是10个点乘以每个点100美元，即1000美元。</p>
<p>你有5000美元的账户。你想将黄金头寸的总风险限制在该资本的2.5%，即1250美元以内。如果你用每手合约的风险1000美元去除你可以承担的总的风险1250美元，就会得到1.25手合约。因此，百分比风险头寸规模确定法则只允许你买进1手合约。</p>
<p>假如在同一天你得到了一个卖空玉米的交易信号。黄金的价格依然是每盎司380美元，因此对于这个未结清的头寸，你的账户依然是50000美元。玉米头寸允许承担的风险仍然是基于全部资本的1250美元。</p>
<p>假如玉米的价格为4.03美元，你决定可以接受的最大风险是允许玉米向着对你不利的方向移动5美分到4.08美元。你可以接受的5美分的风险（乘以每手合约5000蒲式耳）就相当于每手合约250美元的风险。如果用250美元去除1250美元，就会得到5手合约。因此，在百分比风险头寸规模确定模式下，你可以卖空5手玉米合约。</p>
<p>1，风险的CPR模型</p>
<p>有些人到这里就会感到困惑了。如果R是每股的风险，那么总的风险是什么呢？不是有时也称总的风险为R吗？对这一问题的回答是，在使用百分比风险模型来进行头寸规模确定时，每股的风险和总的风险具有同样的比率。因此，你可以利用总的初始风险和总的利润或亏损来确定R是多少。为了帮助你更好地理解，我把每单位的风险称为R，而把总的风险称为C即现金，并把头寸规模确定称为P，这些变量之间的关系很简单，我在交易商和投资者面前称之为CPR，假如你想以每股50美元的价格买入一只股票，而且决定在股票价格每股下跌2美元达到48美元时就抛出头寸，因此， R现在就是2美元。再假设，你现在利用的就是一个头寸规模确定的百分比风险模型，而且决定把总的风险控制在50 000美元资产组合的1%之内，即500美元。因此，总的风险（C）就是500美元。为了确定头寸规模，你可以使用以下的公式：</p>
<p>P （头寸规模） =C （现金） /R （每股的风险）</p>
<p>e我要感谢我的朋友Ron Ishibashi首先为交易商和投资商提出了CPR的交易思想</p>
<p>下面将该公式应用到例子中。我们不知道头寸规模，但是知道R-2美元以及C=500美元。因此，</p>
<p>P=500美元/2美元=250股</p>
<p>利用上面的头寸规模确定公式对模型1进行头寸规模确定的决策结果就是，可以买价格为50美元的股票250股。注意这样总的投资就将是12 500美元或者说是账户金额的25%。不过，每股的风险只有2美元，而总的风险只有500美元即账户金额的1%。</p>
<p>现在，假如股票上涨到了每股60美元，每股就有10美元的利润。因为初始风险只有2美元，因此总的收益就是其5倍即5R，我们也可以同样简单地把总的利润2500美元（10美元乘以250股）和总的初始风险500美元相比，还是可以看出获得了一个SR的利润。因此，总的风险和每股的风险都可以用来确定R乘数。</p>
<p>注意，这里5R的利润等于是5%的收益，因此，如果有一个系统在100次交易后平均带来80K的利润，那么，利用1%的风险模型就可以期望获得80%利润（或者因为综合的结果获得更高的利润）。</p>
<p>2，模型的比较</p>
<p>表14-4描述的是同一个55/21天的突破系统，其头寸规模确定法则是建立在风险作为资本的一定百分比的基础上的。起始资本还是100万美元。</p>
<p>注意，最高的回报一风险比率出现在每一头寸的风险大约为25%时，你为此必须要忍受资本会减少84%的代价。此外，在风险为10%时，开始出现了追加保证金（它是按照当前的比例设定的，从历史的角度来看是不准确的）。</p>
<blockquote>
<p>表14-4 在等价值模型中的资金分配（每1单位代表10000美元）</p>
</blockquote>
<p>如果用100万美元利用该系统进行交易，且采用1%的风险标准，那么赌注大小和采用10%的风险交易10万美元的账户是一样的。因此，表14-4建议你，除非你至少有10万美元，否则就不应该利用该系统进行交易，而且每笔交易所冒的风险也不应该超过大约0.5%。在风险为0.5%时，利用该系统的回报将是很低的。从根本上来说，你现在应该理解为什么在利用该系统交易10种商品时至少需要100万美元了。</p>
<p>在利用风险头寸规模确定法则时，你每个头寸应该接受多大的风险？在利用风险头寸规模确定法则时的总体风险取决于你的系统的优劣和你的目标。不过，一些普遍遵守的原则是：如果你在交易别人的钱，利用1%或更低的风险；如果在交易自己的钱，可以是0.5%-2.5%的风险，取决于你的目标和系统的优劣；如果你是在寻求巨额回报并且愿意承担较大可能的毁灭，可以利用2.5%以上的风险。</p>
<p>大多数股票交易商根本不会考虑使用一个百分比风险模型，他们往往会更多地从等值单位模型的角度进行考虑。再看一个股票交易的例子。</p>
<p>你想买IBM的股票，而账户中有50000美元。假如IBM股票的价格是每股141美元左右。你决定在价格为137美元，即每股下跌4美元时抛出该头寸。头寸规模确定策略告诉你应该把风险限制在2.5%以内，即1250美元。利用公式P=C/R，用每股4美元的风险去除总的风险1250美元，就会得到312.5股。<br>如果你在141美元的价位买进了312股，它要花掉43 392美元-超过了你账户总额的80%，同样要注意的是，你总的投资和初始风险无关。在不超过账户保证金价值的前提下，你只能这样做两次，这让你更好地理解了2.5%的风险的真正意义。实际上，如果你的停价只是下跌1美元到140美元，根据这个模型就可以买进1 250股，但是，这1 250股要花掉176 250美元-这是将你的账户金额全部作为保证金也做不到的。不管怎么说，你还是把风险控制在了2.5%以内。当然，风险的计算都是建立在初始风险之上的-也就是买进的价格和初始止损水平之间的差额。</p>
<p>百分比风险模型是第一个为你提供合理的方法以确保1R的风险对你所交易的每一个产品都意味着相同的风险的模型。假如你在股市上做着100万美元资产组合的交易，而且你愿意利用完全保证金，使用的是1%的风险模型，因此，你在每个头寸上所承担的风险是10000美元。表14-5描述了这一过程。<br>表中所显示的停价是随意给出的，它代表一个1R的风险。你也许会认为表中的停价对如此高价位的股票来说过于紧密了，尤其是对TXN来说，只有0.20美元，但如果你是在追求R乘数很大的交易，也许就不会觉得紧密了。表14-5显示甚至不能买入5只股票，因为这些股票的价值超过了200万美元保证金的限制。不管怎样，如果能够严格遵守事先预定的停价，每一个头寸的风险只有10000美元。所以，在100万美元的资产组合上，总的资产组合风险只有50 000美元加上价格差异和各种交易成本。如果你是一位股票交易商，请好好研究一下表14-5，它可能会改变你进行股票组合交易的思维方式。<br>但是，尽管在你只购买了几只股票后就充分利用了保证金，如果你在持续地获得购买股票的新的信号，你会如何处理呢？你只有几种可能的解决方案：第一，你可以限制新的购买；第二，在增加新的股票之前，消除业绩最差的头寸；第三，为了继续购买新的股票，可以将头寸规模确定得小一些；最后，你可以将以上三种方案相结合。</p>
<h1 id="模型4：百分比波动幅度模型"><a href="#模型4：百分比波动幅度模型" class="headerlink" title="模型4：百分比波动幅度模型"></a>模型4：百分比波动幅度模型</h1><p>波动幅度是指，在任意一段时间里，基本金融工具每日的价格波动量。它直接用来衡量在任何给定的头寸有可能面对的对你有利的或不利的价格变化。如果通过将建立的每一个头寸的波动幅度规定为资本的一个固定百分比的方式而把它们等同起来，那么你基本上就把近期内所面对的每一资产组合要素可能发生的市场波动幅度等同起来了。</p>
<p>在大多数情形下，波动幅度就是当日最高价和最低价之间的差。如果IBM在141和143.5之间波动，那么它的波动幅度就是2.5个点。不过，利用平均真实波幅将任何跳空开盘都给予了考虑。因此，如果IBM昨天收盘于139，而今天它在141和143.5之间波动，为了确定真实波幅，就需要把今天跳空开盘的2个点加上，因此，今天的真实波幅是在139和143.5之间，即4.5个点。这基本上就是本书后面的专业词汇中所列的威尔斯·怀尔德的平均真实波幅的计算。</p>
<p>下面是百分比波动幅度如何进行头寸规模确定的计算。假如你的账户上有50000美元，你想用来买黄金。黄金的价格是每盎司600美元，它在过去20天里每天的波动幅度是3美元。我们将使用平均真实波幅的一个20天的简单移动平均来衡量波动幅度。那么可以买进多少手黄金合约呢？</p>
<p>因为每日的波幅是3美元，一个点是100美元（一手合约是100盎司），这就等于每手黄金合约每日的波幅是300美元。假如允许最大的波幅为账户资本的2%.50000美元的2%就是1000美元。如果用每手合约的波幅300美元去除允许的最大波幅1000美元，就得到3.3手合约。因此，基于波动幅度的头寸规模确定模型就允许买进3手合约。</p>
<p>表14-6解释了在过去11年中，当你根据作为资本一定百分比的市场波动幅度为基础进行头寸规模确定时，上面所述的55/21系统对有10种交易商品的资产组合结果会如何。这里，波动幅度定义为平均真实波幅的一个20天移动平均。这里的系统和数据和在其他模型中所用的是一样的。表14-2、表14-4和表14-6之间的差别是由于头寸规模确定法则不同所致。</p>
<blockquote>
<p>表14-6 利用波动幅度确定头寸规模的55/21突破系统</p>
</blockquote>
<p>e 表中数据是60.70，而文中的数据是69.7，疑有误。-一译者注</p>
<p>注意，在表14-6中，一个2%的波动幅度头寸规模确定方案每年带来的收益67.9%-86.1%之间，每年带来的亏损69.7%—85.5%之间。该表建议，如果对该系统采用波动辐度头寸规模确定法则，你或许希望采用0.5% -1%之间的一个数作为每一头寸的最大波幅，这取决于你的目标。在该系统中，最高的回报一风险比率出现在2.5%的方案，但是很少人能够忍受86%的亏损。</p>
<p>如果将表14-4和表14-6进行比较，你会发现系统发生失效的百分比大不相同。这些不同是由在使用资本的一定百分比的方法来进行头寸规模确定之前（就是说，相对于20天的波动幅度，目前21天的极点对你是不利的）必须考虑的数字的大小引起的。因此，一个基于21天的极点停价基础上的5%的风险模型看起来等同于使用20天平均真实波幅的资本的大约1%的模型。这些百分比基于的数字是至关重要的。在确定计划用来确定头寸大小的这些百分比之前，必须对它们加以考虑。</p>
<p>波动幅度头寸规模确定法则具有控制风险的一些非常突出的优点，是可以使用的最为成熟的模型之一，但是很少有交易商使用这一法则。</p>
<h1 id="模型小结"><a href="#模型小结" class="headerlink" title="模型小结"></a>模型小结</h1><p>表14-7对本章所介绍的四个模型进行了总结，并归纳出了它们各自的优缺点。注意，缺点最多的模型也是大多数人都采用的模型—每一固定金额的资金交易一个单位的模型。让我们再次强调这些缺点，因为它们太重要了。</p>
<blockquote>
<p>表14-7 四个头寸规模确定模型的比较</p>
</blockquote>
<p>首先，假定你开立了一个30 000美元的账户，这用来做期货交易是不够的，除非你只在为数较少的几个农产品市场上交易，然而，很多人还是会做的。在这个账户中，你也许可以交易一手玉米合约、一手标准普尔合约和一手债券合约-尽管保证金的要求可能不允许你同时做这些交易。然而，这个模型存在瑕疵，因为它的确允许你同时交易所有这些合约。相比之下，一个百分比风险模型或者一个百分比波动幅度模型可能会拒绝标准普尔和债券交易，因为它们的风险太大。</p>
<p>其次，这个模型会允许你对每一种合约都购买一手。这是很荒唐的，你会把所有的注意力都集中到标准普尔合约上，因为它的波动幅度和风险都太大。所有的投资项目都是不一样的，因此，你也许应该拒绝任何一种确实将所有的投资看做一样的头寸规模确定法则。该模型的确就是这样一种头寸规模确定法则，因为每一种合约你都持有一手。</p>
<p>再次，如果头寸规模确定模型是要每30 000美元买进一手合约，那么你将会遇到两个问题。一是如果账户下跌了1美元，你就不能建立任何头寸。大多数人不会遵守这一点，因为他们假定无论账户里有多少钱，都可以买进一手合约。二是如果足够幸运，你的账户会上涨，那么账户规模必须得翻一番，你才可以买入另一手合约。这根本上就没有头寸规模确定！</p>
<p>注意，后三个模型在平衡资产组合方面要比第一个模型好得多，为什么不从中选择一个呢？</p>
<p>我们可以创造出和入市法则一样多的头寸规模确定法则。这里有数以百万计的各种可能，本章只是对该问题讨论了一些皮毛。不管怎样，如果你已经开始理解头寸规模确定的影响，那么我的目的就达到了。</p>
<h1 id="其他系统使用的头寸规模确定法则"><a href="#其他系统使用的头寸规模确定法则" class="headerlink" title="其他系统使用的头寸规模确定法则"></a>其他系统使用的头寸规模确定法则</h1><p>在我看来，世界上最杰出的交易商的业绩是由头寸规模确定驱动的，让我们来看看本书一直在讨论的系统和它们所使用的头寸规模确定方法。在大多数情形下这都是很简单的，因为它们甚至都不谈及头寸规模确定。</p>
<p>1，股票市场模型</p>
<p>（1）威廉·欧奈尔的CAN SLIM模型。威廉·欧奈尔没有谈到过在任何给定的头寸持有“多少”的问题，只谈到了拥有多少股票的问题。他说即使一个几百万美元的资产组合也只能持有6或7只股票，拥有的资产组合资本在2万-10万美元之间的投资者应该把股票的数量限制在4或5只， 5 000-20 000美元之间的投资者应该限于3只股票，而资本更少的投资者或许应该只投资2只股票。</p>
<p>这种观点听起来有点像是稍作改变的等值单位方法。这种方法建议你把资本分成相等的单位，但是单位的数量应该取决于你拥有的资金数量。一个非常小的账户或许应该只分成2个单位，每个单位为1500美元或更少。在拥有大约5000美元的资金时，可以增加到3个单位。现在你想让每个单位都增加到至少4000美元（你能买得起100股40美元1股的股票），在能把5个单位都增加到这个水平时（20000美元），那就这么做吧。直到你能够将1个单位的规模增长到大约25 000 -50 000美元时为止，你可以保持一样的单位数量。到50 000美元时，你也许希望增至6或7个单位。</p>
<p>（2）沃伦·巴菲特的投资方法。巴菲特只对几家特别出色的公司有兴趣，即那些能够满足他非同一般的标准的公司。他想尽可能多地拥有那些为数不多的公司因为它们会给他带来非常不错的回报，而且他也从未打算抛售出去。既然他支配着几十亿美元的资产，可以拥有多家公司，因此，只要这些公司能够满足他的标准，他就在资产组合中加入更多的公司。</p>
<p>这是一个相当独特的头寸规模确定风格。然而，巴菲特是美国最富有的职业投资者（也是比尔·盖茨之后的第二大富翁）。谁能对这种成功进行质疑呢？或许你应该考虑一下这种风格的头寸规模确定策略!</p>
<p>2，期货市场模型</p>
<p>（1）考夫曼的适应性移动平均方法。考夫曼在他的《精明交易者》一书中实际上并未讨论头寸规模确定的问题，但是谈到了影响头寸规模确定的一些因素如风险和回报，这里，他采用的是这些术语的学术定义。他说的风险是指资本变化的年标准差，而回报是指年复合回报率。他建议在两个系统具有相同的回报时，理性的投资者应该选择风险较小的系统。</p>
<p>考夫曼在他的讨论中还提出了另外一个有趣的观点-50年法则 他说密西西比河大堤的建造保护了他们免遭最近50年来最大的一次洪涝灾害。这就是说河水会漫过大堤，但是并不是经常这样，或许一生会遇到这么一次。类似地，适当地设计其系统的职业交易商也可能会面临类似的情形。他们精心地设计系统，但说不定一生当中可能会有那么一次极端的价格变化将其利润一扫而光。</p>
<p>安全问题，正像我在各种头寸规模确定模型里指出的一样，它直接和你持有的资本数量和你愿意承受的杠杆作用大小有关。随着资本的增长，如果你做多样化的投资并且降低杠杆作用，那么资本就会更加安全。如果继续把利润作为杠杆使用，那么你就会面临全部亏损的风险。</p>
<p>考夫曼建议，可以在对所选择的杠杆水平进行风险测试时，通过考察风险的标准差来控制最坏情形下的风险。例如，如果回报率是40%，而亏损的变化范围表明1个标准差是10%，那么你就知道在任何给定的年份：亏损10%的可能性是16%（1个标准差）；亏损20%的可能性是2.5%（2个标准差）；亏损30%的可能性是0.5% （3个标准差）。</p>
<p>这些结果是不错的，但是如果你认为损失20%或者更多，你将陷入非常严重的困境，考夫曼建议你只用一部分资金来交易。</p>
<p>考夫曼还谈到了资产配置，他将其定义为：资产配置就是将投资基金分配到一个或者多个市场或工具以创造带来最好的回报一风险比率的资产组合的过程。资产配置可以是将一半的资本用于进行一种频繁交易的投资（一个股票资产组合），而剩下的资本投资于短期生息工具如政府债券；也可以是以一种动态的方法将很多投资工具结合起来，比如频繁交易的股票、商品和外汇市场。这是资产配置所说的另外一种情形和“多少”的话题容易混淆。</p>
<p>尽管考夫曼没有直接阐述头寸规模确定，但是从他的分析中可以清楚地看出，他是习惯于使用第一种头寸规模确定模型的，即每一定金额的资金交易一个单位。他用来降低风险的方式就是增加交易1个单位所需的资本。</p>
<p>（2）加拉赫的基本面交易。加拉赫在他的《赢者通吃》一本书中实际上有一章深入讨论了头寸规模确定的问题。他说风险和在市场中的交易直接相关，而且看起来他好像不喜欢前面所介绍的百分比风险模型，因为该模型不控制风险。例如，任何规模的账户3%的风险可以是1个单位，也可以是30个单位，取决于停价设在什么水平。加拉赫认为， 1个单位的风险不可能不小于30个单位的风险。例如，他说一个账户交易某种商品的一手合约、承担500美元的风险与一个账户交易相同商品的两手合约，而每手合约都承担250美元的风险相比，是一个风险更小的交易计划。加拉赫的观点是对的，所有接受百分比风险模型的交易商都应该理解这一点。停价只是你指示经纪人将你的指令变成市场指令的价格水平，但是无论如何该价格是无法保证的。这也是我们建议任何想利用紧密停价的交易商采用百分比波动幅度模型的原因之一。</p>
<p>e你可以这样计算：有68%的变化范围落在一个正的和一个负的标准差范围内，所以还剩下32%。这意味着有16%的结果（32%的一半）在一个标准差10%以上。同样的方法是，95%的回报落在正负两个标准差之间，因此， 5%的一半即2.5%落在了负的两个标准差之外。最后，99%的结果落在正负三个标准差之间。同样的逻辑，只有0.5%的结果会在负的三个标准差之外。不过，考夫曼是假定问报服从正态介布的，但因为市场价格并非服从正态介布的，所以回报也不会服从正态分布。</p>
<p>加拉赫还指出风险不仅随着交易量的增加而增加，也随着时间的延长而增加。在市场中交易的时间越长，暴露在巨大的价格冲击中的机会就越大。加拉赫认为，一个利用世界上所有的钱进行1个单位交易的交易商最终会全部赔掉。这种观点对大多数交易商来说或许是对的，但是不全对。</p>
<p>加拉赫声称，交易不同的投资产品只是加快了时间的影响。他认为1年交易N个头寸和N年交易1个头寸就潜在的亏损而言是一样的。</p>
<p>加拉赫建议你要找到你可以容忍的预期的最大的亏损幅度（LEED）-或许是25%，或许是50%。他要求假定这个LEED明天就会发生。它或许不会发生，但是你需要这样假定。</p>
<p>他继续利用系统的期望收益和各种商品每日波幅的可能分布计算了潜在亏损的分布，然后，对各种商品提出了最小交易金额的建议，为的是你的资本不至于减少50%。换句话说，加拉赫是在建议你采用典型的每一固定金额的账户资本交易一个单位的模型，但是该固定金额的大小要根据该投资每日的波动幅度不同而有所不同。</p>
<p>每单位交易所需要的金额还要依据你是否同时在交易1个单位、2个单位还是4个单位而有所不同。例如，如果你只用一种工具进行交易，那么对每1000美元的每日波幅，他建议你每40 000美元交易1个单位。如果你同时在利用另外一种工具进行交易，那么他建议你对每1000美元的每日波幅，每28000美元交易1个单位。最后，当你同时利用三种其他的工具进行交易时，他建议对每1000美元的每日波幅每20000美元交易1个单位。</p>
<p>来看一个玉米交易的例子。假如目前每蒲式耳玉米的价格每天的波动幅度为4美分，这就等于1个单位每天波动幅度为200美元（因为一个交易单位是5000蒲式耳）。按照加拉赫的模型，因为200美元是1 000美元的20%，你可以每40000美元的20%即每8000美元交易1个单位。如果你还在利用另外一种工具进行玉米交易，就可以每5600美元交易1个单位。如果你同时在利用三种其他的工具进行玉米交易，那么可以每4000美元交易1个单位。</p>
<p>加拉赫的方法是对每一固定金额交易1个单位的很好的变形，因为它根据各种交易工具的波动幅度将其等同起来，因此，他的模型克服了该模型的基本局限之一。它在改进的同时使得模型变得稍微有点复杂，但是不管怎么说，它都是一个很有意思的交易方式。</p>
<p>（3）肯·罗伯茨的1-2-3方法。罗伯茨的头寸规模确定第一原则就是不需要太多的钱来进行商品交易。他对“多少”问题的回答就是只做一手合约的交易。遗憾的是，他只考虑了那些账户中只有1 000~-10000美元的人的需要，因此，他最主要的头寸规模确定原则就是只做一手合约的交易。</p>
<p>罗伯茨说一个人不应该承担1000美元以上的风险，这就意味着他会避开某些商品如标准普尔、各种货币甚至避开咖啡，因为这些商品所涉及的风险一般都会大于1000美元。这样的说法让罗伯茨听起来很保守。罗伯茨在他的系统中没有包括一个头寸规模确定的计算法则。在我看来，这是很危险的，因为在大多数头寸规模确定计算法则告诉你不应该在市场中建立头寸时，如果按照罗伯茨的方法你可能仍然会建立头寸。</p>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>在我看来，任何交易系统设计中最为重要的部分都是和在每一个头寸上投资多少有关的部分。资产管理和资产配置一直都用来表述“多少”的问题，但是这些术语多年来一直被错误地使用，让人混淆不清。因此，我决定在本书中使用头寸规模确定这一术语来消除这种混淆。</p>
<p>头寸规模确定从本质上在可靠度、回报一风险比率和机会构成的三维空间上又加上了一维，大幅度增加了整个交易过程中可能发生的潜在的利润或亏损。实际上，在我看来，头寸规模确定造成了各资金经理业绩的最主要的差距。从本质上说，期望收益和机会形成了决定利润量的立方体，而头寸规模确定决定了一次有多少个立方体在增加利润量。</p>
<p>头寸规模确定还指出了基本资本的重要性。对于较大的资本额，可以利用头寸规模确定做很多交易，而在资本额很小时，就很容易被一扫而尽。</p>
<p>e在我看来，这样的假定会让很多人进行交易，而且使得交易看起来似乎不会涉及太多风险。本书的读者在这一点上应该能够自己判断这一假定的风险。</p>
<p>赢后加倍下注的系统是指在资本增加时增加赌注大小，它是主要的、有效的模型。本章给出了几个这种系统使用的头寸规模确定模型，包括以下几个：</p>
<p>每一固定金额的资金交易1个单位。这个模型让你每一定金额的资金持有一个头寸，它从根本上将所有的投资都看成是一样的，而且让你总是持有一个头寸。<br>等值单位模型。这个模型根据资产组合中所有投资的基本价值赋予它们相等的权重。它被投资者和股票交易商普遍使用。<br>百分比风险模型。这个模型是作为最好的模型推荐给长期趋势跟踪者的，它赋予所有的交易相等的风险并允许资产组合稳定增长。<br>百分比波动幅度模型。这个模型对使用紧密停价的交易商来说是最好的，它可以在风险和机会（期望收益）之间提供合理的平衡。</p>
<!-- flag of hidden posts -->
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/通向财务自由之路/" rel="tag"># 通向财务自由之路</a>
          
        </div>
      

      
      
      

      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="CheBin">
            
              <p class="site-author-name" itemprop="name">CheBin</p>
              <div class="site-description motion-element" itemprop="description">先得寸，再进尺</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">730</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">16</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">56</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          

          
          


          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <!-- modify icon to fire by szw -->
                <i class="fa fa-history fa-" aria-hidden="true"></i>
                近期文章
              </div>
              <ul class="links-of-blogroll-list">
                
                
                  <li>
                    <a href="/2022/10/25/企业微信源码/" title="企业微信源码" target="_blank">企业微信源码</a>
                  </li>
                
                  <li>
                    <a href="/2022/10/21/当前读和快照读的区别/" title="当前读和快照读的区别" target="_blank">当前读和快照读的区别</a>
                  </li>
                
                  <li>
                    <a href="/2022/10/19/详解MySQL的for-update/" title="详解MySQL的for update" target="_blank">详解MySQL的for update</a>
                  </li>
                
                  <li>
                    <a href="/2022/10/10/结课测试-这些Go语言的知识你都掌握了吗？/" title="结课测试 | 这些Go语言的知识你都掌握了吗？" target="_blank">结课测试 | 这些Go语言的知识你都掌握了吗？</a>
                  </li>
                
                  <li>
                    <a href="/2022/10/10/49-程序性能分析基础（下）/" title="49 | 程序性能分析基础（下）" target="_blank">49 | 程序性能分析基础（下）</a>
                  </li>
                
              </ul>
            </div>
        

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#基本的头寸规模确定策略"><span class="nav-number">1.</span> <span class="nav-text">基本的头寸规模确定策略</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#采用的系统"><span class="nav-number">2.</span> <span class="nav-text">采用的系统</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#模型1：每一固定金额资金交易一个单位"><span class="nav-number">3.</span> <span class="nav-text">模型1：每一固定金额资金交易一个单位</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#模型2：股票交易的等价值交易单位"><span class="nav-number">4.</span> <span class="nav-text">模型2：股票交易的等价值交易单位</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#模型3：百分比风险模型"><span class="nav-number">5.</span> <span class="nav-text">模型3：百分比风险模型</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#模型4：百分比波动幅度模型"><span class="nav-number">6.</span> <span class="nav-text">模型4：百分比波动幅度模型</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#模型小结"><span class="nav-number">7.</span> <span class="nav-text">模型小结</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#其他系统使用的头寸规模确定法则"><span class="nav-number">8.</span> <span class="nav-text">其他系统使用的头寸规模确定法则</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#小结"><span class="nav-number">9.</span> <span class="nav-text">小结</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2022</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CheBin</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">站点总字数：</span>
    
    <span title="站点总字数">6.6m</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    
    <span title="站点阅读时长">100:09</span>
  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a></div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.1"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.1"></script>



  
  <script src="/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  

  

  


  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  

  
  

  


  

  

  

  

  

  

  

  

  
<script>
  $('.highlight').each(function(i, e) {
    var $wrap = $('<div>').addClass('highlight-wrap');
    $(e).after($wrap);
    $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function(e) {
      var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
        return $(e).text();
      }).toArray().join('\n');
      var ta = document.createElement('textarea');
      var yPosition = window.pageYOffset || document.documentElement.scrollTop;
      ta.style.top = yPosition + 'px'; // Prevent page scroll
      ta.style.position = 'absolute';
      ta.style.opacity = '0';
      ta.readOnly = true;
      ta.value = code;
      document.body.appendChild(ta);
      ta.select();
      ta.setSelectionRange(0, code.length);
      ta.readOnly = false;
      var result = document.execCommand('copy');
      
        if (result) $(this).text('复制成功');
        else $(this).text('复制失败');
      
      ta.blur(); // For iOS
      $(this).blur();
    })).on('mouseleave', function(e) {
      var $b = $(this).find('.copy-btn');
      setTimeout(function() {
        $b.text('复制');
      }, 300);
    }).append(e);
  })
</script>


  

  

</body>
</html>
