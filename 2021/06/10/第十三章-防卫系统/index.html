<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2">





















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">
<meta name="keywords" content="海龟交易法则">
<meta property="og:type" content="article">
<meta property="og:title" content="第十三章 防卫系统">
<meta property="og:url" content="http://yoursite.com/2021/06/10/第十三章-防卫系统/index.html">
<meta property="og:site_name" content="车斌的技术博客">
<meta property="og:description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/2021/06/10/第十三章-防卫系统/1.jpg">
<meta property="og:updated_time" content="2021-11-05T07:53:53.176Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第十三章 防卫系统">
<meta name="twitter:description" content="思考并回答以下问题：  总结一下，这章作者最主要想表达什么观点？">
<meta name="twitter:image" content="http://yoursite.com/2021/06/10/第十三章-防卫系统/1.jpg">






  <link rel="canonical" href="http://yoursite.com/2021/06/10/第十三章-防卫系统/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>第十三章 防卫系统 | 车斌的技术博客</title><meta name="robots" content="noindex">
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">车斌的技术博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">专注</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/06/10/第十三章-防卫系统/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CheBin">
      <meta itemprop="description" content="学如逆水行舟，不进则退">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="车斌的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">第十三章 防卫系统

              
            
          </h1>
        

        <div class="post-meta">

          

          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2021-06-10 14:44:09" itemprop="dateCreated datePublished" datetime="2021-06-10T14:44:09+08:00">2021-06-10</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2021-11-05 15:53:53" itemprop="dateModified" datetime="2021-11-05T15:53:53+08:00">2021-11-05</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/期货/" itemprop="url" rel="index"><span itemprop="name">期货</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">6.9k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">6 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>思考并回答以下问题：</p>
<ul>
<li>总结一下，这章作者最主要想表达什么观点？</li>
</ul>
<a id="more"></a>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a><span style="color:#339AFF;">前言</span></h1><blockquote>
<p>序言<br>交易不是赛跑，而是拳击。市场会挥动铁拳痛击你，竭尽全力地打败你。但要想获胜，你必须在12回合的结束钟声敲响时仍然安然无恙地站立在拳台上。</p>
</blockquote>
<p>新手们在设计交易系统的时候，总想靠历史检验找到一个所向无敌的超级系统。他们相信，在历史检验中表现出众的系统在未来同样会出类拔萃。假如他们在测试中发现某个系统（暂时称之为奥米伽系统）的CAGR和MAR比另一个系统（暂时称之为阿尔法系统）分别高上10%和0.2%，他们一定会选择奥米伽。在他们看来，既然奥米伽看起来比阿尔法好这么多，那么选择阿尔法就是愚蠢的。随着经验的积累，你会认识到世界上不存在完美的系统。奥米伽也许在某些市场状态下表现得更好，而且，由于最有利于奥米伽的市场状态在过去一段时间一直占据主流，它在历史测试中的表现也许要远强于阿尔法系统。但遗憾的是，谁也不敢保证这样的市场状态在未来也会占据主流。换句话说，未来的市场状态分布规律也许会不同于过去。所以，如果奥米伽与阿尔法在测试中的差异只是由市场状态的某种分布规律决定的，那么一旦市场规律在未来有所变化，这种差异也有可能不复存在。</p>
<p>举个例子。假设奥米伽的表现在平静的趋势下远强于阿尔法，而阿尔法在波动的趋势下要优于奥米伽；在20年的测试期中，市场有13年以平静的趋势为主流，只有7年以波动的趋势为主，如果同样的分布规律在未来重现，奥米伽的未来表现会优于阿尔法。</p>
<p>但是，如果这7年的波动性趋势有5年出现在过去的10年中呢？如果交易者效应带来了市场行为的变化，致使未来的趋势变得更具波动性呢？如果是这样，未来的优胜者更有可能是阿尔法，因为它在波动的趋势中表现得更好。相反，如果市场呈现周期性特征，总是在平静和波动两种状态间交替变换，又会怎么样？这岂不是意味着奥米伽在未来会更胜一筹吗？因为当市场从近期的波动状态再次返回到平静状态时，奥米伽的表现会超过阿尔法。</p>
<h1 id="不可预知的未来"><a href="#不可预知的未来" class="headerlink" title="不可预知的未来"></a><span style="color:#339AFF;">不可预知的未来</span></h1><p>在很多时候，我们会因为掌握不到足够多的信息而无法作出有把握的决策。原因就在于数据的缺乏。考虑一下“QQQVVQ”这个序列符号：假如这代表着平静期（Q）和波动期（V）的交替变化，我们能不能从中断定未来的市场更有可能处于平静期还是波动期？如果你仔细看过前面的章节，你会意识到我们从这样小的样本中还得不出任何确凿的结论。即使我们看到了一个更大的序列，比如“VQQVQVVQQQQVVQ”，而且这看起来像是种周期性变换，我们仍然没有足够多的数据来得出这种论断。</p>
<p>在这类情况下，我们最好接受现实，承认我们没有足够多的数据，无从判断未来会怎么样。因此我们无法准确地预测系统在未来的相对表现，充其量只能泛泛而谈而已。对这一点的成熟认识对建立一个稳健的交易系统至关重要。就像交易世界中的其他许多问题一样，认清现实是关键性的第一步。一旦你认清了现实，你就可以作出符合现实的决策，然后相应地调整你的行为。</p>
<h1 id="稳健交易"><a href="#稳健交易" class="headerlink" title="稳健交易"></a><span style="color:#339AFF;">稳健交易</span></h1><p>所谓稳健交易，就是用稳健的交易策略来抵御市场波动的风险。要做到这一点，你必须首先接受一个现实：没人可以预知未来，而且任何以历史数据为基础的测试都有相当大的内在偏差。</p>
<p>颇有讽刺意味的是，一旦你的交易策略考虑到了未来的不可知性，你的表现反而会变得更加容易预测。这看似矛盾，其实原因很简单：如果你的交易策略以未来不可知的前提假设为基础，那么未来的任何市场状态都已在你的预料之中，你不需要预测什么。相反，如果你的交易策略以某些特定的市场特征假设（实际上任何假设都一样）为基础，那么一旦这些假设未能成立，你的策略就失去了立足点。</p>
<p>那么，我们如何去制定一套不依赖于特定市场条件的交易策略呢？任何稳健的交易策略都有两大特征：分散化和简化。说到这两大要素对稳健性的贡献，我们的大自然提供了最好的例子。在这方面，我们可以把交易系统的稳健性形象地比做生态系统和系统内各个物种的生存能力。</p>
<h2 id="分散化"><a href="#分散化" class="headerlink" title="分散化"></a><span style="color:#00ACC1;">分散化</span></h2><p>在生态系统中，大自然不会仅靠一两个物种去完成一个任务。它不会只有一种食肉动物，只有一种食物源，只有一种食草动物，只有一种负责清理尸骸的食腐动物。分散化非常重要，因为它可以避免生态系统在某种生物的数量急剧变化的情况下陷于被动。</p>
<h2 id="简化"><a href="#简化" class="headerlink" title="简化"></a><span style="color:#00ACC1;">简化</span></h2><p>在稳定的环境中，复杂的生态系统更有韧性，复杂的物种似乎也远优于简单的物种。但在变化时期，复杂的物种更容易灭亡，因为在这些时候，最坚强的物种都是那些非常简单的物种，比如病毒和细菌。简单的生命体之所以更为坚强，是因为它们并不是那么依赖于特殊的环境。无论流星撞上地球还是火山爆发造成了温度的剧降，当生态系统发生了这类天翻地覆的变化时，简单性会成为一个巨大的优势。相反，如果气候变了，对旧气候的依赖性将是一个巨大的劣势。</p>
<h1 id="坚强的生物体"><a href="#坚强的生物体" class="headerlink" title="坚强的生物体"></a><span style="color:#00ACC1;">坚强的生物体</span></h1><p>也有一些复杂的物种非常坚强，可以在各种各样的条件下生存下去。这些物种一般是在多变的气候或条件下演化而来的，因此练就了适应变化的能力。这些坚强的物种就是我们建立稳健交易系统的榜样。</p>
<p>我们已经考虑了稳健性的两个要素——分散化和简化，现在让我们看看如何从这两个方面加强我们的交易策略。有些法则会加剧对特殊市场条件的依赖性，尽可能地减少这类法则就是简化的要诀。要提高分散化程度，我们可以选择尽可能多的非关联市场，或者在同一时间使用多种不同的交易系统——这样，无论未来的市场状况如何，你的投资组合中总会有一些表现良好的系统。</p>
<h1 id="稳健系统"><a href="#稳健系统" class="headerlink" title="稳健系统"></a><span style="color:#339AFF;">稳健系统</span></h1><p>加强系统的稳健性有两大要点，一是确保系统法则能适应各种不同的市场状况，二是让系统保持简明，不容易受市场变化的影响。你可以通过增强系统适应不同市场状况的能力来提高系统的稳健性。这样的系统有超强的适应性，就像是自然界中的那些有能力在多变环境中生存下去的生物体。人类就是一个例子。人既可以生活在撒哈拉沙漠中，也可以生活在北极的冰天雪地中，因为人类的高智能使他们有能力适应这些天差地别的环境。</p>
<p>任何系统都有更适合自己的市场状态。趋势跟踪系统在平静的趋势中表现更好，反趋势系统在稳定中有波动的市场状态下表现更好。一个过滤器之所以能让一个系统更加稳健，就是因为它能把处于不利状态下的市场剔除出去。唐奇安趋势系统的趋势组合过滤器就是个例子。这个过滤器禁止在突破方向与大趋势相反时进行交易，而这样的情况只有在不利的市场状态下才会发生。与大趋势方向一致的突破则更容易发生在有趋势的市场中，加入这个过滤器会让系统变得更加稳健。</p>
<p>同样，简单的法则能提高系统的稳健性正是因为这样的法则能在各种各样的不同境况下发挥作用。复杂的系统之所以变得这样复杂，一般是因为系统开发者们总想添加新的法则，利用他们所注意到的某些市场状况或行为。这样的法则越多，系统对特定市场状况或行为的依赖性就越高。这样一来，未来的市场不具备这些条件的可能性就越大，而在这样的市场中，这些复杂的法则不会再生效。</p>
<p>相比这些根据特殊市场行为而“量身定做”的复杂法则，以更加基础的概念为根基的简单法则在实际交易中的适用性更强。长久来看，简单的系统更有生命力。</p>
<h1 id="市场分散化"><a href="#市场分散化" class="headerlink" title="市场分散化"></a><span style="color:#339AFF;">市场分散化</span></h1><p>选择多个不同的市场是提高交易稳健性的最有效的方法之一。市场越多，你就越有可能在至少某一个市场中碰到有利于你的状态。对趋势跟踪系统来说，你参与的市场越多，其中某个市场存在趋势的可能性就越大。</p>
<p>这意味着你的资产组合中应该包含尽可能多的市场。这些市场中必须有新机会出现，所以它们相互之间不能有太高的关联性。比如，有几种美国短期利率产品几乎总是同涨同跌，选择多个这样的市场并不能提高分散化水平。</p>
<p>如果你的系统不要求从早到晚地紧密监视市场动向，你可以考虑境外市场。这些市场对分散化大有帮助，可以提高交易的稳健性和连贯性。本书曾提到一些根据收盘价数据在开盘时买入的系统，对这样的系统来说，全球市场是更好的用武之地，因为如果你关心的只是收盘价和开盘价，时差问题就不是那么重要了。</p>
<h2 id="选择市场"><a href="#选择市场" class="headerlink" title="选择市场"></a><span style="color:#00ACC1;">选择市场</span></h2><p>TradeStation是迄今为止最流行的系统测试平台，但它有一个极大的局限性：不能在同一时间测试多个市场。这便造成了一个副作用：很多交易者的着眼点是单个市场，而不是整个投资组合。正因如此，很多人错误地认为某些市场不能纳入投资组合，理由是这些市场无利可图，或者表现逊于其他市场。</p>
<p>这种看法有两个问题。其一，有些市场可能每隔几年才会出现一次趋势，因此5-10年的短期测试并不能充分反映它们的潜力。其二，有的市场虽然利润水平不理想，但却有很大的分散化价值，而且两者权衡利大于弊。</p>
<p>以第四章说过的可可市场为例。还记得吗，这个市场在遭受了一连串损失之后才形成一个好趋势。这种情况是很常见的。还有一个特别值得一提的例子是我在海龟时代的经历。在1985年早期，里奇要求我们不要再交易咖啡。我想这是因为咖啡市场的容量对我们来说太小，而且我们的可可交易一直在赔钱。就是这个决定导致我们错失了整个海龟时代最好的一个机会（见图13-1）。</p>
<blockquote>
<p>图13-1 我们所错失的咖啡交易</p>
</blockquote>
<img src="/2021/06/10/第十三章-防卫系统/1.jpg">
<p>由于没有作这次交易，我没法准确地告诉你我的损失有多么大，我用1986年3月份咖啡合约的数据作了一次测试。在入市点，N值是1.29美分，这意味着我的头寸单位规模应该是103份合约，因为我在1985年一直在用一个500万美元的账户作交易。由于每次交易4个头寸单位，我在这次交易中会买入412份合约。每份合约的利润大约是34000美元，因此412份合约的总利润将是1400万美元左右——也就是说，这一次交易的回报率就达到了500万美元账户资本的280%。在海龟时代中，没有一次交易能比得上这个与我们擦肩而过的机会。</p>
<p>但这是否意味着我们要不加选择地囊括所有的市场呢？我们是不是没理由将某一个市场排除在外呢？当然不是。排除某个市场的主要原因在于流动性问题。比起高流动性的市场，交易不够活跃、成交量不够大的市场要棘手得多。你做得越出色，这个因素对你的限制就越大。这就是里奇禁止我们交易咖啡的原因。我们的交易量本身就很大，再加上里奇的交易，我们在进入和退出市场的时候要买卖数千份咖啡合约。这当然已经接近市场容量的极限。因此，里奇的决定是个非常合理的决定，尽管我宁愿他没有作出这个决定。</p>
<p>你可能会想，如果你的账户很小，你就可以选择这种低流动性的市场。这有可能是对的，要看你用的是什么样的系统，但这也有可能是错的。低流动性市场的问题并不在于你在平常的时候难以进入和退出，而在于你在某些特殊的情况下有太多的合约要买卖，但另一边却无人回应。市场流动性低意味着买家和卖家太少，所以，你的一份200或500份合约的买单可能等上一天也没法成交，因为根本没有卖家。这种情况在流动性比较高的市场中是不太容易出现的。</p>
<p>低流动性的市场也更容易受到价格动荡的冲击。看看糙米、木材、丙烷或任何一个每日成交量不足几千份合约的市场，再比一比那些高流动性的市场，你会发现非流动性市场中的意外动荡要多得多。</p>
<h2 id="市场类型"><a href="#市场类型" class="headerlink" title="市场类型"></a><span style="color:#00ACC1;">市场类型</span></h2><p>排除特定的市场还有另外一个原因。虽然我不认为在模拟测试中相对落后的市场就应该被排除，但我确实相信某些不同类型的市场间存在一些根本性的差异，因此我们在使用特定交易系统的时候有必要完全排除特定类型的市场。</p>
<p>有些交易者认为每个市场都不尽相同，因此每个市场上的交易方式也各不相同。我认为现实并不是这么简单。在我看来，市场实际上分为三大类，它们彼此之间有明显的差异，但在同一类别中，不同市场间的差别主要是由随机事件造成的。这三大类市场是：</p>
<p>1、基本面市场：比如外汇市场和利率产品市场。在这样的市场中，价格变动的主要动力并不是交易行为，而是更高层面上的宏观经济事件和影响。随着时代的变化，这一点变得越来越不明显。但在我看来，美联储、其他国家的类似机构和一国政府的货币政策对外汇和利率产品市场的影响仍然要大于投机者。这些市场的流动性最高，趋势最清晰，最容易被趋势跟踪者们把握。</p>
<p>2、投机者市场：比如股票市场和咖啡、黄金、白银、原油这一类期货市场。在这些市场中，投机者的影响力要大于政府或那些大的对冲者。价格是由市场态度决定的。这些市场对趋势跟踪者来说较难把握。</p>
<p>3、综合衍生市场：在这类市场中，投机行为是市场的主要动力，但投机程度有所缓和，因为交易工具都是其他市场的衍生物，而这些市场本身也是相应股票的综合体。e-mini标准普尔期货合约就是个好例子。它也会上下波动，但波动范围受标准普尔500指数的限制。同样，标准普尔500指数也只是间接地受到投机者的影响。由于一个指数综合了多只股票的纯投机性波动，这里面就有一种动力的平均化和中和作用。对趋势跟踪者来说，这样的市场是最难把握的。</p>
<p>我的看法是：无论对哪一类市场而言，同类别中的所有市场都是相同的。你只需根据市场的类型和流动性来作出决策。我在海龟时代从没碰过第三种市场，但其他很多海龟与我不同。我认为我们的系统对衍生性的综合市场来说还不够好。这并不是说你不能选择这些市场，只是说我们那样的中期性突破法趋势跟踪系统并不适合这些市场。这就是我在海龟计划中从没作过标准普尔指数交易的原因。</p>
<p>同一类别的市场都大同小异。偶然的差异当然是存在的，有时候还会持续上几年甚至几十年，但长期来看你会发现，这些差异只不过源自于交易者记忆效应以及大趋势根本动因的相对罕见性和随机性。</p>
<h2 id="交易者记忆效应"><a href="#交易者记忆效应" class="headerlink" title="交易者记忆效应"></a><span style="color:#00ACC1;">交易者记忆效应</span></h2><p>金银市场是交易者记忆效应的一个好例子。在我刚入行的那个时候，因为人们对1978年的那次不可思议的大趋势（黄金涨到每盎司900美元，白银也到了每盎司50美元）仍然记忆犹新，在黄金市场上赚钱几乎是不可能的。每当市场稍微有点上涨的迹象，所有人就都开始争先恐后地抢购黄金，这让价格变得太过起伏多变。市场总是忽上忽下，忽下忽上。简而言之，一个趋势跟踪者在这样的市场中很难有所作为。到现在，20年过去了，大多数人都已经忘记了1978年的光景，所以2006年春季的那次行情远比以前更容易把握。如果你只是对比一下走势图，你就会觉得黄金市场本身变了样。</p>
<p>我想谁也不会知道像黄金这样的市场什么时候会再次变化，像可可这样的市场什么时候会再有趋势。一个市场在过去的20年中没出现过大趋势并不代表它不是个好市场。在我看来，只要一个市场的容量足够大，而且不同于你的资产组合中的其他市场，你就应该选择这个市场。</p>
<p>市场分散化往往会受到资金量的限制，因为在可以接受的风险水平下同时进入多个市场是有一定的资金要求的。成功的对冲基金之所以比个人交易者更加游刃有余，大交易者的表现之所以比小交易者更加稳定，这就是原因之一。如果你因为资金有限而只能选择10个市场，你的表现会比同时进入50-60个市场的交易者更加难以预料。如果你想在合理的分散化水平下用一个长期趋势跟踪系统交易期货，你至少需要10万美元。而且对大多数交易者来说，即使在这样的分散化程度下，风险水平也过高了。</p>
<h1 id="系统分散化"><a href="#系统分散化" class="headerlink" title="系统分散化"></a><span style="color:#339AFF;">系统分散化</span></h1><p>除了不同市场上的分散化，你还可以通过系统分散化来加强稳健性。如果同时使用多个交易系统，特别是彼此差别极大的系统，交易的稳健性会大大提高。</p>
<p>考虑一下这样两个系统：较好的一个RAR为38.2%，R立方为1.19；较差的一个RAR为14.5%，R立方仅为0.41。如果你两个系统都测试过，你会选择哪一个？是不是较好的那一个？这听起来是个合乎逻辑的选择。</p>
<p>但是，这样的选择忽视了两个不相关系统的分散化优势。假如两个系统之间呈现负相关（也就是说，如果一个系统赚了钱，那么另一个往往是赔钱的），这种优势甚至会更加大。正是因为这种原因，某些系统组合在一起的时候会更加强大，看看下面的数据就知道了。</p>
<p>如果同时使用这两个系统，RAR和R立方将分别达到61.2%和5.20，不用说，这比单独使用任何一个系统都好得多。</p>
<p>实际上，这两个系统就是布林格突破系统的两个部分。较好的那个系统只作通道突破多头交易，较差的那一个只作通道突破空头交易。很容易理解两个系统的结合为什么有效，但是效果如此之大确实令人惊讶。</p>
<p>将适合不同市场状态的系统结合起来也有同样的效果。比如，假如一个系统在有趋势的市场中表现良好，而另一个系统在没有趋势的市场中更为出众，我们可以将两者结合起来。当其中的一个遭遇衰落时，另一个却可能财源滚滚，反之亦然。这种策略并不一定像你期望的那样有效，但确实可以大大提高交易的稳健性。</p>
<p>就像市场分散化一样，系统分散化的局限性也在于同时使用多个系统的大量资金和精力投入，这就是成功的对冲基金与单个交易者相比的优势所在。你可能需要20万美元才能做到一个长期趋势跟踪系统的适度分散化，同时使用四五个不同的系统则可能需要上100万美元之多。单是这一点，就可能迫使许多人把钱交给那些专业的期货基金或对冲基金经理，而不是硬着头皮亲自上阵。</p>
<h1 id="面对现实"><a href="#面对现实" class="headerlink" title="面对现实"></a><span style="color:#339AFF;">面对现实</span></h1><p>你不可能预见到你在实际交易中会碰到什么样的市场状态，这就是稳健交易策略的前提假设。考虑到这一点，交易者们应该建立稳健的系统，也就是不会过于依赖特殊市场条件的灵活而又简单的系统。而且，成熟的稳健策略总是在多个不同的市场中使用多个不同的系统，相比高度局限于少数市场的少数系统，这种策略的稳定性要高得多。</p>
<!-- flag of hidden posts -->
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/海龟交易法则/" rel="tag"># 海龟交易法则</a>
          
        </div>
      

      
      
      

      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="CheBin">
            
              <p class="site-author-name" itemprop="name">CheBin</p>
              <div class="site-description motion-element" itemprop="description">学如逆水行舟，不进则退</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">794</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">17</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">60</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          

          
          


          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <!-- modify icon to fire by szw -->
                <i class="fa fa-history fa-" aria-hidden="true"></i>
                近期文章
              </div>
              <ul class="links-of-blogroll-list">
                
                
                  <li>
                    <a href="/2022/11/07/使用Redis实现一个分布式锁/" title="使用Redis实现一个分布式锁" target="_blank">使用Redis实现一个分布式锁</a>
                  </li>
                
                  <li>
                    <a href="/2022/11/06/14-隔离性：实现悲观协议，除了锁还有别的办法吗？/" title="14 | 隔离性：实现悲观协议，除了锁还有别的办法吗？" target="_blank">14 | 隔离性：实现悲观协议，除了锁还有别的办法吗？</a>
                  </li>
                
                  <li>
                    <a href="/2022/11/06/13-隔离性：为什么使用乐观协议的分布式数据库越来越少/" title="13 | 隔离性：为什么使用乐观协议的分布式数据库越来越少?" target="_blank">13 | 隔离性：为什么使用乐观协议的分布式数据库越来越少?</a>
                  </li>
                
                  <li>
                    <a href="/2022/11/06/12-隔离性：看不见的读写冲突，要怎么处理？/" title="12 | 隔离性：看不见的读写冲突，要怎么处理？" target="_blank">12 | 隔离性：看不见的读写冲突，要怎么处理？</a>
                  </li>
                
                  <li>
                    <a href="/2022/11/06/25｜事务（四）：持久性，吃一碗粉就付一碗粉的钱/" title="25 ｜ 事务（四）：持久性，吃一碗粉就付一碗粉的钱" target="_blank">25 ｜ 事务（四）：持久性，吃一碗粉就付一碗粉的钱</a>
                  </li>
                
              </ul>
            </div>
        

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#不可预知的未来"><span class="nav-number">2.</span> <span class="nav-text">不可预知的未来</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#稳健交易"><span class="nav-number">3.</span> <span class="nav-text">稳健交易</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#分散化"><span class="nav-number">3.1.</span> <span class="nav-text">分散化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#简化"><span class="nav-number">3.2.</span> <span class="nav-text">简化</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#坚强的生物体"><span class="nav-number">4.</span> <span class="nav-text">坚强的生物体</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#稳健系统"><span class="nav-number">5.</span> <span class="nav-text">稳健系统</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#市场分散化"><span class="nav-number">6.</span> <span class="nav-text">市场分散化</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#选择市场"><span class="nav-number">6.1.</span> <span class="nav-text">选择市场</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#市场类型"><span class="nav-number">6.2.</span> <span class="nav-text">市场类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#交易者记忆效应"><span class="nav-number">6.3.</span> <span class="nav-text">交易者记忆效应</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#系统分散化"><span class="nav-number">7.</span> <span class="nav-text">系统分散化</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#面对现实"><span class="nav-number">8.</span> <span class="nav-text">面对现实</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2022</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CheBin</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">站点总字数：</span>
    
    <span title="站点总字数">6.9m</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    
    <span title="站点阅读时长">105:14</span>
  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a></div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.1"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.1"></script>



  
  <script src="/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  

  

  


  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  

  
  

  


  

  

  

  

  

  

  

  

  
<script>
  $('.highlight').each(function(i, e) {
    var $wrap = $('<div>').addClass('highlight-wrap');
    $(e).after($wrap);
    $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function(e) {
      var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
        return $(e).text();
      }).toArray().join('\n');
      var ta = document.createElement('textarea');
      var yPosition = window.pageYOffset || document.documentElement.scrollTop;
      ta.style.top = yPosition + 'px'; // Prevent page scroll
      ta.style.position = 'absolute';
      ta.style.opacity = '0';
      ta.readOnly = true;
      ta.value = code;
      document.body.appendChild(ta);
      ta.select();
      ta.setSelectionRange(0, code.length);
      ta.readOnly = false;
      var result = document.execCommand('copy');
      
        if (result) $(this).text('复制成功');
        else $(this).text('复制失败');
      
      ta.blur(); // For iOS
      $(this).blur();
    })).on('mouseleave', function(e) {
      var $b = $(this).find('.copy-btn');
      setTimeout(function() {
        $b.text('复制');
      }, 300);
    }).append(e);
  })
</script>


  

  

</body>
</html>
